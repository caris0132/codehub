!function(){var V=function(){var t={jY:"G9AD",_:{},status:"unloaded",basePath:function(){var e=window.CKFINDER_BASEPATH||"";if(!e)for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var i=t[n].src.match(/(^|.*[\\\/])CKFINDER(?:_basic)?(?:_v2)?(?:_source)?.js(?:\?.*)?$/i);if(i){e=i[1];break}}return-1==e.indexOf("://")&&(e=0===e.indexOf("/")?location.href.match(/^.*?:\/\/[^\/]*/)[0]+e:location.href.match(/^[^\?]*\/(?:)/)[0]+e),e}(),getUrl:function(e){return-1==e.indexOf("://")&&0!==e.indexOf("/")&&(e=this.basePath+e),this.jY&&"/"!=e.charAt(e.length-1)&&(e+=(0<=e.indexOf("?")?"&":"?")+"t="+this.jY),e}},n=window.CKFINDER_GETURL;if(n){var i=t.getUrl;t.getUrl=function(e){return n.call(t,e)||i.call(t,e)}}return t}();function l(e){return V.instances[e]}var u,f,i={callback:1,selectThumbnailActionFunction:1,selectActionFunction:1};function a(e){var t=this;t.id=e.name;var n=e.element.getDocument().getWindow().$,i=V.oC.getWindow().$;t.inPopup=!(!n||!n.opener),t.inIframe=!t.inPopup&&n!=i.top&&"iframe"==n.frameElement.nodeName.toLowerCase(),t.inFrame=!t.inPopup&&n!=i.top&&"frame"==n.frameElement.nodeName.toLowerCase(),t.inUrlPopup=!(!t.inPopup||!i.opener)}function p(e){for(var t=1;CKFinder._.instanceConfig[t];)t++;return CKFinder._.instanceConfig[t]=e,t}function h(e){var t=e.kk&&e.kk()||e._||(e._={});return t.cC||(t.cC={})}function m(e){this.name=e,this.dF=[]}function g(){u=!0}function v(e){f=!e||2}if(V.jd=function(){var e=this,t={};for(var n in e)e.hasOwnProperty(n)&&("function"==typeof e[n]&&!i[n]||void 0===e[n]||(t[n]=e[n]));return e.callback&&(t.callback=e.callback),t},V.lj=function(e){var t,n=this,i="";return(e=e||n.basePath)&&0!==e.length||(e=CKFinder.DEFAULT_basePath),"/"!=e.substr(e.length-1,1)&&(e+="/"),e+="ckfinder.html",n.hh&&("function"==typeof(t=n.hh)&&(t=t.toString().match(/function ([^(]+)/)[1]),i+="?action=js&amp;func="+t),n.jx&&(i+=i?"&amp;":"?",i+="data="+encodeURIComponent(n.jx)),n.disableThumbnailSelection?(i+=i?"&amp;":"?",i+="dts=1"):(n.lH||n.hh)&&("function"==typeof(t=n.lH||n.hh)&&(t=t.toString().match(/function ([^(]+)/)[1]),i+=i?"&amp;":"?",i+="thumbFunc="+t,n.nm?i+="&amp;tdata="+encodeURIComponent(n.nm):!n.lH&&n.jx&&(i+="&amp;tdata="+encodeURIComponent(n.jx))),n.startupPath&&(i+=i?"&amp;":"?",i+="start="+encodeURIComponent(n.startupPath+(n.startupFolderExpanded?":1":":0"))),void 0===n.rememberLastFolder||n.rememberLastFolder||(i+=i?"&amp;":"?",i+="rlf=0"),n.id&&(i+=i?"&amp;":"?",i+="id="+encodeURIComponent(n.id)),n.skin&&(i+=i?"&amp;":"?",i+="skin="+encodeURIComponent(n.skin)),e+i},a.prototype={_:{},addFileContextMenuOption:function(e,n,i){var t=l(this.id),o="FileContextMenu_"+e.command;t.bD(o,{exec:function(e){var t=e.ld["filesview.filesview"].tools.dH();n(e.cg,t)}}),e.command=o,e.group||(e.group="file1"),t.gp(o,e),t.ld["filesview.filesview"].on("beforeContextMenu",function(e){if(i){var t=i(this.tools.dH());t&&(e.data.bj[o]=-1==t?V.aY:V.aS)}else e.data.bj[o]=V.aS})},disableFileContextMenuOption:function(e,t){function n(e){delete e.data.bj[o]}var i=l(this.id),o=t?"FileContextMenu_"+e:e;return i.ld["filesview.filesview"].on("beforeContextMenu",n),function(){i.ld["filesview.filesview"].removeListener("beforeContextMenu",n)}},addFolderContextMenuOption:function(e,t,n){var i=l(this.id),o="FolderContextMenu_"+e.command;i.bD(o,{exec:function(e){t(e.cg,e.aV)}}),e.command=o,e.group||(e.group="folder1"),i.gp(o,e),i.ld["foldertree.foldertree"].on("beforeContextMenu",function(e){if(n){var t=n(this.app.aV);t&&(e.data.bj[o]=-1==t?V.aY:V.aS)}else e.data.bj[o]=V.aS})},disableFolderContextMenuOption:function(e,t){function n(e){delete e.data.bj[o]}var i=l(this.id),o=t?"FolderContextMenu_"+e:e;return i.ld["foldertree.foldertree"].on("beforeContextMenu",n),function(){i.ld["foldertree.foldertree"].removeListener("beforeContextMenu",n)}},addFolderDropMenuOption:function(e,t,n){var i=l(this.id),o="FolderDropMenu_"+e.command;i.bD(o,{exec:function(e){t(e.cg,e.cK.oa())}}),e.command=o;var a=new V.iD(i,o,e);i.ld["foldertree.foldertree"].on("beforeDropMenu",function(e){n&&!n.call(i.cg,e.data.folder)||(e.data.iG[o]=a)})},disableFolderDropMenuOption:function(e,t){function n(e){delete e.data.iG[o]}var i=l(this.id),o=t?"FolderDropMenu_"+e:e;return i.ld["foldertree.foldertree"].on("beforeDropMenu",n),function(){i.ld["foldertree.foldertree"].removeListener("beforeDropMenu",n)}},getSelectedFile:function(){return l(this.id).ld["filesview.filesview"].tools.dH()},getSelectedFiles:function(){return l(this.id).ld["filesview.filesview"].tools.oO(!0)},getSelectedFolder:function(){return l(this.id).aV},filterFiles:function(e){l(this.id).ld["filesview.filesview"].oW("requestRenderFiles",{lookup:e})},setUiColor:function(e){l(this.id).setUiColor(e)},destroy:function(e){l(this.id).destroy(),e&&e()},openDialog:function(e,t){var n=this,i=new V.dom.document(window.document).getHead();l(n.id).document.getWindow();return(n.inFrame||n.inPopup||n.inIframe)&&(V.document=l(n.id).document),l(n.id).openDialog(e,t,i)},openMsgDialog:function(e,t){l(this.id).msgDialog(e,t)},openConfirmDialog:function(e,t,n){l(this.id).fe(e,t,n)},openInputDialog:function(e,t,n,i){l(this.id).hs(e,t,n,i)},openSkippedFilesDialog:function(e,t,n,i){l(this.id).skippedFilesDialog(e,t,n,i)},addTool:function(e){return l(this.id).plugins.tools.addTool(e)},addToolPanel:function(e){return l(this.id).plugins.tools.addToolPanel(e)},removeTool:function(e){l(this.id).plugins.tools.removeTool(e)},showTool:function(e){l(this.id).plugins.tools.showTool(e)},hideTool:function(e){l(this.id).plugins.tools.hideTool(e)},getResourceType:function(e){return l(this.id).getResourceType(e)},log:function(e){V.log.apply(V.log,arguments)},getLog:function(){return V.mZ()},emptyBasket:function(){l(this.id).execCommand("TruncateBasket")},replaceUploadForm:function(n,i,o,a){var r=l(this.id);if(!((a=a||10)>=(r.dC||20)))return r.dC=a,r.ld["formpanel.formpanel"].on("beforeUploadFileForm",function(t){if(2==t.data.step&&!(a>r.dC)){t.cancel(!0);var e=this.data();t.data.folder;try{"upload"==e.dc?this.oW("requestUnloadForm",function(){this.app.cS("upload").bR(V.aS)}):(this.data().dc&&this.oW("requestUnloadForm"),o||this.eh.removeClass("show_border"),this.oW("requestLoadForm",{html:n,command:"upload"}),i&&i())}catch(e){throw this.oW("failedUploadFileForm",t.data),this.oW("afterUploadFileForm",t.data),V.ba(e)}}}),{hide:function(){r.oW("requestUnloadForm",function(){r.cS("upload").bR(V.aS)})}}},resizeFormPanel:function(e){var t=l(this.id);if(void 0===e)t.document.getById("panel_view").setStyle("height",""),t.document.getById("panel_widget").setStyle("height","");else{var n=Math.min(e,Math.max(90,t.document.getById("main_container").$.offsetHeight-300));t.document.getById("panel_view").setStyle("height",n+"px"),t.document.getById("panel_widget").setStyle("height",n-3+"px")}t.layout.ea(!0)},refreshOpenedFolder:function(){var e=l(this.id),t=e.ld["filesview.filesview"].tools.currentFolder();e.oW("requestSelectFolder",{folder:t})},selectFile:function(e){l(this.id).oW("requestSelectFile",{file:e,scrollTo:1})},closePopup:function(){this.inPopup&&l(this.id).element.getDocument().getWindow().$.close()},openFolder:function(e,t){var n=l(this.id);t=t.replace(/\/$/,""),e=e.toLowerCase();for(var i=0;i<n.folders.length;i++){var o=n.folders[i];if(o.getPath().replace(/\/$/,"")==t&&e==o.type.toLowerCase())return n.oW("requestSelectFolder",{folder:o}),void n.oW("requestShowFolderFiles",{folder:o})}},execCommand:function(e){l(this.id).execCommand(e)}},window.CKFinder=function(e,t){if(e)for(var n in e)e.hasOwnProperty(n)&&("function"==typeof e[n]&&"callback"!=n||(this[n]=e[n]));this.callback=t},CKFinder.prototype={create:function(e){var t="ckf"+Math.random().toString().substr(2,9);document.write('<span id="'+t+'"></span>'),e=V.tools.extend(V.jd.call(this),e,!0);var n=V.replace(t,e,CKFinder);return this.api=n.cg,n.cg},appendTo:function(e,t){t=V.tools.extend(V.jd.call(this),t,!0);var n=V.appendTo(e,t,CKFinder);return this.api=n.cg,n.cg},replace:function(e,t){t=V.tools.extend(V.jd.call(this),t,!0);var n=V.replace(e,t,CKFinder);return this.api=n.cg,n.cg},popup:function(e,n){var t;null!==e&&"object"==typeof e&&(t=e,e=parseInt(t.width,10),n=parseInt(t.height,10)),n=n||"70%","string"==typeof(e=e||"80%")&&1<e.length&&"%"==e.substr(e.length-1,1)&&(e=parseInt(window.screen.width*parseInt(e,10)/100,10)),"string"==typeof n&&1<n.length&&"%"==n.substr(n.length-1,1)&&(n=parseInt(window.screen.height*parseInt(n,10)/100,10)),e<200&&(e=200),n<200&&(n=200);var i=parseInt((window.screen.height-n)/2,10),o=parseInt((window.screen.width-e)/2,10),a=(t&&t.popupFeatures?t.popupFeatures:CKFinder.config.popupFeatures)+",width="+e+",height="+n+",top="+i+",left="+o,r=V.env.webkit?"about:blank":"",l=window.open(r,"CKFinderpopup",a,!0);if(!l)return!1;this.width=this.height="100%";var s='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><title>'+(t&&t.popupTitle?t.popupTitle:CKFinder.config.popupTitle)+'</title><style type="text/css">body, html, iframe, #ckfinder { margin: 0; padding: 0; border: 0; width: 100%; height: 100%; overflow: hidden; }</style></head><body></body></html>',d=this;function c(){var t=new V.dom.document(l.document);t.$.open(),V.env.isCustomDomain()&&(t.$.domain=window.document.domain),t.$.write(s),t.$.close();try{return-1==navigator.userAgent.toLowerCase().indexOf(" chrome/")&&(l.moveTo(o,i),l.resizeTo(e,n)),l.focus(),d.appendTo(t.bH())}catch(e){return d.appendTo(t.bH())}return!1}return CKFinder.env.safari?(setTimeout(c,0),null):c()}},CKFinder._={},CKFinder._.instanceConfig=[],CKFinder.lang={},CKFinder.version="2.6.2",CKFinder.revision="UNKNOWN",CKFinder.addPlugin=function(e,i,t){var o={bM:t||[]};for(var n in"function"==typeof i&&(i={appReady:i}),i)i.hasOwnProperty(n)&&"connectorInitialized"!=n&&"uiReady"!=n&&(o[n]=i[n]);o.bz=function(n){if(n.config.readOnly&&!1===o.readOnly)return null;i.connectorInitialized&&n.on("connectorInitialized",function(e){var t=i.connectorInitialized;t&&t.call(t,n.cg,e.data.xml)},null,null,1e3),i.connectorResponse&&n.on("connectorResponse",function(e){var t=i.connectorResponse;t&&t.call(t,n.cg,e.data.xml)}),i.galleryCallback&&n.on("launchGallery",function(e){var t=i.galleryCallback;t&&(e.data.bx=t.call(t,n.cg,e.data.selected,e.data.files))}),i.uiReady&&n.on("uiReady",function(){var e=i.uiReady;e.call(e,n.cg)},null,null,1e3),i.appReady&&n.on("appReady",function(){var e=i.appReady;e.call(e,n.cg)},null,null,1e3),function(e,t){if(e.toolbarButtons)for(var n=0;n<e.toolbarButtons.length;n++){var i=e.toolbarButtons[n];if(!t.bY._.items[i[0]]){var o=V.tools.deepCopy(i[1]),a=o.command;if(!o.command){var r=i[1].onClick;a="ToolbarButton_"+i[0],t.bD(a,{exec:function(e){r(e.cg)}}),o.command=a}var l=V.tools.capitalize(e.name);"function"==typeof o.label?o.label=o.label.call(e,t.cg):t.lang[e.name]&&t.lang[e.name][o.label]?o.label=t.lang[e.name][o.label]:t.lang[l]&&t.lang[l][o.label]?o.label=t.lang[l][o.label]:t.lang[o.label]&&(o.label=t.lang[o.label]),t.bY.add(i[0],CKFinder._.UI_BUTTON,o)}}}(o,n)},V.plugins.add(e,o)},CKFinder.getPluginPath=function(e){return V.plugins.getPath(e)},CKFinder.addExternalPlugin=function(e,t,n){V.plugins.tR(e,t,n)},CKFinder.setPluginLang=function(e,t,n){V.plugins.rX(e,t,n)},CKFinder.dialog={add:function(e,t){"function"==typeof t&&(t=V.tools.override(t,function(t){return function(e){return t(e.cg)}})),V.dialog.add(e,t)}},CKFinder.tools={},CKFinder.env={},CKFinder.dom={},CKFinder.create=function(e,t,n,i,o){var a;if(null!==e&&"object"==typeof e)for(var r in a=new CKFinder,e)a[r]=e[r];else(a=new CKFinder).basePath=e,t&&(a.width=t),n&&(a.height=t),i&&(a.selectActionFunction=i),o&&(a.callback=o);return a.create()},CKFinder.popup=function(e,t,n,i,o){var a,r,l;if(null!==e&&"object"==typeof e){for(var s in a=new CKFinder,e)a[s]=e[s];r=e.popupTitle,l=e.popupFeatures,t=t||e.width,n=n||e.height}else(a=new CKFinder).basePath=e,i&&(a.selectActionFunction=i),o&&(a.callback=o);return a.popup({width:t,height:n,popupTitle:r,popupFeatures:l})},CKFinder.setupFCKeditor=function(e,t,n,i){var o,a;if(null!==t&&"object"==typeof t){for(var r in a=p(t),o=new CKFinder,t)if(o[r]=t[r],"width"==r){var l=o[r]||800;"string"==typeof l&&1<l.length&&"%"==l.substr(l.length-1,1)&&(l=parseInt(window.screen.width*parseInt(l,10)/100,10)),e.Config.LinkBrowserWindowWidth=l,e.Config.ImageBrowserWindowWidth=l,e.Config.FlashBrowserWindowWidth=l}else if("height"==r){var s=o[r]||600;"string"==typeof s&&1<s.length&&"%"==s.substr(s.length-1,1)&&(s=parseInt(window.screen.height*parseInt(s,10)/100,10)),e.Config.LinkBrowserWindowHeight=s,e.Config.ImageBrowserWindowHeight=s,e.Config.FlashBrowserWindowHeight=s}}else(o=new CKFinder).basePath=t;var d=o.basePath;"/"!=d.substr(0,1)&&-1==d.indexOf("://")&&(d=document.location.pathname.substring(0,document.location.pathname.lastIndexOf("/")+1)+d);var c=-1!==(d=V.lj.call(o,d)).indexOf("?")?"&":"?";a&&(d+=c+"configId="+a,c="&"),e.Config.LinkBrowserURL=d,e.Config.ImageBrowserURL=d+c+"type="+(n||"Images"),e.Config.FlashBrowserURL=d+c+"type="+(i||"Flash");var u=d.substring(0,1+d.lastIndexOf("/"));e.Config.LinkUploadURL=u+"core/connector/"+CKFinder.config.connectorLanguage+"/connector."+CKFinder.config.connectorLanguage+"?command=QuickUpload&type=Files",e.Config.ImageUploadURL=u+"core/connector/"+CKFinder.config.connectorLanguage+"/connector."+CKFinder.config.connectorLanguage+"?command=QuickUpload&type="+(n||"Images"),e.Config.FlashUploadURL=u+"core/connector/"+CKFinder.config.connectorLanguage+"/connector."+CKFinder.config.connectorLanguage+"?command=QuickUpload&type="+(i||"Flash")},CKFinder.setupCKEditor=function(e,t,n,i){if(null!==e){var o,a;if(null!==t&&"object"==typeof t){for(var r in a=p(t),o=new CKFinder,t)if(o[r]=t[r],"width"==r){var l=o[r]||800;"string"==typeof l&&1<l.length&&"%"==l.substr(l.length-1,1)&&(l=parseInt(window.screen.width*parseInt(l,10)/100,10)),e.config.filebrowserWindowWidth=l}else if("height"==r){var s=o[r]||600;"string"==typeof s&&1<s.length&&"%"==s.substr(s.length-1,1)&&(s=parseInt(window.screen.height*parseInt(s,10)/100,10)),e.config.filebrowserWindowHeight=s}}else(o=new CKFinder).basePath=t;var d=o.basePath;"/"!=d.substr(0,1)&&-1==d.indexOf("://")&&(d=document.location.pathname.substring(0,document.location.pathname.lastIndexOf("/")+1)+d);var c=-1!==(d=V.lj.call(o,d)).indexOf("?")?"&":"?";a&&(d+=c+"configId="+a,c="&"),e.config.filebrowserBrowseUrl=d,e.config.filebrowserImageBrowseUrl=d+c+"type="+(n||"Images"),e.config.filebrowserFlashBrowseUrl=d+c+"type="+(i||"Flash");var u=d.substring(0,1+d.lastIndexOf("/"));e.config.filebrowserUploadUrl=u+"core/connector/"+CKFinder.config.connectorLanguage+"/connector."+CKFinder.config.connectorLanguage+"?command=QuickUpload&type=Files",e.config.filebrowserImageUploadUrl=u+"core/connector/"+CKFinder.config.connectorLanguage+"/connector."+CKFinder.config.connectorLanguage+"?command=QuickUpload&type="+(n||"Images"),e.config.filebrowserFlashUploadUrl=u+"core/connector/"+CKFinder.config.connectorLanguage+"/connector."+CKFinder.config.connectorLanguage+"?command=QuickUpload&type="+(i||"Flash")}else{for(var f in CKEDITOR.instances)CKFinder.setupCKEditor(CKEDITOR.instances[f],t,n,i);CKEDITOR.on("instanceCreated",function(e){CKFinder.setupCKEditor(e.editor,t,n,i)})}},V.event||(V.event=function(){},V.event.du=function(e,t){var n=V.event.prototype;for(var i in n)null==e[i]&&(e[i]=n[i])},V.event.prototype={on:function(a,r,l,s,e){var t=h(this),n=t[a]||(t[a]=new m(a));if(n.mi(r)<0){var i=n.dF;function o(e,t,n,i){var o={name:a,jN:this,application:e,data:t,jO:s,stop:n,cancel:i,removeListener:function(){d.removeListener(a,r)}};return r.call(l,o),o.data}l=l||this,isNaN(e)&&(e=10);var d=this;o.fn=r,o.nT=e;for(var c=i.length-1;0<=c;c--)if(i[c].nT<=e)return void i.splice(c+1,0,o);i.unshift(o)}},oW:(f=u=!(m.prototype={mi:function(e){for(var t=0,n=this.dF;t<n.length;t++)if(n[t].fn==e)return t;return-1}}),function(e,t,n,i){"function"==typeof t?(i=t,t=null):"function"==typeof n&&(i=n,n=null),"mousemove"!=e&&V.log("[EVENT] "+e,t,i);var o=h(this)[e],a=u,r=f;if(u=f=!1,o){var l=o.dF;if(l.length){l=l.slice(0);for(var s=0;s<l.length;s++){var d=l[s].call(this,n,t,g,v);if(void 0!==d&&(t=d),u||f&&2!=f)break}}}var c=f||void 0!==t&&(t&&void 0!==t.result?t.result:t);return"function"==typeof i&&2!=f&&(c=i.call(this,f,t)||c),u=a,f=r,c}),cr:function(e,t,n){var i=this.oW(e,t,n);return delete h(this)[e],i},removeListener:function(e,t){var n=h(this)[e];if(n){var i=n.mi(t);0<=i&&n.dF.splice(i,1)}},mF:function(){for(var e=h(this),t=0;t<e.length;t++)e[t].dF=[]},rC:function(e){var t=h(this)[e];return t&&0<t.dF.length}}),V.application||(V.kZ=0,V.fc=1,V.qE=2,V.application=function(e,t,n,i){this._={instanceConfig:e,element:t},this.ff=n||V.kZ,V.event.call(this),this.iI(i)},V.application.replace=function(e,t,n){var i=e;if("object"!=typeof i){if(!(i=document.getElementById(e)))for(var o=0,a=document.getElementsByName(e);(i=a[o++])&&"textarea"!=i.tagName.toLowerCase(););if(!i)throw'[CKFINDER.application.replace] The element with id or name "'+e+'" was not found.'}return new V.application(t,i,V.fc,n)},V.application.appendTo=function(e,t,n){if("object"!=typeof e&&!(e=document.getElementById(e)))throw'[CKFINDER.application.appendTo] The element with id "'+e+'" was not found.';return new V.application(t,e,V.qE,n)},V.application.prototype={iI:function(){(V.application.eb||(V.application.eb=[])).push(this)},oW:function(e,t,n){return V.event.prototype.oW.call(this,e,t,this,n)},cr:function(e,t,n){return V.event.prototype.cr.call(this,e,t,this,n)}},V.event.du(V.application.prototype,!0)),!V.env){var r=/rv:([\d\.]+)/,s=/trident\/([\d]+)/;V.env=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:!1,iemodern:!1,opera:!!t&&t.version,webkit:-1<e.indexOf(" applewebkit/"),air:-1<e.indexOf(" adobeair/"),mac:-1<e.indexOf("macintosh"),quirks:"BackCompat"==document.compatMode,isCustomDomain:function(){return this.ie&&document.domain!=window.location.hostname}};n.gecko="Gecko"==navigator.product&&!n.webkit&&!n.opera,n.chrome=!1,n.safari=!1,n.webkit&&(-1<e.indexOf(" chrome/")?n.chrome=!0:n.safari=!0);var i=0;if(n.ie&&(i=parseFloat(e.match(/msie (\d+)/)[1]),n.ie8=!!document.documentMode,n.ie8Compat=8==document.documentMode,n.ie7Compat=7==i&&!document.documentMode||7==document.documentMode,n.ie6Compat=i<7||n.quirks),n.gecko){var o=e.match(r);o&&(i=1e4*(o=o[1].split("."))[0]+100*(o[1]||0)+ +(o[2]||0)),s.test(e)?(n.gecko=!1,n.iemodern=!0):n.isMobile=-1<e.indexOf("fennec")}return n.opera&&(i=parseFloat(t.version()),n.isMobile=-1<e.indexOf("opera mobi")),n.air&&(i=parseFloat(e.match(/ adobeair\/(\d+)/)[1])),n.webkit&&(i=parseFloat(e.match(/ applewebkit\/(\d+)/)[1]),n.isMobile=-1<e.indexOf("mobile")),n.version=i,n.isCompatible=n.ie&&6<=i||n.iemodern&&11<=i||n.gecko&&10801<=i||n.opera&&9.5<=i||n.air&&1<=i||n.webkit&&522<=i||!1,n.cssClass="browser_"+(n.ie?"ie":n.iemodern?"iemodern":n.gecko?"gecko":n.opera?"opera":n.air?"air":n.webkit?"webkit":"unknown"),n.quirks&&(n.cssClass+=" browser_quirks"),n.ie&&(n.cssClass+=" browser_ie"+(n.version<7?"6":8<=n.version?"8":"7"),n.quirks&&(n.cssClass+=" browser_iequirks"),n.ie7Compat&&(n.cssClass+=" browser_ie7Compat")),n.gecko&&i<10900&&(n.cssClass+=" browser_gecko18"),n}(),CKFinder.env=V.env}var W=V.env,L=W.ie;"unloaded"==V.status&&function(){V.event.du(V),V.dO=function(){if("basic_ready"==V.status){delete V.dO;var e=document.createElement("script");e.type="text/javascript",e.src=V.basePath+"ckfinder.js",document.getElementsByTagName("head")[0].appendChild(e)}else V.dO.qr=!0},V.mS=0,V.uQ="ckfinder",V.uM=!0;function i(e,t,n,i){if(W.isCompatible){V.dO&&V.dO();var o=n(e,t,i);return V.add(o),o}return null}function e(){var e=V.dO,t=V.mS;V.status="basic_ready",e&&e.qr?e():t&&setTimeout(function(){V.dO&&V.dO()},1e3*t)}V.replace=function(e,t,n){return i(e,t,V.application.replace,n)},V.appendTo=function(e,t,n){return i(e,t,V.application.appendTo,n)},V.add=function(e){(this._.io||(this._.io=[])).push(e)},V.uL=function(){for(var e=document.getElementsByTagName("textarea"),t=0;t<e.length;t++){var n=null,i=e[t];i.name;if(i.name||i.id){if("string"==typeof arguments[0]){if(!new RegExp("(?:^| )"+arguments[0]+"(?:$| )").test(i.className))continue}else if("function"==typeof arguments[0]&&!(n={})===arguments[0](i,n))continue;this.replace(i,n)}}},window.addEventListener?window.addEventListener("load",e,!1):window.attachEvent&&window.attachEvent("onload",e),V.status="basic_loaded"}(),V.dom={},CKFinder.dom=V.dom;var t,n,o,d,e,c,b,y,w=V.dom;function _(e){return 4==e.readyState&&(200<=e.status&&e.status<300||304==e.status||0===e.status||1223==e.status)}function F(e){return _(e)?e.responseText:null}function k(e){if(_(e)){var t=e.responseXML,n=new V.xml(t&&t.firstChild&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:e.responseText.replace(/^[^<]+/,"").replace(/[^>]+$/,""));if(n&&n.mq&&n.mq.documentElement&&"parsererror"!=n.mq.documentElement.nodeName&&"html"!=n.mq.documentElement.nodeName&&"br"!=n.mq.documentElement.nodeName)return n}var i=V.nG||V.jt,o=e.responseText,a=i.lang.ErrorMsg[o?"XmlError":"XmlEmpty"]+"<br>";return n&&n.mq&&(n.mq.parseError&&n.mq.parseError.reason?a+=n.mq.parseError.reason:n.mq.documentElement&&"parsererror"==n.mq.documentElement.nodeName&&(a+=n.mq.documentElement.textContent)),o?((/text\/plain/.test(e.getResponseHeader("Content-Type"))||/<Connector\s*/.test(o))&&(o='<div style="width:600px; overflow:scroll"><font>'+(o=(o=V.tools.htmlEncode(o)).replace(/\n/g,"<br>"))+"</font></div>"),i.msgDialog(i.lang.SysErrorDlgTitle,a+"<br>"+i.lang.ErrorMsg.XmlRawResponse.replace("%s","<br><br>"+o))):i.msgDialog(i.lang.SysErrorDlgTitle,a),{}}function C(e,t,n,i){var o=!!t;V.log("[AJAX] "+(i?"POST":"GET")+" "+e);var a=function(){if(!L||"file:"!=location.protocol)try{return new XMLHttpRequest}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}return null}();return a?(i?a.open("POST",e,o):a.open("GET",e,o),o&&(a.onreadystatechange=function(){4==a.readyState&&(t(n(a)),a=null)}),i?(a.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8"),a.send(i)):a.send(null),o?"":n(a)):null}V.ajax={load:function(e,t,n){return C(e,t,F,n)},loadXml:function(e,t,n){return C(e,t,k,n)}},CKFinder.ajax=V.ajax,y=[],V.tools={arrayCompare:function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},clone:function(e){var t;if(e&&e instanceof Array){t=[];for(var n=0;n<e.length;n++)t[n]=this.clone(e[n]);return t}if(null===e||"object"!=typeof e||e instanceof String||e instanceof Number||e instanceof Boolean||e instanceof Date)return e;for(var i in t=new e.constructor,e){var o=e[i];t[i]=this.clone(o)}return t},capitalize:function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},extend:function(e){var t,n,i=arguments.length;"boolean"==typeof(t=arguments[i-1])?i--:"boolean"==typeof(t=arguments[i-2])&&(n=arguments[i-1],i-=2);for(var o=1;o<i;o++){var a=arguments[o];for(var r in a)!0!==t&&null!=e[r]||(!n||r in n)&&(e[r]=a[r])}return e},prototypedCopy:function(e){function t(){}return t.prototype=e,new t},isArray:function(e){return!!e&&e instanceof Array},cssStyleToDomStyle:(c=document.createElement("div").style,b=void 0!==c.cssFloat?"cssFloat":void 0!==c.styleFloat?"styleFloat":"float",function(e){return"float"==e?b:e.replace(/-./g,function(e){return e.substr(1).toUpperCase()})}),htmlEncode:function(e){function t(e){var t=new w.element("span");return t.setText(e),t.getHtml()}var n="<br>"==t("\n").toLowerCase()?function(e){return t(e).replace(/<br>/gi,"\n")}:t,i=">"==t(">")?function(e){return n(e).replace(/>/g,"&gt;")}:n,o="&nbsp; "==t("  ")?function(e){return i(e).replace(/&nbsp;/g," ")}:i;return this.htmlEncode=o,this.htmlEncode(e)},escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})},getNextNumber:(e=0,function(){return++e}),getRandomString:function(e){var t="abcdefghijklmnopqrstuvwxyz0123456789",n=[],i="";if(window.crypto&&window.crypto.getRandomValues)n=new Uint8Array(e),window.crypto.getRandomValues(n);else for(var o=0;o<e;o++)n.push(Math.floor(256*Math.random()));for(var a=0;a<n.length;a++){var r=t.charAt(n[a]%t.length);i+=.5<Math.random()?r.toUpperCase():r}return i},override:function(e,t){return t(e)},setTimeout:function(e,t,n,i,o){return o=o||window,n=n||o,o.setTimeout(function(){i?e.apply(n,[].concat(i)):e.apply(n)},t||0)},trim:(d=/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,function(e){return e?e.replace(d,""):null}),ltrim:(o=/^[ \t\n\r]+/g,function(e){return e?e.replace(o,""):null}),rtrim:(n=/[ \t\n\r]+$/g,function(e){return e?e.replace(n,""):null}),indexOf:Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},bind:function(e,t){return function(){return e.apply(t,arguments)}},createClass:function(e){var t=e.$,n=e.base,i=e.vd||e._,o=e.ej,a=e.statics;if(i){var r=t;t=function(){var e=this._||(this._={});for(var t in i){var n=i[t];e[t]="function"==typeof n?V.tools.bind(n,this):n}r.apply(this,arguments)}}return n&&(t.prototype=this.prototypedCopy(n.prototype),(t.prototype.constructor=t).prototype.base=function(){this.base=n.prototype.base,n.apply(this,arguments),this.base=arguments.callee}),o&&this.extend(t.prototype,o,!0),a&&this.extend(t,a,!0),t},addFunction:function(e,t){return y.push(function(){e.apply(t||this,arguments)})-1},removeFunction:function(e){y[e]=null},callFunction:function(e){return y[e].apply(window,Array.prototype.slice.call(arguments,1))},cssLength:(t=/^\d+(?:\.\d+)?$/,function(e){return e+(t.test(e)?"px":"")}),repeat:function(e,t){return new Array(t+1).join(e)},deepCopy:function(e){var t={};if("object"==typeof e)for(var n in void 0!==e.length&&(t=[]),e)null===e[n]?t[n]=null:"object"==typeof e[n]?t[n]=V.tools.deepCopy(e[n]):t[n]=e[n];return t},getUrlParam:function(e,t){var n=new RegExp("(?:[?&]|&amp;)"+e+"=([^&]+)","i"),i=(t||window).location.search.match(n);return i&&1<i.length?i[1]:null},htmlEncode:function(e){return e?e=(e=(e=(e="string"!=typeof e?e.toString():e).replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"):""},setCookie:function(e,t,n){document.cookie=e+"="+t+(n?"":"; expires=Sat, 2 Jan 2038 01:00:00 UTC; path=/")},getCookie:function(e){var t=document.cookie.match(new RegExp("(^|\\s|;)"+e+"=([^;]*)"));return t&&0<t.length?t[2]:""},mH:function(e){L?(e.$.onfocusin=function(){e.addClass("focus_inside")},e.$.onfocusout=function(){e.removeClass("focus_inside")}):(e.$.addEventListener("focus",function(){e.addClass("focus_inside")},!0),e.$.addEventListener("blur",function(){e.removeClass("focus_inside")},!0))},formatSize:function(e,t,n){return 0==e?"0":e<1?t.Kb.replace("%1",1):e<1024?(n||(e=e.toFixed(2)),t.Kb.replace("%1",e)):e<1048576?t.Mb.replace("%1",(e/1024).toFixed(2)):t.Gb.replace("%1",(e/1048576).toFixed(2))},formatSpeed:function(e,t){return t.SizePerSecond.replace("%1",this.formatSize(e,t))}},CKFinder._.callFunction=V.tools.callFunction,CKFinder.tools=V.tools;var x,E,G=V.tools;w.event=function(e){this.$=e},w.event.prototype={oV:function(){return this.$.keyCode||this.$.which||0},db:function(){var e=this,t=e.oV();return(e.$.ctrlKey||e.$.metaKey)&&(t+=V.bP),e.$.shiftKey&&(t+=V.dy),e.$.altKey&&(t+=V.eJ),t},preventDefault:function(e){var t=this.$;t.preventDefault?t.preventDefault():t.returnValue=!1,e&&this.stopPropagation()},stopPropagation:function(){var e=this.$;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},bK:function(){var e=this.$.target||this.$.srcElement;return e?new w.bi(e):null},getButton:function(){if(this.$.which)return this.$.which;switch(this.$.button){case 1:return 1;case 4:return 2;case 2:return 3}},ov:function(){return 1==this.getButton()}},V.bP=1e3,V.dy=2e3,V.eJ=4e3,w.dE=function(e){e&&(this.$=e)},w.dE.prototype={kk:function(){var e;return(e=this.dw("_"))||this.fL("_",e={}),e},on:function(e){var t,n,i=this,o=i.dw("_cke_nativeListeners");if(o||(o={},i.fL("_cke_nativeListeners",o)),!o[e]){var a=o[e]=(t=i,n=e,function(e){void 0!==V&&t.oW(n,new w.event(e))});i.$.addEventListener?i.$.addEventListener(e,a,!!V.event.jP):i.$.attachEvent&&i.$.attachEvent("on"+e,a)}return V.event.prototype.on.apply(i,arguments)},removeListener:function(e){var t=this;if(V.event.prototype.removeListener.apply(t,arguments),!t.rC(e)){var n=t.dw("_cke_nativeListeners"),i=n&&n[e];i&&(t.$.removeEventListener?t.$.removeEventListener(e,i,!1):t.$.detachEvent&&t.$.detachEvent("on"+e,i),delete n[e])}}},x=w.dE.prototype,E={},x.equals=function(e){return e&&e.$===this.$},x.fL=function(e,t){var n=this.iY();return(E[n]||(E[n]={}))[e]=t,this},x.dw=function(e){var t=this.$._ckf_expando,n=t&&E[t];return n&&n[e]},x.jF=function(e){var t=this.$._ckf_expando,n=t&&E[t],i=n&&n[e];return void 0!==i&&delete n[e],i||null},x.iY=function(){return this.$._ckf_expando||(this.$._ckf_expando=G.getNextNumber())},V.event.du(x),w.window=function(e){w.dE.call(this,e)},w.window.prototype=new w.dE,G.extend(w.window.prototype,{focus:function(){W.webkit&&this.$.parent&&this.$.parent.focus(),this.$.focus()},eR:function(){var e=this.$.document,t="CSS1Compat"==e.compatMode;return{width:(t?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(t?e.documentElement.clientHeight:e.body.clientHeight)||0}},hV:function(){var e=this.$;if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}}}),w.document=function(e){w.dE.call(this,e)};var I=w.document;I.prototype=new w.dE,G.extend(I.prototype,{appendStyleSheet:function(e){if(this.$.createStyleSheet)this.$.createStyleSheet(e);else{var t=new w.element("link",this);t.setAttributes({rel:"stylesheet",type:"text/css",href:e}),this.getHead().append(t)}},createElement:function(e,t){var n=new w.element(e,this);return t&&(t.attributes&&n.setAttributes(t.attributes),t.gS&&n.setStyles(t.gS)),n},jT:function(e){return new w.text(e,this)},focus:function(){this.getWindow().focus()},getById:function(e){var t=this.$.getElementById(e);return t?new w.element(t):null},vu:function(e,t){for(var n=this.$.documentElement,i=0;n&&i<e.length;i++){var o=e[i];if(t)for(var a=-1,r=0;r<n.childNodes.length;r++){var l=n.childNodes[r];if((!0!==t||3!=l.nodeType||!l.previousSibling||3!=l.previousSibling.nodeType)&&++a==o){n=l;break}}else n=n.childNodes[o]}return n?new w.bi(n):null},eG:function(e,t){return!L&&t&&(e=t+":"+e),new w.iT(this.$.getElementsByTagName(e))},getHead:function(){var e=this.$.getElementsByTagName("head")[0];return e=new w.element(e),(this.getHead=function(){return e})()},bH:function(){var e=new w.element(this.$.body);return(this.bH=function(){return e})()},gT:function(){var e=new w.element(this.$.documentElement);return(this.gT=function(){return e})()},getWindow:function(){var e=new w.window(this.$.parentWindow||this.$.defaultView);return(this.getWindow=function(){return e})()}}),w.bi=function(e){if(e){switch(e.nodeType){case V.cv:return new w.element(e);case V.fl:return new w.text(e)}w.dE.call(this,e)}return this},w.bi.prototype=new w.dE,V.cv=1,V.fl=3,V.va=8,V.om=11,V.oh=0,V.op=1,V.gW=2,V.gX=4,V.mo=8,V.lF=16,G.extend(w.bi.prototype,{appendTo:function(e,t){return e.append(this,t),e},clone:function(e,t){var n=this.$.cloneNode(e);if(!t){var i=function(e){if(e.nodeType==V.cv){e.removeAttribute("id",!1),e.removeAttribute("_ckf_expando",!1);for(var t=e.childNodes,n=0;n<t.length;n++)i(t[n])}};i(n)}return new w.bi(n)},gE:function(){return!!this.$.previousSibling},ge:function(){return!!this.$.nextSibling},kB:function(e){return e.$.parentNode.insertBefore(this.$,e.$.nextSibling),e},insertBefore:function(e){return e.$.parentNode.insertBefore(this.$,e.$),e},vP:function(e){return this.$.parentNode.insertBefore(e.$,this.$),e},lU:function(e){for(var t=[],n=this.getDocument().$.documentElement,i=this.$;i&&i!=n;){for(var o=i.parentNode,a=-1,r=0;r<o.childNodes.length;r++){var l=o.childNodes[r];if((!e||3!=l.nodeType||!l.previousSibling||3!=l.previousSibling.nodeType)&&(a++,l==i))break}t.unshift(a),i=i.parentNode}return t},getDocument:function(){var e=new I(this.$.ownerDocument||this.$.parentNode.ownerDocument);return(this.getDocument=function(){return e})()},vA:function(){for(var e=this.$,t=e.parentNode&&e.parentNode.firstChild,n=-1;t;){if(n++,t==e)return n;t=t.nextSibling}return-1},hL:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}var o,a=!e&&this.getFirst&&this.getFirst();if(!a){if(this.type==V.cv&&n&&!1===n(this,!0))return null;a=this.dG()}for(;!a&&(o=(o||this).getParent());){if(n&&!1===n(o,!0))return null;a=o.dG()}return a?n&&!1===n(a)?null:t&&t!=a.type?a.hL(!1,t,n):a:null},hZ:function(e,t,n){if(n&&!n.call){var i=n;n=function(e){return!e.equals(i)}}var o,a=!e&&this.dB&&this.dB();if(!a){if(this.type==V.cv&&n&&!1===n(this,!0))return null;a=this.cf()}for(;!a&&(o=(o||this).getParent());){if(n&&!1===n(o,!0))return null;a=o.cf()}return a?n&&!1===n(a)?null:t&&a.type!=t?a.hZ(!1,t,n):a:null},cf:function(e){for(var t,n=this.$;(t=(n=n.previousSibling)&&new w.bi(n))&&e&&!e(t););return t},vs:function(){return this.cf(function(e){return 1==e.$.nodeType})},dG:function(e){for(var t,n=this.$;(t=(n=n.nextSibling)&&new w.bi(n))&&e&&!e(t););return t},vk:function(){return this.dG(function(e){return 1==e.$.nodeType})},getParent:function(){var e=this.$.parentNode;return e&&1==e.nodeType?new w.bi(e):null},vn:function(e){for(var t=this,n=[];n[e?"push":"unshift"](t),t=t.getParent(););return n},vv:function(e){var t=this;if(e.equals(t))return t;if(e.contains&&e.contains(t))return e;var n=t.contains?t:t.getParent();do{if(n.contains(e))return n}while(n=n.getParent());return null},gz:function(e){var t=this.$,n=e.$;if(t.compareDocumentPosition)return t.compareDocumentPosition(n);if(t==n)return V.oh;if(this.type==V.cv&&e.type==V.cv){if(t.contains){if(t.contains(n))return V.lF+V.gX;if(n.contains(t))return V.mo+V.gW}if("sourceIndex"in t)return t.sourceIndex<0||n.sourceIndex<0?V.op:t.sourceIndex<n.sourceIndex?V.gX:V.gW}for(var i=this.lU(),o=e.lU(),a=Math.min(i.length,o.length),r=0;r<=a-1;r++)if(i[r]!=o[r]){if(r<a)return i[r]<o[r]?V.gX:V.gW;break}return i.length<o.length?V.lF+V.gX:V.mo+V.gW},vw:function(e,t){var n=this.$;for(t||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==e)return new w.bi(n);n=n.parentNode}return null},vX:function(e,t){var n=this.$;for(t||(n=n.parentNode);n;){if(n.nodeName&&n.nodeName.toLowerCase()==e)return!0;n=n.parentNode}return!1},move:function(e,t){e.append(this.remove(),t)},remove:function(e){var t=this.$,n=t.parentNode;if(n){if(e)for(var i;i=t.firstChild;)n.insertBefore(t.removeChild(i),t);n.removeChild(t)}return this},replace:function(e){this.insertBefore(e),e.remove()},trim:function(){this.ltrim(),this.rtrim()},ltrim:function(){for(var e;this.getFirst&&(e=this.getFirst());){if(e.type==V.fl){var t=G.ltrim(e.getText()),n=e.hJ();if(!t){e.remove();continue}t.length<n&&(e.split(n-t.length),this.$.removeChild(this.$.firstChild))}break}},rtrim:function(){for(var e,t=this;t.dB&&(e=t.dB());){if(e.type==V.fl){var n=G.rtrim(e.getText()),i=e.hJ();if(!n){e.remove();continue}n.length<i&&(e.split(n.length),t.$.lastChild.parentNode.removeChild(t.$.lastChild))}break}L||W.opera||(e=t.$.lastChild)&&1==e.type&&"br"==e.nodeName.toLowerCase()&&e.parentNode.removeChild(e)}}),w.iT=function(e){this.$=e},w.iT.prototype={count:function(){return this.$.length},getItem:function(e){var t=this.$[e];return t?new w.bi(t):null}},w.element=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createElement(e)),w.dE.call(this,e)};var S,Y=w.element;function N(e){this.$.removeAttribute(e)}function D(e,t){return this.$.setAttribute(e,t),this}function T(e){return this.$.getAttribute(e,2)}function R(e){for(var t=0,n=0,i=S[e].length;n<i;n++)t+=parseInt(this.getComputedStyle(S[e][n])||0,10)||0;return t}Y.eB=function(e){return e&&(e.$?e:new Y(e))},Y.prototype=new w.bi,Y.kE=function(e,t){var n=new Y("div",t);return n.setHtml(e),n.getFirst().remove()},Y.rS=function(e,t,n,i){var o=t.dw("list_marker_id")||t.fL("list_marker_id",G.getNextNumber()).dw("list_marker_id"),a=t.dw("list_marker_names")||t.fL("list_marker_names",{}).dw("list_marker_names");return e[o]=t,a[n]=1,t.fL(n,i)},Y.sM=function(e){for(var t in e)Y.qZ(e,e[t],!0)},Y.qZ=function(e,t,n){var i=t.dw("list_marker_names"),o=t.dw("list_marker_id");for(var a in i)t.jF(a);t.jF("list_marker_names"),n&&(t.jF("list_marker_id"),delete e[o])},G.extend(Y.prototype,{type:V.cv,addClass:function(e){var t=this.$.className;t&&(new RegExp("(?:^|\\s)"+e+"(?:\\s|$)","").test(t)||(t+=" "+e));this.$.className=t||e},removeClass:function(e){var t=this.getAttribute("class");if(t){var n=new RegExp("(?:^|\\s+)"+e+"(?=\\s|$)","i");n.test(t)&&((t=t.replace(n,"").replace(/^\s+/,""))?this.setAttribute("class",t):this.removeAttribute("class"))}},hasClass:function(e){return new RegExp("(?:^|\\s+)"+e+"(?=\\s|$)","").test(this.getAttribute("class"))},append:function(e,t){var n=this;return"string"==typeof e&&(e=n.getDocument().createElement(e)),t?n.$.insertBefore(e.$,n.$.firstChild):n.$.appendChild(e.$),V.log("[DOM] DOM flush into "+n.getName()),e},appendHtml:function(e){if(this.$.childNodes.length){var t=new Y("div",this.getDocument());t.setHtml(e),t.jg(this)}else this.setHtml(e)},appendText:function(e){null!=this.$.text?this.$.text+=e:this.append(new w.text(e))},pd:function(){for(var e=this.dB();e&&e.type==V.fl&&!G.rtrim(e.getText());)e=e.cf();e&&e.is&&e.is("br")||this.append(W.opera?this.getDocument().jT(""):this.getDocument().createElement("br"))},tV:function(e){var t=new w.mk(this.getDocument());t.setStartAfter(this),t.setEndAfter(e);var n=t.extractContents();t.insertNode(this.remove()),n.kA(this)},contains:L||W.webkit?function(e){var t=this.$;return e.type!=V.cv?t.contains(e.getParent().$):t!=e.$&&t.contains(e.$)}:function(e){return!!(16&this.$.compareDocumentPosition(e.$))},focus:function(){try{this.$.focus()}catch(e){}},getHtml:function(){return this.$.innerHTML},fH:function(){if(this.$.outerHTML)return this.$.outerHTML.replace(/<\?[^>]*>/,"");var e=this.$.ownerDocument.createElement("div");return e.appendChild(this.$.cloneNode(!0)),e.innerHTML},setHtml:function(e){return V.log("[DOM] DOM flush into "+this.getName()),this.$.innerHTML=e},setText:function(e){return Y.prototype.setText=null!=this.$.innerText?function(e){return V.log("[DOM] Text flush"),this.$.innerText=e}:function(e){return V.log("[DOM] Text flush"),this.$.textContent=e},this.setText(e)},getAttribute:L&&(W.ie7Compat||W.ie6Compat)?function(e){var t=this;switch(e){case"class":e="className";break;case"tabindex":var n=T.call(t,e);return 0!==n&&0===t.$.tabIndex&&(n=null),n;case"checked":return t.$.checked;case"style":return t.$.style.cssText}return T.call(t,e)}:T,getChildren:function(){return new w.iT(this.$.childNodes)},getComputedStyle:L?function(e){return this.$.currentStyle[G.cssStyleToDomStyle(e)]}:function(e){return this.getWindow().$.getComputedStyle(this.$,"").getPropertyValue(e)},pf:function(){var e=V.ga[this.getName()];return this.pf=function(){return e},e},eG:I.prototype.eG,vp:L?function(){var e=this.$.tabIndex;return 0!==e||V.ga.ug[this.getName()]||0===parseInt(this.getAttribute("tabindex"),10)||(e=-1),e}:W.webkit?function(){var e=this.$.tabIndex;return null==e&&(e=parseInt(this.getAttribute("tabindex"),10),isNaN(e)&&(e=-1)),e}:function(){return this.$.tabIndex},getText:function(){return this.$.textContent||this.$.innerText||""},getWindow:function(){return this.getDocument().getWindow()},dS:function(){return this.$.id||null},data:function(e,t){return e="data-"+e,void 0===t?this.getAttribute(e):(!1===t?this.removeAttribute(e):this.setAttribute(e,t),null)},vm:function(){return this.$.name||null},getName:function(){var e=this.$.nodeName.toLowerCase();if(L&&!(8<document.documentMode)){var t=this.$.scopeName;"HTML"!=t&&(e=t.toLowerCase()+":"+e)}return(this.getName=function(){return e})()},getValue:function(){return this.$.value},getFirst:function(){var e=this.$.firstChild;return e?new w.bi(e):null},dB:function(e){var t=this.$.lastChild,n=t&&new w.bi(t);return n&&e&&!e(n)&&(n=n.cf(e)),n},rd:function(e){return this.$.style[G.cssStyleToDomStyle(e)]},is:function(){for(var e=this.getName(),t=0;t<arguments.length;t++)if(arguments[t]==e)return!0;return!1},vL:function(){var e=this.getName(),t=!V.ga.uj[e]&&(V.ga[e]||V.ga.span);return t&&t["#"]},isIdentical:function(e){if(this.getName()!=e.getName())return!1;var t=this.$.attributes,n=e.$.attributes,i=t.length,o=n.length;if(!L&&i!=o)return!1;for(var a=0;a<i;a++){var r=t[a];if((!L||r.specified&&"_ckf_expando"!=r.nodeName)&&r.nodeValue!=e.getAttribute(r.nodeName))return!1}if(L)for(a=0;a<o;a++)if(r=n[a],(!L||r.specified&&"_ckf_expando"!=r.nodeName)&&r.nodeValue!=t.getAttribute(r.nodeName))return!1;return!0},isVisible:function(){return this.$.offsetWidth&&"hidden"!=this.$.style.visibility},hasAttributes:L&&(W.ie7Compat||W.ie6Compat)?function(){for(var e=this.$.attributes,t=0;t<e.length;t++){var n=e[t];switch(n.nodeName){case"class":if(this.getAttribute("class"))return!0;case"_ckf_expando":continue;default:if(n.specified)return!0}}return!1}:function(){var e=this.$.attributes;return 1<e.length||1==e.length&&"_ckf_expando"!=e[0].nodeName},hasAttribute:function(e){var t=this.$.attributes.getNamedItem(e);return!(!t||!t.specified)},hide:function(){this.setStyle("display","none")},jg:function(e,t){var n,i=this.$;if(i!=(e=e.$))if(t)for(;n=i.lastChild;)e.insertBefore(i.removeChild(n),e.firstChild);else for(;n=i.firstChild;)e.appendChild(i.removeChild(n))},show:function(){this.setStyles({display:"",visibility:""})},setAttribute:L&&(W.ie7Compat||W.ie6Compat)?function(e,t){var n=this;return"class"==e?n.$.className=t:"style"==e?n.$.style.cssText=t:"tabindex"==e?n.$.tabIndex=t:"checked"==e?n.$.checked=t:D.apply(n,arguments),n}:D,setAttributes:function(e){for(var t in e)this.setAttribute(t,e[t]);return this},setValue:function(e){return this.$.value=e,this},removeAttribute:L&&(W.ie7Compat||W.ie6Compat)?function(e){"class"==e?e="className":"tabindex"==e&&(e="tabIndex"),N.call(this,e)}:N,uW:function(e){for(var t=0;t<e.length;t++)this.removeAttribute(e[t])},removeStyle:function(e){var t=this;t.$.style.removeAttribute?t.$.style.removeAttribute(G.cssStyleToDomStyle(e)):t.setStyle(e,""),t.$.style.cssText||t.removeAttribute("style")},setStyle:function(e,t){return this.$.style[G.cssStyleToDomStyle(e)]=t,this},setStyles:function(e){for(var t in e)this.setStyle(t,e[t]);return this},setOpacity:function(e){L&&W.version<9?(e=Math.round(100*e),this.setStyle("filter",100<=e?"":"progid:DXImageTransform.Microsoft.Alpha(opacity="+e+")")):this.setStyle("opacity",e)},unselectable:W.gecko?function(){this.$.style.MozUserSelect="none"}:W.webkit?function(){this.$.style.uE="none"}:function(){if(L||W.opera){var e,t=this.$,n=0;for(t.unselectable="on";e=t.all[n++];)switch(e.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:e.unselectable="on"}}},vr:function(){for(var e=this;"html"!=e.getName();){if("static"!=e.getComputedStyle("position"))return e;e=e.getParent()}return null},ir:function(e){var t=this,n=0,i=0,o=t.getDocument().bH(),a="BackCompat"==t.getDocument().$.compatMode,r=t.getDocument();if(document.documentElement.getBoundingClientRect){var l=t.$.getBoundingClientRect(),s=r.$.documentElement,d=s.clientTop||o.$.clientTop||0,c=s.clientLeft||o.$.clientLeft||0,u=!0;if(L){var f=r.gT().contains(t),p=r.bH().contains(t);u=a&&p||!a&&f}u&&(n=l.left+(!a&&s.scrollLeft||o.$.scrollLeft),n-=c,i=l.top+(!a&&s.scrollTop||o.$.scrollTop),i-=d)}else for(var h,m=t,g=null;m&&"body"!=m.getName()&&"html"!=m.getName();){n+=m.$.offsetLeft-m.$.scrollLeft,i+=m.$.offsetTop-m.$.scrollTop,m.equals(t)||(n+=m.$.clientLeft||0,i+=m.$.clientTop||0);for(var v=g;v&&!v.equals(m);)n-=v.$.scrollLeft,i-=v.$.scrollTop,v=v.getParent();m=(h=(g=m).$.offsetParent)?new Y(h):null}if(e){var b=t.getWindow(),y=e.getWindow();if(!b.equals(y)&&b.$.frameElement){var w=new Y(b.$.frameElement).ir(e);n+=w.x,i+=w.y}}return document.documentElement.getBoundingClientRect||W.gecko&&!a&&(n+=t.$.clientLeft?1:0,i+=t.$.clientTop?1:0),{x:n,y:i}},scrollIntoView:function(e){var t=this.getWindow(),n=t.eR().height,i=-1*n;e?i+=n:(i+=this.$.offsetHeight||0,i+=parseInt(this.getComputedStyle("marginBottom")||0,10)||0),i=(i+=this.ir().y)<0?0:i;var o=t.hV().y;(o<i||i<o-n)&&t.$.scrollTo(0,i)},bR:function(e){var t=this;switch(e){case V.eV:t.addClass("cke_on"),t.removeClass("cke_off"),t.removeClass("cke_disabled");break;case V.aY:t.addClass("cke_disabled"),t.removeClass("cke_off"),t.removeClass("cke_on");break;default:t.addClass("cke_off"),t.removeClass("cke_on"),t.removeClass("cke_disabled")}},getFrameDocument:function(){var t=this.$;try{t.contentWindow.document}catch(e){t.src=t.src,L&&W.version<7&&window.showModalDialog('javascript:document.write("<script>window.setTimeout(function(){window.close();},50);<\/script>")')}return t&&new I(t.contentWindow.document)},qw:function(e,t){var n=this.$.attributes;t=t||{};for(var i=0;i<n.length;i++){var o=n[i];if(o.specified||L&&o.nodeValue&&"value"==o.nodeName.toLowerCase()){var a=o.nodeName;if(a in t)continue;var r=this.getAttribute(a);null===r&&(r=o.nodeValue),e.setAttribute(a,r)}}""!==this.$.style.cssText&&(e.$.style.cssText=this.$.style.cssText)},renameNode:function(e){var t=this;if(t.getName()!=e){var n=t.getDocument(),i=new Y(e,n);t.qw(i),t.jg(i),t.$.parentNode.replaceChild(i.$,t.$),i.$._ckf_expando=t.$._ckf_expando,t.$=i.$}},getChild:function(e){var t=this.$;if(e.slice)for(;0<e.length&&t;)t=t.childNodes[e.shift()];else t=t.childNodes[e];return t?new w.bi(t):null},iu:function(){return this.$.childNodes.length},hX:function(){this.on("contextmenu",function(e){e.data.bK().hasClass("cke_enable_context_menu")||e.data.preventDefault()})},toString:function(){return this.getName()+"#"+this.dS()+"."+this.getAttribute("class")}}),S={width:["border-left-width","border-right-width","padding-left","padding-right"],height:["border-top-width","border-bottom-width","padding-top","padding-bottom"]},Y.prototype.setSize=function(e,t,n){"number"==typeof t&&(!n||L&&W.quirks||(t-=R.call(this,e)),this.setStyle(e,t+"px"))},Y.prototype.hR=function(e,t){var n=Math.max(this.$["offset"+G.capitalize(e)],this.$["client"+G.capitalize(e)])||0;return t&&(n-=R.call(this,e)),n},V.command=function(t,n){this.pW=[],this.exec=function(e){return!(this.bu==V.aY||!1===this.readOnly&&t.config.readOnly)&&(n.oD&&t.focus(),!1!==n.exec.call(this,t,e))},G.extend(this,n,{iH:{qt:1},oD:!0,bu:V.aS}),V.event.call(this)},V.command.prototype={enable:function(){var e=this;e.bu==V.aY&&e.bR(e.vf&&void 0!==e.lJ?e.lJ:V.aS)},disable:function(){this.bR(V.aY)},bR:function(e){var t=this;return t.bu!=e&&(t.lJ=t.bu,t.bu=e,t.oW("bu"),!0)},rJ:function(){this.bu==V.aS?this.bR(V.eV):this.bu==V.eV&&this.bR(V.aS)}},V.event.du(V.command.prototype,!0),V.config={customConfig:V.getUrl("config.js"),connectorLanguage:"php",language:"",defaultLanguage:"en",defaultViewType:"thumbnails",defaultSortBy:"filename",defaultDisplayFilename:!0,defaultDisplayDate:!0,defaultDisplayFilesize:!0,pO:"",height:400,plugins:"foldertree,folder,filebrowser,container,connector,resource,search,toolbar,formpanel,filesview,status,contextmenu,uploadform,keystrokes,dragdrop,basket,dialog,tools,resize,maximize,help,mobile,html5upload,gallery,csrftokenmanager",extraPlugins:"",fileIcons:"ai|avi|bmp|cs|dll|doc|docx|exe|fla|gif|jpg|js|mdb|mp3|ogg|pdf|ppt|pptx|rdp|swf|swt|txt|vsd|xls|xlsx|xml|zip",removePlugins:"",tabIndex:0,thumbnailDelay:100,theme:"default",skin:"kama",width:"100%",baseFloatZIndex:1e4,directDownload:!1,log:!1,logStackTrace:!1,rememberLastFolder:!0,id:null,startupPath:"",startupFolderExpanded:!0,selectActionFunction:null,selectActionData:null,selectThumbnailActionFunction:null,selectThumbnailActionData:null,disableThumbnailSelection:!1,thumbsUrl:null,thumbsDirectAccess:!1,imagesMaxWidth:0,imagesMaxHeight:0,selectActionType:"js",resourceType:null,disableHelpButton:!1,connectorPath:"",connectorInfo:"",uiColor:null,showContextMenuArrow:!1,useNativeIcons:!1,maxSimultaneousUploads:1,readOnly:!1,selectMultiple:!0,popupTitle:"CKFinder 2",popupFeatures:"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes"},CKFinder.config=V.config;var $,O,U=V.config;V.dU=function(e,t){this.rG=e,this.message=t},V.fs=function(e){return e.fs?e.fs:(this.hasFocus=!1,this._={application:e},this)},V.fs.prototype={focus:function(){var e=this;if(e._.fW&&clearTimeout(e._.fW),!e.hasFocus){V.nG&&V.nG.fs.ly();var t=e._.application;t.container.getFirst().addClass("cke_focus"),e.hasFocus=!0,t.oW("focus")}},blur:function(){var e=this;e._.fW&&clearTimeout(e._.fW),e._.fW=setTimeout(function(){delete e._.fW,e.ly()},100)},ly:function(){if(this.hasFocus){var e=this._.application;e.container.getFirst().removeClass("cke_focus"),this.hasFocus=!1,e.oW("blur")}}},V.lang={ko:{bg:1,ca:1,cs:1,cy:1,da:1,de:1,el:1,en:1,eo:1,es:1,"es-mx":1,et:1,fa:1,fi:1,fr:1,gu:1,he:1,hi:1,hr:1,hu:1,it:1,ja:1,lv:1,lt:1,nb:1,nl:1,no:1,nn:1,pl:1,"pt-br":1,ro:1,ru:1,sk:1,sl:1,sr:1,sv:1,tr:1,vi:1,"zh-cn":1,"zh-tw":1},load:function(e,t,n){e&&V.lang.ko[e]||(e=this.jV(t,e)),this[e]?n(e,this[e]):V.scriptLoader.load(V.getUrl("lang/"+e+".js"),function(){n(e,CKFinder.lang[e])},this)},jV:function(e,t){var n=this.ko,i=(t=t||navigator.userLanguage||navigator.language).toLowerCase().match(/([a-z]+)(?:-([a-z]+))?/),o=i[1],a=i[2];return n[o+"-"+a]?o=o+"-"+a:n[o]||(o=null),V.lang.jV=o?function(){return o}:function(e){return e},o||e}},V.log=function(){if(U.log||window.CKFINDER_LOG){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(n)switch(e&&(e+="; "),typeof n){case"function":var i=/function (\w+?)\(/.exec(n.toString());e+=i=i?i[1]:"anonymous func";break;default:e+=n?n.toString():""}}V._.log.push(e),"object"==typeof window.console&&(console.log.apply?console.log.apply(console,arguments):console.log(e))}},V.ba=function(e){return U.logStackTrace&&V.log("[EXCEPTION] "+e.toString()),e},V.mZ=function(e){for(var t="",n=0;n<V._.log.length;n++)t+=n+1+". "+V._.log[n]+"\n";return t},V._.log=[],V.scriptLoader=($={},O={},{load:function(e,i,t,o,a,r){var n="string"==typeof e;function l(e){i&&(n?i.call(t,e):i.call(t,d,c))}n&&(e=[e]),t=t||V;var s=e.length,d=[],c=[];if(0!==s){function u(e,t){(t?d:c).push(e),--s<=0&&l(t)}function f(e,t){$[e]=1;var n=O[e];delete O[e];for(var i=0;i<n.length;i++)n[i](e,t)}function p(e){if(!0!==o&&$[e])u(e,!0);else{var t=O[e]||(O[e]=[]);if(t.push(u),!(1<t.length)){var n=new Y("script",r);n.setAttributes({type:"text/javascript",src:e}),i&&(L?n.$.onreadystatechange=function(){"loaded"!=n.$.readyState&&"complete"!=n.$.readyState||(n.$.onreadystatechange=null,V.log("[LOADED] "+e),f(e,!0))}:(n.$.onload=function(){setTimeout(function(){V.log("[LOADED] "+e),f(e,!0)},0)},n.$.onerror=function(){f(e,!1)})),n.appendTo(a||V.document.getHead())}}}for(var h=0,m=s;h<m;h++)p(e[h])}else l(!0)},uq:function(e){var t=new Y("script");t.setAttribute("type","text/javascript"),t.appendText(e),t.appendTo(V.document.getHead())}}),CKFinder.scriptLoader=V.scriptLoader,V.fQ=function(e,t){var n=this;n.basePath=e,n.fileName=t,n.bX={},n.loaded={},n.jn={},n._={rZ:{}}},V.fQ.prototype={add:function(e,t){if(this.bX[e])throw'[CKFINDER.fQ.add] The resource name "'+e+'" is already bX.';this.bX[e]=t||{}},eB:function(e){return this.bX[e]||null},getPath:function(e){var t=this.jn[e];return V.getUrl(t&&t.dir||this.basePath+e+"/")},pi:function(e){var t=this.jn[e];return V.getUrl(this.getPath(e)+(t&&t.file||this.fileName+".js"))},tR:function(e,t,n){e=e.split(",");for(var i=0;i<e.length;i++){var o=e[i];this.jn[o]={dir:t,file:n}}},load:function(e,r,l){G.isArray(e)||(e=e?[e]:[]);for(var s=this.loaded,t=this.bX,n=[],d={},c={},i=0;i<e.length;i++){var o=e[i];if(o)if(s[o]||t[o])c[o]=this.eB(o);else{var a=this.pi(o);n.push(a),a in d||(d[a]=[]),d[a].push(o)}}V.scriptLoader.load(n,function(e,t){if(t.length)throw'[CKFINDER.fQ.load] Resource name "'+d[t[0]].join(",")+'" was not found at "'+t[0]+'".';for(var n=0;n<e.length;n++)for(var i=d[e[n]],o=0;o<i.length;o++){var a=i[o];c[a]=this.eB(a),s[a]=1}r.call(l,c)},this)}},V.plugins=new V.fQ("plugins/","plugin");var A,P,B,M,q,j=V.plugins;function H(e,t){function n(){A[e]=1,t()}var i=new Y("img");i.on("load",n),i.on("error",n),i.setAttribute("src",e)}j.load=G.override(j.load,function(t){return function(e,r,l){var s={},d=function(e){t.call(this,e,function(e){G.extend(s,e);var t=[];for(var n in e){var i=e[n],o=i&&i.bM;if(o)for(var a=0;a<o.length;a++)s[o[a]]||t.push(o[a])}if(t.length)d.call(this,t);else{for(n in s)(i=s[n]).onLoad&&!i.onLoad.qK&&(i.onLoad(),i.onLoad.qK=1);r&&r.call(l||window,s)}},this)};d.call(this,e)}}),j.rX=function(e,t,n){this.eB(e).lang[t]=n},A={},V.rw={load:function(e,t){function n(){0==--i&&t()}for(var i=e.length,o=0;o<e.length;o++){var a=e[o];A[a]?n():H(a,n)}}},V.skins=(B={},M={},q=function(t,n,i,e){var o=P[n];t.skin||(t.skin=o).bz&&o.bz(t);function a(e){for(var t=0;t<e.length;t++)e[t]=V.getUrl(M[n]+e[t])}if(!B[n]){var r=o.ls;if(r&&0<r.length)return a(r),void V.rw.load(r,function(){B[n]=1,q(t,n,i,e)});B[n]=1}var l=0;if((i=o[i])?i.iB?i.iB[t.name]&&(l=1):i.iB=[]:l=1,l)e&&e();else{void 0===i.eb&&(i.eb=[]),void 0===i.eb[t.name]&&(i.eb[t.name]=[]);var s=i.eb[t.name];if(s.push(e),1<s.length)return;function d(){if(c&&u){i.iB[t.name]=1;for(var e=0;e<s.length;e++)s[e]&&s[e]()}}var c=!i.css||!i.css.length,u=!i.js||!i.js.length;if(!c){if(i.rr||(a(i.css),i.rr=1),i.qx)for(var f=0;f<i.css.length;f++)V.oC.appendStyleSheet(i.css[f]);else t.on("themeSpace",function(e){if("head"==e.data.space)for(var t=0;t<i.css.length;t++)e.data.html+="<link rel='stylesheet' href='"+i.css[t]+"'>\n";e.removeListener()});c=1}u||(a(i.js),t.scriptLoader.load(i.js,function(){u=1,d()})),d()}},{add:function(e,t){(P[e]=t).fh=M[e]||(M[e]=V.getUrl("skins/"+e+"/"))},loaded:P={},load:function(e,t,n){var i=e.gd,o=e.fh;P[i]?(q(e,i,t,n),P[i]):(M[i]=o,V.scriptLoader.load(o+"skin.js",function(){q(e,i,t,n)}))}}),V.gc=new V.fQ("gc/","theme"),V.bY=function(e){return e.bY?e.bY:(this._={jZ:{},items:{},application:e},this)};var z,K,X,Z,Q,J,ee,te,ne,ie,oe,ae,re,le,se,de,ce,ue,fe,pe,he,me,ge,ve,be,ye,we,_e,Fe,ke,Ce,xe,Ee,Se,Ne,De,Te,Re,$e,We,Le,Ie,Oe,Ue,Ae,Pe,Be,Me,qe,je=V.bY;function He(t,e){var n,i=[V.oC];if(e.$.top.location.href.match(/ckfinder.html/)||"CKFinderpopup"==e.$.top.name){if(t.document.focus(),t.focus(),t.cg.inUrlPopup)try{i.push(new I(V.oC.getWindow().$.opener.document))}catch(e){}var o,a;for(o=t,a=e,V.event.jP=!0,o.document.on("keydown",function(e){var t=e.data,n=t.oV(),i=t.db();if(116==n||i==V.bP+82||i==V.bP+V.dy+82){o.execCommand("refresh"),a.$.event&&a.$.event.keyCode&&(a.$.event.keyCode=5055);try{e.data.preventDefault()}catch(e){}}}),V.event.jP=!1,function(e,t){var n,i,o=[];for(i=0;i<t.length;i++)n=t[i],o.push({evt:"onbeforeunload",bi:n.bH().$,fO:n.bH().$.onbeforeunload},{evt:"onunload",bi:n.getWindow().$,fO:n.getWindow().$.onunload},{evt:"onbeforeunload",bi:n.getWindow().$,fO:n.getWindow().$.onbeforeunload});e.$.onunload=e.$.onbeforeunload=function(){var e;for(e=0;e<o.length;e+=1)o[e].bi[o[e].evt]=o[e].fO}}(e,i),n=0;n<i.length;n+=1)i[n].bH().$.onbeforeunload=i[n].getWindow().$.onunload=i[n].getWindow().$.onbeforeunload=function(){var e=t.element&&t.element.getDocument().getWindow().$;e.closed||e.close()}}}function ze(e){for(var t=e.getChildren(),n=0,i=t.count();n<i;n++){var o=t.getItem(n);if(o.type==V.cv&&V.ga.um[o.getName()])return 1}}if(je.prototype={add:function(e,t,n){this._.items[e]={type:t,command:n.command||null,mp:Array.prototype.slice.call(arguments,2)}},create:function(e){var t=this._.items[e],n=t&&this._.jZ[t.type],i=t&&t.command&&this._.application.cS(t.command),o=n&&n.create.apply(this,t.mp);return i&&i.pW.push(o),o},kd:function(e,t){this._.jZ[e]=t}},z=0,K=function(){var e="ckfinder"+ ++z;return V.instances&&V.instances[e]?K():e},X={},Z=function(e){var t=e.config.customConfig;if(!t)return!1;var n=X[t]||(X[t]={});return n.fn?setTimeout(function(){n.fn.call(e,e.config),e.config.customConfig!=t&&Z(e)||e.cr("customConfigLoaded")},0):V.scriptLoader.load(t,function(){CKFinder.customConfig?n.fn=CKFinder.customConfig:n.fn=function(){},Z(e)}),!0},Q=function(e){var t=e.config.skin.split(","),n=t[0],i=V.getUrl(t[1]||"skins/"+n+"/");e.gd=n,e.fh=i,e.iy="cke_skin_"+n+" skin_"+n,e.qn=e.ox(),e.on("uiReady",function(){e.document.getWindow().on("lW",function(){G.setCookie("CKFinder_UTime",Math.round((new Date).getTime()/1e3),!0),G.setCookie("CKFinder_UId",encodeURIComponent(e.id?e.id:location.href),!0)})}),e.cr("configLoaded"),J(e)},J=function(o){V.lang.load(o.config.language,o.config.defaultLanguage,function(e,t){var n,i;o.langCode=e,o.lang=G.prototypedCopy(t),o.lB=(n="['"+o.lang.DateAmPm.join("','")+"']",i=(i="'"+(i=o.lang.DateTime.replace(/dd|mm|yyyy|hh|HH|MM|aa|d|m|yy|h|H|M|a/g,function(e){var t;switch(e){case"d":t="day.replace(/^0/,'')";break;case"dd":t="day";break;case"m":t="month.replace(/^0/,'')";break;case"mm":t="month";break;case"yy":t="year.substr(2)";break;case"yyyy":t="year";break;case"H":t="hour.replace(/^0/,'')";break;case"HH":t="hour";break;case"h":t="( hour < 12 ? hour : ( ( hour - 12 ) + 100 ).toString().substr( 1 ) ).replace(/^0/,'')";break;case"hh":t="( hour < 12 ? hour : ( ( hour - 12 ) + 100 ).toString().substr( 1 ) )";break;case"M":t="minute.replace(/^0/,'')";break;case"MM":t="minute";break;case"a":t=n+"[ hour < 12 ? 0 : 1 ].charAt(0)";break;case"aa":t=n+"[ hour < 12 ? 0 : 1 ]";break;default:t="'"+e+"'"}return"',"+t+",'"}))+"'").replace(/('',)|,''$/g,""),new Function("day","month","year","hour","minute","return ["+i+"].join('');")),W.gecko&&W.version<10900&&"rtl"==o.lang.dir&&(o.lang.dir="ltr"),ee(o)})},ee=function(d){var e=d.config,t=e.plugins,n=e.extraPlugins,i=e.removePlugins;if(n){var o=new RegExp("(?:^|,)(?:"+n.replace(/\s*,\s*/g,"|")+")(?=,|$)","g");t=t.replace(o,""),t+=","+n}i&&(o=new RegExp("(?:^|,)(?:"+i.replace(/\s*,\s*/g,"|")+")(?=,|$)","g"),t=t.replace(o,"")),j.load(t.split(","),function(e){var o=[],a=[],t=[];if(d.config.readOnly)for(var n in e)!1===e[n].readOnly&&delete e[n];for(n in d.plugins=e){var i=e[n],r=i.lang,l=j.getPath(n),s=null;e[n].name=n,i.pathName=l,r&&(s=0<=G.indexOf(r,d.langCode)?d.langCode:r[0],i.lang[s]?(G.extend(d.lang,i.lang[s]),s=null):t.push(V.getUrl(l+"lang/"+s+".js"))),a.push(s),o.push(i)}V.scriptLoader.load(t,function(){for(var e=["eK","bz","gr"],t=0;t<e.length;t++)for(var n=0;n<o.length;n++){var i=o[n];0===t&&a[n]&&i.lang&&G.extend(d.lang,i.lang[a[n]]),i[e[t]]&&(V.log("[PLUGIN] "+i.name+"."+e[t]),i[e[t]](d))}d.oW("pluginsLoaded"),te(d)})})},te=function(e){V.skins.load(e,"application",function(){V.skins.load(e,"host",function(){ne(e)})})},ne=function(e){var t=e.config.theme;V.gc.load(t,function(){(e.theme=V.gc.eB(t)).pathName=V.gc.getPath(t),e.oW("themeAvailable")})},V.application.prototype.iI=function(e){var t,n,i=Y.eB(this._.element),o=this._.instanceConfig;if(delete this._.element,delete this._.instanceConfig,this._.ky={},this._.gS=[],i.getDocument().getWindow().$.CKFinder=e,this.element=i,this.document=null,this.rQ={},this.name=K(),this.name in V.instances)throw'[CKFINDER.application] The instance "'+this.name+'" already exists.';this.config=G.prototypedCopy(U),this.bY=new je(this),this.fs=new V.fs(this),this.aL={},this.ld={},this.on("uiReady",function(e){var t=this,n=t.document.getWindow();n.on("lW",t.destroy,t),t.cg.inPopup&&He(t,n)},this),this.cg=new a(this),this.on("configLoaded",function(e){var t,n,i,o=this;t=o.cg,i=(n=o).config.callback,n.on("appReady",function(e){e.removeListener(),t.document=n.document.$,t.folders=n.folders,t.files=n.ld["filesview.filesview"].data().files,t.basketFiles=n.basketFiles,t.resourceTypes=n.resourceTypes,t.connector=n.connector,t.lang=n.lang,t.langCode=n.langCode,t.config=n.config,n.ld["foldertree.foldertree"].on("afterAddFolder",function(e){e.removeListener(),i&&i(t)},t)},t,null,999),o.id=o.config.id},this),n=o,(t=this).on("customConfigLoaded",function(){if(n){if(n.on)for(var e in n.on)t.on(e,n.on[e]);G.extend(t.config,n,!0),delete t.config.on}Q(t)}),n&&n.id&&(t.config.id=n.id),n&&null!=n.customConfig&&(t.config.customConfig=n.customConfig),Z(t)||t.cr("customConfigLoaded"),V.oW("instanceCreated",null,this)},G.extend(V.application.prototype,{bD:function(e,t){return this._.ky[e]=new V.command(this,t)},destroy:function(){this.theme.destroy(this),this.oW("destroy"),V.remove(this)},execCommand:function(e,t){V.log("[COMMAND] "+e);var n=this.cS(e),i={name:e,rm:t,command:n};return!(!n||n.bu==V.aY||!0===this.oW("beforeCommandExec",i)||(i.returnValue=n.exec(i.rm),n.async||!0===this.oW("afterCommandExec",i)))&&i.returnValue},cS:function(e){return this._.ky[e]},ox:function(){var e=Math.round((new Date).getTime()/1e3),t=G.getCookie("CKFinder_UTime"),n=decodeURIComponent(G.getCookie("CKFinder_UId"));return n&&t&&n==(this.id?this.id:location.href)&&Math.abs(e-t)<5?1:0},bs:""}),function(){for(var e="",t=49;t<58;t++)e+=String.fromCharCode(t);for(t=65;t<91;t++)73!=t&&79!=t&&(e+=String.fromCharCode(t));V.bs=e,V.nd="lo",V.jG="ho",V.hf=new window.RegExp("^www\\."),V.hg=new window.RegExp(":\\d+$"),V.lS=function(e){return e.toLowerCase().replace(V.hf,"").replace(V.hg,"")}}(),V.on("loaded",function(){var e=V.application.eb;if(e){delete V.application.eb;for(var t=0;t<e.length;t++)e[t].iI()}}),delete V.dO,V.instances={},V.document=new I(document),V.oC=V.document.getWindow().$!=V.document.getWindow().$.top?new I(V.document.getWindow().$.top.document):V.document,V.add=function(e){V.instances[e.name]=e,(V.jt=e).on("focus",function(){V.nG!=e&&(V.nG=e,V.oW("nG"))}),e.on("blur",function(){V.nG==e&&(V.nG=null,V.oW("nG"))})},V.remove=function(e){delete V.instances[e.name]},V.aL={},V.eV=1,V.aS=2,V.aY=0,V.bF="",function(){function u(e,t){return e+"."+(t.name||t||e)}V.ld={bX:{},hS:function(e,t,n){var i=u(e,t);if(void 0!==this.bX[i])throw"[CKFINDER] Widget "+i+" already bX!";return V.log("[WIDGET] bX "+i),this.bX[i]=new o(i,n),this.bX[i]},bz:function(e,t,n,i,o){function a(e,t,n){function i(e){this.ib=e}this.app=e,this.eh=t instanceof Y?t:new Y(t),this.hF=s?G.extend(s,n):n||{},this._={},i.prototype=this.tools,this.tools=new i(this);var o=l.dT;if(o.length)for(var a=0;a<o.length;a++)o[a].call(this,e,this)}var r=u(t,n),l=this.bX[r],s=G.deepCopy(l.hF);a.prototype=l;var d=new a(e,i,o);for(var c in d.fw)d.fw[c].readOnly&&e.config.readOnly?d.ke(c):d.gA(c);if(e.ld[r])throw"[CKFINDER Widget "+r+" already initiated.";return e.ld[r]=d,V.log("[WIDGET] instanced "+r),d}};var r={click:1,mouseover:1,mouseout:1,focus:1,blur:1,submit:1,dblclick:1,mousedown:1,mouseup:1,mousemove:1,keypress:1,keydown:1,keyup:1,load:1,lW:1,abort:1,error:1,resize:1,scroll:1,select:1,change:1,reset:1},o=function(e,t){var n=this;n.id=e,n.readOnly=!0,n.fw={},n.hF=t||{},n.dT=[],n.tools=new n.tools(n)};o.prototype={gA:function(e){var t=this;V.log("[WIDGET] Enabling behavior "+e);var n=t.fw[e];if(n)for(var i=t,o=0;o<n.cC.length;o++){var a=n.cC[o];r[a]?t.eh.on(a,n.fO,i):(t.on(a,n.fO,i),t.app.on(a,n.fO,i))}},ke:function(e){V.log("[WIDGET] Disabling behavior "+e);var t=this.fw[e];if(t)for(var n=0;n<t.cC.length;n++){var i=t.cC[n];r[i]?this.eh.removeListener(i,t.fO):this.removeListener(i,t.fO)}},bh:function(e,t,n,i){G.isArray(t)||(t=[t]),this.fw[e]={cC:t,fO:n,readOnly:!1===i},this.eh&&this.gA(e)},removeBehavior:function(e){delete this.fw[e]},ur:function(){return this.fw},bn:function(){return this.eh},oE:function(){return this.hF},data:function(){return this.hF},tools:function(){}},o.prototype.tools.prototype={kg:function(e){if(e.target==this.ib.eh)return 1}},V.event.du(o.prototype)}(),V.xml=function(e){var t=null;if("object"==typeof e)t=e;else{var n=(e||"").replace(/&nbsp;/g," ");if(window.DOMParser)t=(new DOMParser).parseFromString(n,"text/xml");else if(window.ActiveXObject){try{t=new ActiveXObject("MSXML2.DOMDocument")}catch(e){try{t=new ActiveXObject("Microsoft.XmlDom")}catch(e){}}t&&(t.async=!1,t.resolveExternals=!1,t.validateOnParse=!1,t.loadXML(n))}}this.mq=t},V.xml.prototype={selectSingleNode:function(e,t){var n=this.mq;if(t=t||n){if("selectSingleNode"in t)return t.selectSingleNode(e);if(n.evaluate)return(i=n.evaluate(e,t,null,9,null))&&i.singleNodeValue||null;if(t.querySelectorAll){var i,o=this.selectNodes(e,t);if(1==o.length)return(i=e.match(/\/@(.*$)/))?o[0].getAttributeNode(i[1]):o[0]}else alert("XPath is not supported in your browser")}return null},selectNodes:function(e,t){var n=this.mq,i=[];if(t=t||n){if("selectNodes"in t)return t.selectNodes(e);if(n.evaluate){var o=n.evaluate(e,t,null,5,null);if(o)for(var a;a=o.iterateNext();)i.push(a)}else{if(t.querySelectorAll){var r=e.replace(/\/@(.*$)/,"[$1]").replace(/\//gi,">");return t.querySelectorAll(r)}alert("XPath is not supported in your browser")}}return i},vB:function(e,t){var n=this.selectSingleNode(e,t),i=[];if(n)for(n=n.firstChild;n;)n.xml?i.push(n.xml):window.XMLSerializer&&i.push((new XMLSerializer).serializeToString(n)),n=n.nextSibling;return i.length?i.join(""):null}},ie={address:1,tY:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,de:1},oe={body:1,div:1,table:1,tbody:1,tr:1,td:1,th:1,caption:1,form:1},w.qS=function(e){for(var t=this,n=null,i=null,o=[],a=e;a;){if(a.type==V.cv){t.qH||(t.qH=a);var r=a.getName();if(L&&"HTML"!=a.$.scopeName&&(r=a.$.scopeName.toLowerCase()+":"+r),i||(!n&&ie[r]&&(n=a),oe[r]&&(n||"div"!=r||ze(a)?i=a:n=a)),o.push(a),"body"==r)break}a=a.getParent()}t.block=n,t.tX=i,t.elements=o},w.qS.prototype={sJ:function(e){var t=this.elements,n=e&&e.elements;if(!n||t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(!t[i].equals(n[i]))return!1;return!0}},w.text=function(e,t){"string"==typeof e&&(e=(t?t.$:document).createTextNode(e)),this.$=e},w.text.prototype=new w.bi,G.extend(w.text.prototype,{type:V.fl,hJ:function(){return this.$.nodeValue.length},getText:function(){return this.$.nodeValue},split:function(e){var t=this;if(L&&e==t.hJ()){var n=t.getDocument().jT("");return n.kB(t),n}var i=t.getDocument(),o=new w.text(t.$.splitText(e),i);if(W.ie8){var a=new w.text("",i);a.kB(o),a.remove()}return o},substring:function(e,t){return"number"!=typeof t?this.$.nodeValue.substr(e):this.$.nodeValue.substring(e,t)}}),w.pa=function(e){e=e||V.document,this.$=e.$.createDocumentFragment()},G.extend(w.pa.prototype,Y.prototype,{type:V.om,kA:function(e){(e=e.$).parentNode.insertBefore(this.$,e.nextSibling)}},!0,{append:1,pd:1,getFirst:1,dB:1,appendTo:1,jg:1,insertBefore:1,kA:1,replace:1,trim:1,type:1,ltrim:1,rtrim:1,getDocument:1,iu:1,getChild:1,getChildren:1}),function(){function i(e,t){if(this._.end)return null;var n,i,o=this.mk,a=this.vR,r=this.type,l=e?"getPreviousSourceNode":"getNextSourceNode";if(!this._.start&&(this._.start=1,o.trim(),o.collapsed))return this.end(),null;if(!e&&!this._.kp){var s=o.endContainer,d=s.getChild(o.endOffset);this._.kp=function(e,t){return!(t&&s.equals(e)||d&&e.equals(d)||e.type==V.cv&&"body"==e.getName())}}if(e&&!this._.ka){var c=o.startContainer,u=0<o.startOffset&&c.getChild(o.startOffset-1);this._.ka=function(e,t){return!(t&&c.equals(e)||u&&e.equals(u)||e.type==V.cv&&"body"==e.getName())}}var f=e?this._.ka:this._.kp;for(i=a?function(e,t){return!1!==f(e,t)&&a(e)}:f,this.current?n=this.current[l](!1,r,i):e?(n=o.endContainer,0<o.endOffset?!1===i(n=n.getChild(o.endOffset-1))&&(n=null):n=!1===i(n)?null:n.hZ(!0,r,i)):(n=(n=o.startContainer).getChild(o.startOffset))?!1===i(n)&&(n=null):n=!1===i(o.startContainer)?null:o.startContainer.hL(!0,r,i);n&&!this._.end;){if(this.current=n,this.lf&&!1===this.lf(n)){if(t&&this.lf)return!1}else if(!t)return n;n=n[l](!1,r,i)}return this.end(),this.current=null}function e(e){for(var t,n=null;t=i.call(this,e);)n=t;return n}w.gm=G.createClass({$:function(e){this.mk=e,this._={}},ej:{end:function(){this._.end=1},next:function(){return i.call(this)},previous:function(){return i.call(this,!0)},sC:function(){return!1!==i.call(this,!1,!0)},sD:function(){return!1!==i.call(this,!0,!0)},uF:function(){return e.call(this)},uB:function(){return e.call(this,!0)},reset:function(){delete this.current,this._={}}}});var n={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},o={hr:1};Y.prototype.qy=function(e){var t=G.extend({},o,e||{});return n[this.getComputedStyle("display")]||t[this.getName()]},w.gm.pQ=function(n){return function(e,t){return!(e.type==V.cv&&e.qy(n))}},w.gm.us=function(){return this.pQ({br:1})},w.gm.tU=function(e){},w.gm.tW=function(i,o){function a(e){return e&&e.getName&&"span"==e.getName()&&e.hasAttribute("_fck_bookmark")}return function(e){var t,n;return t=e&&!e.getName&&(n=e.getParent())&&a(n),t=i?t:t||a(e),o^t}},w.gm.sf=function(n){return function(e){var t=e&&e.type==V.fl&&!G.trim(e.getText());return n^t}}}(),function(){if(W.webkit)W.hc=!1;else{var e=Y.kE('<div style="width:0px;height:0px;position:absolute;left:-10000px;border:1px solid;border-color:red blue;"></div>',V.document);e.appendTo(V.document.getHead());try{W.hc=e.getComputedStyle("border-top-color")==e.getComputedStyle("border-right-color")}catch(e){W.hc=!1}W.hc&&(W.cssClass+=" cke_hc"),e.remove()}}(),j.load(U.pO.split(","),function(){V.status="loaded",V.oW("loaded");var e=V._.io;if(e){delete V._.io;for(var t=0;t<e.length;t++)V.add(e[t])}}),L)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}function Ke(e){var t={};if(0<e.length)for(var n=e.toLowerCase().split(","),i=0;i<n.length;i++)t[n[i]]=!0;return t}function Ve(e){this.app=e}function Ge(e,t,n,i,o){null===e.childFolders&&(e.childFolders=[]);var a=new V.aL.Folder(e.app,t,n,i,o);return a.parent=e,a.nh=e.isRoot?0:e.nh+1,e.childFolders.push(a),a}function Ye(e){return e.folders||(e.folders=[]),e.folders}function Xe(e,t){if(!e||0===e.length)throw new V.dU("name_empty",t.lang.ErrorMsg.FolderEmpty);if(ae.iz.test(e))throw new V.dU("name_invalid_chars",t.lang.ErrorMsg.FolderInvChar);return 1}function Ze(e){var t=e.hasChildren?"":" nochildren";return'<li id="'+("f"+e.index)+'" role="presentation" class="openable'+t+'"><span role="presentation" class="expander"'+(e.hasChildren?' onclick="void(0)"':"")+'></span><a tabindex="-1" role="treeitem" href="javascript:void(0)" aria-level="'+e.hU()+'">'+G.htmlEncode(e.name)+"</a>"+(e.isBasket?"":re)+"<ul></ul></li>"}function Qe(e,t){for(var n="",i=0;i<e.length;i++)n+=t(e[i]);return n}function Je(e,t,n){return function(e,t){for(var n in e)if(void 0!==t(e[n]))return e[n]}(e,function(e){if(e.tagName&&e.tagName.toLowerCase()==t&&!n--)return e})}function et(e){return new Y(e)}function tt(e){var t,n=[V.bF.substr(6,1),V.bF.substr(8,1)];V.ed&&n[0]!=(t=V.ed.length+V.bs.indexOf(n[1]),V.bs.substr(9*t%32,1))&&function(e){pe.reverse().join("");var t=e.tools.of();t.setHtml.call(t,e.qX()),e.bn().addClass("files_"+pe[0])}(e)}function nt(){return 1==V.bs.indexOf(V.bF.substr(1,1))%5&&window.top[V.nd+"cation"][V.jG+"st"].toLowerCase().replace(V.hf,"").replace(V.hg,"")!=V.lS(V.ed)||V.bF.substr(3,1)!=V.bs.substr(9*(V.bs.indexOf(V.bF.substr(0,1))+V.bs.indexOf(V.bF.substr(2,1)))%(V.bs.length-1),1)}function it(g,v,b,y,e,w){for(var t={},n=0,_=v.files,o=[v.destination],i=0,a=v.files.length;i<a;i++)v.destination!=_[i].folder&&(t["files["+n+"][name]"]=_[i].name,t["files["+n+"][type]"]=_[i].folder.type,t["files["+n+"][folder]"]=_[i].folder.getPath(),t["files["+n+"][options]"]=e&&e[i]||"",n++,b&&!y&&o.push(_[i].folder));if(y||(w=w||function(){},w=G.override(w,function(i){return function(){for(var e=g.ld["filesview.filesview"].tools.currentFolder(),t=0,n=o.length;t<n;t++)if(o[t]==e){g.oW("requestSelectFolder",{folder:e});break}return i}})),n){var F=g.connector,k=0,r=b?"MoveFiles":"CopyFiles";F.sendCommandPost(r,null,t,function(e){var t,n,i,o=e.getErrorNumber(),s=[],a=[];for(t=0,n=_.length;t<n;t++)a.push(_[t]);if(o==F.ERROR_COPY_FAILED||o==F.ERROR_MOVE_FAILED){k=1;var r,l,d,c,u=e.selectNodes("Connector/Errors/Error"),f=parseInt(e.selectSingleNode("Connector/"+(b?"MoveFiles/@moved":"CopyFiles/@copied")).value,10),p=0,h=[];for(t=0,n=u.length;t<n;t++)for((r=u[t].getAttribute("code"))==F.ERROR_ALREADYEXIST?p=1:h.push([u[t].getAttribute("name"),g.lang.Errors[r]]),l=0,d=a.length;l<d;l++)if((c=a[l])&&c.name==u[t].getAttribute("name")&&c.folder.getPath()==u[t].getAttribute("folder")&&c.folder.type==u[t].getAttribute("type")){u[t].getAttribute("code")==F.ERROR_ALREADYEXIST&&s.push(c),delete a[l];break}for(t=0,n=h.length;t<n;t++)h[t]=g.lang.FileError.replace("%s",h[t][0]).replace("%e",h[t][1]);f||p?h.length==a.length-f&&(i=g.lang.OperationCompletedErrors+" "+g.lang[b?"MovedFilesNumber":"CopiedFilesNumber"].replace("%s",f)+"<br /><br />",i+=g.lang[b?"MoveFailedList":"CopyFailedList"].replace("%s",at(h)),g.msgDialog("",i,w||null)):g.msgDialog("",g.lang.Errors[b?300:301]+"<br /><br />"+at(h),w||null);var m=ot(g,a,v.fileCallback);if(p&&g.cg.openDialog("moveFileExists",function(r){var l=arguments.callee;i="",h.length&&(i+=g.lang.OperationCompletedErrors+" "),i+=f?g.lang[b?"MovedFilesNumber":"CopiedFilesNumber"].replace("%s",f):"",h.length&&(i+=(i?"<br /><br />":"")+g.lang[b?"MoveFailedList":"CopyFailedList"].replace("%s",at(h))),i&&(i+="<br /><br />");var e=g.lang.ErrorMsg.FileExists;e=e.replace("%s",s[0]),i+="<strong>"+e+"</strong>",r.show(),r.getContentElement("tab1","msg").getElement().setHtml(i),r.on("ok",function(e){e.removeListener();var t,n=r.getContentElement("tab1","option").getValue(),i=r.getContentElement("tab1","remember").getValue();switch(n){case"autorename":case"overwrite":t=[n];break;case"skip":return void(i?w&&w():(s.shift(),s.length&&setTimeout(function(){g.cg.openDialog("moveFileExists",l)},0)))}if(i)for(var o=1,a=s.length;o<a;o++)t.push(t[0]);it(g,G.extend({files:s},v),b,1,t,w)})}),y)return}else e.checkError()&&(k=1);k?v.errorCallback&&v.errorCallback():(m=ot(g,a,v.fileCallback))?(i=g.lang.OperationCompletedSuccess+"<br />"+g.lang[b?"MovedFilesNumber":"CopiedFilesNumber"].replace("%s",m),g.msgDialog("",i,w||null)):w&&w()},v.destination.type,v.destination)}else w&&w()}function ot(e,t,n){for(var i,o=0,a=0,r=t.length;a<r;a++)(i=t[a])&&(o++,n&&n(e,i));return o}function at(e){return'<ul class="cke_files_list'+(3<e.length?" cke_files_list_many":"")+'"><li>'+e.join("</li><li>")+"</li></ul>"}function rt(a,r){for(var e={},l=r[0].folder,t=l.getPath(),n=0,i=r.length;n<i;n++)e["files["+n+"][name]"]=r[n].name,e["files["+n+"][type]"]=l.type,e["files["+n+"][folder]"]=t,a.oW("requestProcessingFile",{file:r[n]});a.connector.sendCommandPost("DeleteFiles",null,e,function(e){var t,n,i={};if(302==e.getErrorNumber()){if(!(r.length-parseInt(e.selectSingleNode("Connector/DeleteFiles/@deleted").value,10)))return void e.checkError();var o=e.selectNodes("Connector/Errors/Error");for(t=0,n=o.length;t<n;t++)i[o[t].attributes.getNamedItem("name").value]=1;a.skippedFilesDialog(null,o)}else if(e.checkError())return;for(t=0,n=r.length;t<n;t++)i[r[t]]||(r[t].isDeleted=!0,r[t].releaseDomNodes());a.oW("afterCommandExecDefered",{name:"RemoveFiles",folder:l})},l.type,l)}function lt(e){for(var t={},n=e.attributes,i=0;i<n.length;i++)V.aL.File.prototype.tZ[n[i].name]||(t[n[i].name]=n[i].value);return t}function st(e,t){if(e){for(var n=[],i=0;i<e.length;i++)n.push(t(e[i]));return n.join("")}}function dt(e,t,n){return function(e,t){for(var n in e)if(void 0!==t(e[n]))return e[n]}(e,function(e){if(e.tagName&&e.tagName.toLowerCase()==t&&!n--)return e})}function ct(e){return e?new Y(e):null}function ut(e,t){var n=[];if(!t)return e;for(var i in t)n.push(i+"="+encodeURIComponent(t[i]));return e+(-1!=e.indexOf("?")?"&":"?")+n.join("&")}function ft(e){var t=this,n=t.getDialog();return n.getParentApi()._.rb=t,!!n.getContentElement(t.for[0],t.for[1]).getInputElement().$.value&&!!n.getContentElement(t.for[0],t.for[1]).vy()}function pt(a,e,t,n){var r,i,o,l,s;for(var d in n)if("hbox"!=(r=n[d]).type&&"vbox"!=r.type||pt(a,e,t,r.children),r.filebrowser&&"fileButton"==r.type&&r.for){if("string"==typeof r.filebrowser){var c={target:r.filebrowser};r.filebrowser=c}r.filebrowser.action="QuickUpload";var u=r.filebrowser.url;if(u)r.filebrowser.url=u,r.hidden=!1,i=a,o=t.vz(r.for[0]).eB(r.for[1]),l=r.filebrowser,s=void 0,s=l.params||{},l.url&&(s.CKFinderFuncNum=i._.ra,s.langCode||(s.langCode=i.langCode),o.action=ut(l.url,s),o.filebrowser=l);else{var f=r.onShow;r.onShow=function(e){var t=e.jN;if(f&&!1===f.call(t,e))return!1;var n=a.getSelectedFolder();if(n&&(u=n.getUploadUrl()),!u)return!1;var i=r.filebrowser.params||{};i.CKFinderFuncNum=a._.ra,i.langCode||(i.langCode=a.langCode),u=ut(u,i);var o=this.getDialog().getContentElement(r.for[0],r.for[1]);return!!o&&(o._.dg.action=u,o.reset(),!0)}}var p=r.onClick;r.onClick=function(e){var t=e.jN;return(!p||!1!==p.call(t,e))&&ft.call(t,e)}}}function ht(e,t,n){if(-1===n.indexOf(";")){var i=e.vz(t).eB(n).filebrowser;return i&&i.url}for(var o=n.split(";"),a=0;a<o.length;a++)if(ht(e,t,o[a]))return 1}function mt(e,t){var n=this,i=n._.rb.getDialog(),o=n._.rb.for,a=n._.rb.filebrowser.onSelect;o&&i.getContentElement(o[0],o[1]).reset(),"function"==typeof t&&!1===t.call(n._.rb)||a&&!1===a.call(n._.rb,e,t)||("string"==typeof t&&t&&alert(t),e&&function(e,t){var n=t.getDialog(),i=t.filebrowser.target||"";if(i){var o=i.split(":"),a=n.getContentElement(o[0],o[1]);a&&(a.setValue(e),n.selectPage(o[0]))}}(e,n._.rb))}function gt(e){this.jr=null,this.kP=null,this.nK=null,this.app=e}function vt(e){if("submit"==e.name){var t=this.app.ld["formpanel.formpanel"].data();return this.oW("requestUnloadForm"),void this.oW("afterFilesViewSettingsForm",t)}var n=e.data.bK(),a=n.getAttribute("name"),r=n.getAttribute("value"),l=n.$.checked;"input"==n.getName()&&G.setTimeout(function(){var e=this.app.ld["filesview.filesview"],t=e.data(),n={dA:t.dA,cN:t.cN,display:CKFinder.tools.clone(t.display),lookup:t.lookup};if("sortby"==a)t.cN=r;else if("view_type"==a){t.dA=r;var i=this.app.document.getById("fs_display_filename");"list"==r?(t.display.filename=!0,i.$.checked=!0,i.$.disabled=!0):i.$.disabled=!1}else"display_filename"==a?"list"!=t.dA&&(t.display.filename=!!l):"display_date"==a?t.display.date=!!l:"display_filesize"==a&&(t.display.filesize=!!l);var o=("list"==t.dA?"L":"T")+("size"==t.cN?"S":"date"==t.cN?"D":"extension"==t.cN?"E":"N")+(t.display.filename?"N":"_")+(t.display.date?"D":"_")+(t.display.filesize?"S":"_");G.setCookie("CKFinder_Settings",o,!1),n.display.filename==t.display.filename&&n.display.date==t.display.date&&n.display.filesize==t.display.filesize&&n.cN==t.cN&&n.dA==t.dA||e.oW("requestRenderFiles",{mj:e.app.lang.FilesEmpty,lastView:n})},0,this)}function bt(e){e.data.preventDefault()}function yt(e){var t=(e=e.data).db(),n=this.keystrokes[t],i=this._.app;if(!(ge=!0===i.oW("iK",{keyCode:t}))){if(n){ge=!1!==i.execCommand(n,{gJ:"dJ"})}if(!ge){var o=i.oX[t];ge=(ge=o&&!0===o(i))||!!this.gN[t]}}return ge&&e.preventDefault(!0),!ge}function wt(e){ge&&(ge=!1,e.data.preventDefault(!0))}function _t(r){W.opera&&r.setStyle("overflow","hidden"),r.on("touchstart",function(e){var t=e.data.$.touches[0];r.interval&&(window.clearInterval(r.interval),delete r.interval),r.lL=r.$.scrollTop,r.nx=r.$.scrollLeft,r.mP=t.pageY,r.na=t.pageX,r.mO=new Date}),r.on("touchmove",function(e){var t=e.data,n=t.$.touches[0];Ft(r,n.pageX,n.pageY)&&t.preventDefault()}),r.on("touchend",function(e){var t=e.data,n=t.$.changedTouches[0];if(Ft(r,n.pageX,n.pageY)){t.preventDefault();var i=(new Date-r.mO)/100,o=n.pageX-r.na,a=n.pageY-r.mP;r.mK=o/i,r.nu=a/i,r.jy=n.pageX,r.mv=n.pageY,r.nf=0,r.interval=window.setInterval(function(){!function(e){var t=Math.cos(e.nf/7*Math.PI/2);if(e.jy+=e.mK*t,e.mv+=e.nu*t,7<e.nf++||!Ft(e,e.jy,e.mv))window.clearInterval(e.interval),delete e.interval}(r)},100)}})}function Ft(e,t,n){var i=Math.round(t-e.na),o=Math.round(n-e.mP),a=e.nx-i,r=e.lL-o;return(e.$.scrollLeft!=a||e.$.scrollTop!=r)&&(e.$.scrollLeft=a,e.$.scrollTop=r,Math.abs(i)>Math.abs(o)?e.$.scrollLeft==a:e.$.scrollTop==r)}function kt(e,t,n,i){e.execCommand(i?"moveFilesToFolder":"copyFilesToFolder",{files:n,destination:t,fileCallback:function(e,t){for(var n=G.indexOf(e.basketFiles,t),i=1,o=e.basketFiles.length-1,a=n;a<o;a++)e.basketFiles[a]?e.basketFiles[a]=e.basketFiles[a+i]:i++;e.basketFiles.length=Math.max(o,0)}})}function Ct(e){this._||(this._={}),this._.default=this._.hq=e.default||"";for(var t=[this._],n=1;n<arguments.length;n++)t.push(arguments[n]);return t.push(!0),G.extend.apply(G,t),this._}function xt(e){for(var t in e)!Ce.test(t)&&"title"!=t&&"type"!=t||delete e[t];return e}function Et(e,t,n,i,o){for(var a=0,r=0,l=[],s=0;s<e.length;s++)i&&!i(e[s])||(l.push('<a href="',e[s].getUrl(),'" title="',G.escapeHtml(e[s].name),'" rel="',G.escapeHtml(n),'">a</a>'),e[s].isSameFile(t)&&(a=r),r++);return Se="ckf_gallery_"+G.getRandomString(20),Dt(),(Ee=new Y("div",o)).setAttribute("id",Se),Ee.setHtml(l.join("")),Ee.appendTo(o.bH()),Ee.hide(),a}function St(e){if(e&&e.inPopup){var t=new I(e.document),n=t.getWindow();if(!L&&!W.opera||n.$.top.location.href.match(/ckfinder.html/)||"CKFinderpopup"==n.$.top.name)return t}return V.oC}function Nt(e){return function(){e.$.activeElement&&e.$.activeElement.blur(),e.$.activeElement&&e.$.activeElement.blur(),W.gecko||(e.getWindow().focus(),e.bH().focus())}}function Dt(){Ee&&Ee.remove()}function Tt(e){return function(){Dt(),e&&e.focus(!0,!0)}}function Rt(e){if(e.click)e.click();else if(V.document.$.createEvent){var t=V.document.$.createEvent("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}}function $t(e,t,n){L&&W.version<9?e.$.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||setTimeout(function(){t.callee.apply(n,t)},0)}:e.on("load",function(){setTimeout(function(){t.callee.apply(n,t)},0)})}function Wt(e,t){if(!e||!e.inPopup){e&&e.ld["filesview.filesview"].on("afterRenderFiles",Dt);var n=St(t).getWindow().$;void 0!==n.jQuery&&n.jQuery.fn.colorbox?Ne=1:void 0!==n.jQuery&&n.jQuery.fn.fancybox?Ne=2:void 0!==n.jQuery&&n.jQuery.fn.prettyPhoto?Ne=3:void 0!==n.Shadowbox?Ne=4:void 0!==n.Prototype&&void 0!==n.Lightbox&&(Ne=5),Ne&&(De=1)}}function Lt(e){if(!e||e.type!=V.cv||"form"!=e.getName())return[];for(var t=[],n=["style","className"],i=0;i<n.length;i++){var o=n[i],a=e.$.elements.namedItem(o);if(a){var r=new Y(a);t.push([r,r.nextSibling]),r.remove()}}return t}function It(e,t){if(e&&e.type==V.cv&&"form"==e.getName()&&0<t.length)for(var n=t.length-1;0<=n;n--){var i=t[n][0],o=t[n][1];o?i.insertBefore(o):i.appendTo(e)}}function Ot(e,t){var n=Lt(e),i={},o=e.$;return t||(i.class=o.className||"",o.className=""),i.inline=o.style.cssText||"",t||(o.style.cssText="position: static; overflow: visible"),It(n),i}function Ut(e,t){for(var n=0,i=t.length;n<i;n++)if(t[n].name&&t[n].name===e)return 1}function At(){V.dialog.on("resize",function(e){var t=e.data,n=t.width,i=t.height,o=t.dialog,a=o.bO.contents;"kama"==t.skin&&(a.setStyles({width:n+"px",height:i+"px"}),setTimeout(function(){var e=o.bO.dialog.getChild([0,0,0]),t=e.getChild(0),n=e.getChild(2);n.setStyle("width",t.$.offsetWidth+"px"),(n=e.getChild(7)).setStyle("width",t.$.offsetWidth-28+"px"),(n=e.getChild(4)).setStyle("height",t.$.offsetHeight-31-14+"px"),(n=e.getChild(5)).setStyle("height",t.$.offsetHeight-31-14+"px")},100))})}function Pt(){V.dialog.on("resize",function(e){var t=e.data,n=t.width,i=t.height,o=t.dialog,a=o.bO.contents;"v1"==t.skin&&(a.setStyles({width:n+"px",height:i+"px"}),setTimeout(function(){var e=o.bO.dialog.getChild([0,0,0]),t=e.getChild(0),n=e.getChild(2);n.setStyle("width",t.$.offsetWidth+"px"),(n=e.getChild(7)).setStyle("width",t.$.offsetWidth-28+"px"),(n=e.getChild(4)).setStyle("height",t.$.offsetHeight-31-14+"px"),(n=e.getChild(5)).setStyle("height",t.$.offsetHeight-31-14+"px")},100))})}function Bt(e,t,n){var i=e.querySelectorAll(t);if(i)for(var o=0;o<i.length;++o)n.call(i[o])}function Mt(){V.dialog.on("resize",function(e){var t=e.data,n=t.width,i=t.height,o=t.dialog,a=o.bO.contents;"bootstrap"==t.skin&&(a.setStyles({width:n+"px",height:i+"px"}),setTimeout(function(){var e=o.bO.dialog.getChild([0,0,0]),t=e.getChild(0),n=e.getChild(2);n.setStyle("width",t.$.offsetWidth+"px"),(n=e.getChild(7)).setStyle("width",t.$.offsetWidth-28+"px"),(n=e.getChild(4)).setStyle("height",t.$.offsetHeight-31-14+"px"),(n=e.getChild(5)).setStyle("height",t.$.offsetHeight-31-14+"px");var i=o._.element.$;Bt(i,'input[type="text"]',function(){this.classList.add("form-control")}),Bt(i,"a.cke_dialog_ui_button",function(){var e=this.classList;e.add("btn"),e.contains("cke_dialog_ui_button_ok")?e.add("btn-success"):e.contains("cke_dialog_ui_button_cancel")?e.add("btn-danger"):e.add("btn-default")})},100))})}function qt(e,t,n){for(var i=0,o=0,a=0;a<e.$.parentNode.childNodes.length;a++){var r=e.$.parentNode.childNodes[a];if(1==r.nodeType){var l=r==e.$;if(!r.offsetHeight&&!l)continue;o++,l||(i+=r.offsetHeight)}}var s=e.$.offsetHeight-e.$.clientHeight,d=(o-1)*t;!W.ie6Compat||W.ie8||W.ie7Compat||(d+=2*t);var c=(L?e.$.parentNode.parentNode.parentNode.offsetHeight:e.$.parentNode.offsetHeight)-s-i-(d||0);n&&(c+=n);try{e.setStyle("height",c+"px")}catch(e){}}CKFinder.lang.en={appTitle:"CKFinder",common:{unavailable:'%1<span class="cke_accessibility">, unavailable</span>',confirmCancel:"Some of the options were changed. Are you sure you want to close the dialog window?",ok:"OK",cancel:"Cancel",confirmationTitle:"Confirmation",messageTitle:"Information",inputTitle:"Question",undo:"Undo",redo:"Redo",skip:"Skip",skipAll:"Skip all",makeDecision:"What action should be taken?",rememberDecision:"Remember my decision"},dir:"ltr",HelpLang:"en",LangCode:"en",DateTime:"m/d/yyyy h:MM aa",DateAmPm:["AM","PM"],FoldersTitle:"Folders",FolderLoading:"Loading...",FolderNew:"Please type the new folder name: ",FolderRename:"Please type the new folder name: ",FolderDelete:'Are you sure you want to delete the "%1" folder?',FolderRenaming:" (Renaming...)",FolderDeleting:" (Deleting...)",DestinationFolder:"Destination Folder",FileRename:"Please type the new file name: ",FileRenameExt:"Are you sure you want to change the file extension? The file may become unusable.",FileRenaming:"Renaming...",FileDelete:'Are you sure you want to delete the file "%1"?',FilesDelete:"Are you sure you want to delete %1 files?",FilesLoading:"Loading...",FilesEmpty:"The folder is empty.",DestinationFile:"Destination File",SkippedFiles:"List of skipped files:",BasketFolder:"Basket",BasketClear:"Clear Basket",BasketRemove:"Remove from Basket",BasketOpenFolder:"Open Parent Folder",BasketTruncateConfirm:"Do you really want to remove all files from the basket?",BasketRemoveConfirm:'Do you really want to remove the file "%1" from the basket?',BasketRemoveConfirmMultiple:"Do you really want to remove %1 files from the basket?",BasketEmpty:"No files in the basket, drag and drop some.",BasketCopyFilesHere:"Copy Files from Basket",BasketMoveFilesHere:"Move Files from Basket",OperationCompletedSuccess:"Operation completed successfully.",OperationCompletedErrors:"Operation completed with errors.",FileError:"%s: %e",MovedFilesNumber:"Number of files moved: %s.",CopiedFilesNumber:"Number of files copied: %s.",MoveFailedList:"The following files could not be moved:<br />%s",CopyFailedList:"The following files could not be copied:<br />%s",Upload:"Upload",UploadTip:"Upload New File",Refresh:"Refresh",Settings:"Settings",Help:"Help",HelpTip:"Help",Select:"Select",SelectThumbnail:"Select Thumbnail",View:"View",Download:"Download",NewSubFolder:"New Subfolder",Rename:"Rename",Delete:"Delete",DeleteFiles:"Delete Files",CopyDragDrop:"Copy Here",MoveDragDrop:"Move Here",RenameDlgTitle:"Rename",NewNameDlgTitle:"New Name",FileExistsDlgTitle:"File Already Exists",SysErrorDlgTitle:"System Error",FileOverwrite:"Overwrite",FileAutorename:"Auto-rename",ManuallyRename:"Manually rename",OkBtn:"OK",CancelBtn:"Cancel",CloseBtn:"Close",UploadTitle:"Upload New File",UploadSelectLbl:"Select a file to upload",UploadProgressLbl:"(Upload in progress, please wait...)",UploadBtn:"Upload Selected File",UploadBtnCancel:"Cancel",UploadNoFileMsg:"Please select a file from your computer.",UploadNoFolder:"Please select a folder before uploading.",UploadNoPerms:"File upload not allowed.",UploadUnknError:"Error sending the file.",UploadExtIncorrect:"File extension not allowed in this folder.",UploadLabel:"Files to Upload",UploadTotalFiles:"Total Files:",UploadTotalSize:"Total Size:",UploadSend:"Upload",UploadAddFiles:"Add Files",UploadClearFiles:"Clear Files",UploadCancel:"Cancel Upload",UploadRemove:"Remove",UploadRemoveTip:"Remove !f",UploadUploaded:"Uploaded !n%",UploadProcessing:"Processing...",SetTitle:"Settings",SetView:"View:",SetViewThumb:"Thumbnails",SetViewList:"List",SetDisplay:"Display:",SetDisplayName:"File Name",SetDisplayDate:"Date",SetDisplaySize:"File Size",SetSort:"Sorting:",SetSortName:"by File Name",SetSortDate:"by Date",SetSortSize:"by Size",SetSortExtension:"by Extension",FilesCountEmpty:"<Empty Folder>",FilesCountOne:"1 file",FilesCountMany:"%1 files",Kb:"%1 KB",Mb:"%1 MB",Gb:"%1 GB",SizePerSecond:"%1/s",ErrorUnknown:"It was not possible to complete the request. (Error %1)",Errors:{10:"Invalid command.",11:"The resource type was not specified in the request.",12:"The requested resource type is not valid.",102:"Invalid file or folder name.",103:"It was not possible to complete the request due to authorization restrictions.",104:"It was not possible to complete the request due to file system permission restrictions.",105:"Invalid file extension.",109:"Invalid request.",110:"Unknown error.",111:"It was not possible to complete the request due to resulting file size.",115:"A file or folder with the same name already exists.",116:"Folder not found. Please refresh and try again.",117:"File not found. Please refresh the files list and try again.",118:"Source and target paths are equal.",201:'A file with the same name is already available. The uploaded file was renamed to "%1".',202:"Invalid file.",203:"Invalid file. The file size is too big.",204:"The uploaded file is corrupt.",205:"No temporary folder is available for upload in the server.",206:"Upload cancelled due to security reasons. The file contains HTML-like data.",207:'The uploaded file was renamed to "%1".',300:"Moving file(s) failed.",301:"Copying file(s) failed.",500:"The file browser is disabled for security reasons. Please contact your system administrator and check the CKFinder configuration file.",501:"The thumbnails support is disabled."},ErrorMsg:{FileEmpty:"The file name cannot be empty.",FileExists:"File %s already exists.",FolderEmpty:"The folder name cannot be empty.",FolderExists:"Folder %s already exists.",FolderNameExists:"Folder already exists.",FileInvChar:'The file name cannot contain any of the following characters: \n\\ / : * ? " < > |',FolderInvChar:'The folder name cannot contain any of the following characters: \n\\ / : * ? " < > |',PopupBlockView:"It was not possible to open the file in a new window. Please configure your browser and disable all popup blockers for this site.",XmlError:"It was not possible to properly load the XML response from the web server.",XmlEmpty:"It was not possible to load the XML response from the web server. The server returned an empty response.",XmlRawResponse:"Raw response from the server: %s"},Imageresize:{dialogTitle:"Resize %s",sizeTooBig:"Cannot set image height or width to a value bigger than the original size (%size).",resizeSuccess:"Image resized successfully.",thumbnailNew:"Create a new thumbnail",thumbnailSmall:"Small (%s)",thumbnailMedium:"Medium (%s)",thumbnailLarge:"Large (%s)",newSize:"Set a new size",width:"Width",height:"Height",invalidHeight:"Invalid height.",invalidWidth:"Invalid width.",invalidName:"Invalid file name.",newImage:"Create a new image",noExtensionChange:"File extension cannot be changed.",imageSmall:"Source image is too small.",contextMenuName:"Resize",lockRatio:"Lock ratio",resetSize:"Reset size"},Fileeditor:{save:"Save",fileOpenError:"Unable to open file.",fileSaveSuccess:"File saved successfully.",contextMenuName:"Edit",loadingFile:"Loading file, please wait..."},Maximize:{maximize:"Maximize",minimize:"Minimize"},Gallery:{current:"Image {current} of {total}"},Zip:{extractHereLabel:"Extract here",extractToLabel:"Extract to...",downloadZipLabel:"Download as zip",compressZipLabel:"Compress to zip",removeAndExtract:"Remove existing and extract",extractAndOverwrite:"Extract overwriting existing files",extractSuccess:"File extracted successfully."},Search:{searchPlaceholder:"Search"}},V.aL.Acl=function(e){var t=this;e=e||0,t.folderView=1==(1&e),t.folderCreate=2==(2&e),t.folderRename=4==(4&e),t.folderDelete=8==(8&e),t.fileView=16==(16&e),t.fileUpload=32==(32&e),t.fileRename=64==(64&e),t.fileDelete=128==(128&e)},j.add("acl"),function(){j.add("connector",{bM:["csrftokenmanager"],bz:function(c){c.on("appReady",function(){c.connector=new V.aL.Connector(c);var e=c.config.resourceType,t=e?{type:e}:null;c.connector.sendCommand("Init",t,function(d){var e;if(!d.checkError()){var t="Connector/ConnectorInfo/";V.ed=d.selectSingleNode(t+"@s").value,V.bF=d.selectSingleNode(t+"@c").value+"----",c.config.thumbsEnabled="true"==d.selectSingleNode(t+"@thumbsEnabled").value,c.config.thumbsDirectAccess=!1,c.config.thumbsEnabled?((e=d.selectSingleNode(t+"@thumbsUrl"))&&(c.config.thumbsUrl=e.value),(e=d.selectSingleNode(t+"@thumbsDirectAccess"))&&(c.config.thumbsDirectAccess="true"==e.value),e=d.selectSingleNode(t+"@thumbsWidth"),c.config.thumbsWidth=(e?parseInt(e.value,10):100)||100,e=d.selectSingleNode(t+"@thumbsHeight"),c.config.thumbsHeight=(e?parseInt(e.value,10):100)||100):(c.config.thumbsWidth=100,c.config.thumbsHeight=100),c.config.imagesMaxWidth=parseInt(d.selectSingleNode(t+"@imgWidth").value,10),c.config.imagesMaxHeight=parseInt(d.selectSingleNode(t+"@imgHeight").value,10),e=d.selectSingleNode(t+"@uploadMaxSize"),c.config.uploadMaxSize=e?parseInt(e.value,10):0,e=d.selectSingleNode(t+"@uploadCheckImages"),c.config.uploadCheckImages=!!e&&"true"==e.value,e=d.selectSingleNode(t+"@csrfProtection"),c.config.csrfProtection=!!e&&"true"==e.value;var n=d.selectSingleNode(t+"@plugins"),i=n&&n.value;i&&i.length?j.load(i.split(","),function(e){var o=[],a=[],t=[];for(var n in e){var i=e[n],r=i.lang,l=j.getPath(n),s=null;c.plugins[n]||(c.plugins[n]=e[n],e[n].name=n,i.pathName=l,r&&(s=0<=G.indexOf(r,c.langCode)?c.langCode:r[0],i.lang[s]?(G.extend(c.lang,i.lang[s]),s=null):t.push(V.getUrl(l+"lang/"+s+".js"))),a.push(s),o.push(i))}V.scriptLoader.load(t,function(){for(var e=["eK","bz","gr"],t=0;t<e.length;t++)for(var n=0;n<o.length;n++){var i=o[n];0===t&&a[n]&&i.lang&&G.extend(c.lang,i.lang[a[n]]),i[e[t]]&&(V.log("[PLUGIN] "+i.name+"."+e[t]),i[e[t]](c))}c.cr("uiReady"),c.cr("appReady"),c.oW("pluginsLoaded",{step:2,jN:c.connector}),c.cr("connectorInitialized",{xml:d})})}):(c.oW("pluginsLoaded",{step:2,jN:c.connector}),c.cr("connectorInitialized",{xml:d}))}})})}}),V.aL.Connector=function(e){var t=(this.app=e).config.connectorLanguage||"php";e.config.connectorPath?this.oN=e.config.connectorPath:this.oN=V.basePath+"core/connector/"+t+"/connector."+t},V.aL.Connector.prototype={ERROR_NONE:0,ERROR_CUSTOMERROR:1,ERROR_INVALIDCOMMAND:10,ERROR_TYPENOTSPECIFIED:11,ERROR_INVALIDTYPE:12,ERROR_INVALIDNAME:102,ERROR_UNAUTHORIZED:103,ERROR_ACCESSDENIED:104,ERROR_INVALIDEXTENSION:105,ERROR_INVALIDREQUEST:109,ERROR_UNKNOWN:110,ERROR_ALREADYEXIST:115,ERROR_FOLDERNOTFOUND:116,ERROR_FILENOTFOUND:117,ERROR_SOURCE_AND_TARGET_PATH_EQUAL:118,ERROR_UPLOADEDFILERENAMED:201,ERROR_UPLOADEDINVALID:202,ERROR_UPLOADEDTOOBIG:203,ERROR_UPLOADEDCORRUPT:204,ERROR_UPLOADEDNOTMPDIR:205,ERROR_UPLOADEDWRONGHTMLFILE:206,ERROR_UPLOADEDINVALIDNAMERENAMED:207,ERROR_MOVE_FAILED:300,ERROR_COPY_FAILED:301,ERROR_CONNECTORDISABLED:500,ERROR_THUMBNAILSDISABLED:501,currentFolderUrl:function(){if(this.app.aV)return this.app.aV.getUrl()},currentType:function(){if(this.app.aV)return this.app.aV.type},currentTypeHash:function(){if(this.app.aV)return V.getResourceType(this.app.aV.type).hash},currentResourceType:function(){return V.getResourceType(this.currentType())},sendCommand:function(e,t,n,i,o){var a=this.composeUrl(e,t,i,o),r=this;return n?V.ajax.loadXml(a,function(e){e.hy=r.app,r.app.oW("connectorResponse",{xml:e}),n(G.extend(e,s))}):V.ajax.loadXml(a,function(e){r.app.oW("connectorResponse",{xml:e})})},sendCommandPost:function(e,t,n,i,o,a){var r=this.composeUrl(e,t,o,a),l=this;return(n=n||{}).ckCsrfToken=V.getCsrfToken(),n.CKFinderCommand=!0,i?V.ajax.loadXml(r,function(e){e.hy=l.app,l.app.oW("connectorResponse",{xml:e}),i(G.extend(e,s))},this.composeUrlParams(n)):V.ajax.loadXml(r,function(e){l.app.oW("connectorResponse",{xml:e})},this.composeUrlParams(n))},composeUrl:function(e,t,n,i){var o=this,a=o.oN+"?command="+encodeURIComponent(e);if("Init"!=e){var r="";i=i||o.app.aV,r=n?o.app.getResourceType(n).hash:o.app.getResourceType(i.type).hash,a+="&type="+encodeURIComponent(n||o.app.aV.type)+"&currentFolder="+encodeURIComponent(i.getPath()||"")+"&langCode="+o.app.langCode+"&hash="+r}if(t){var l=o.composeUrlParams(t);l&&(a+="&"+l)}return o.app.id&&(a+="&id="+encodeURIComponent(o.app.id)),o.app.config.connectorInfo&&(a+=("&"!=o.app.config.connectorInfo.charAt(0)?"&":"")+o.app.config.connectorInfo),a},composeUrlParams:function(e){if(!e)return"";var t="";for(var n in e)t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]);return t}};var s={checkError:function(){var e=this,t=e.getErrorNumber(),n=e.hy.connector;if(t==n.ERROR_NONE)return!1;if(-1===t)return!0;var i,o=e.getErrorMessage();if(V.log("[ERROR] "+t),t==n.ERROR_CUSTOMERROR)i=o;else if(i=e.hy.lang.Errors[t])for(var a=0;a<=arguments.length;a++){var r=0===a?o:arguments[a-1];i=i.replace(/%(\d+)/,r)}else i=e.hy.lang.ErrorUnknown.replace(/%1/,t);return e.hy.msgDialog("",i),t!=n.ERROR_UPLOADEDFILERENAMED},getErrorNumber:function(){var e=this.selectSingleNode&&this.selectSingleNode("Connector/Error/@number");return e?parseInt(e.value,10):-1},getErrorMessage:function(){var e=this.selectSingleNode&&this.selectSingleNode("Connector/Error/@text");return e?e.value:""}}}(),j.add("resource",{bM:["connector"],bz:function(o){o.resourceTypes=[],o.on("connectorInitialized",function(e){for(var t=e.data.xml.selectNodes("Connector/ResourceTypes/ResourceType"),n=0;n<t.length;n++){var i=t[n].attributes;o.resourceTypes.push(new V.aL.ResourceType(o,{name:i.getNamedItem("name").value,url:i.getNamedItem("url").value,hasChildren:i.getNamedItem("hasChildren").value,allowedExtensions:i.getNamedItem("allowedExtensions").value,deniedExtensions:i.getNamedItem("deniedExtensions").value,acl:i.getNamedItem("acl").value,hash:i.getNamedItem("hash").value,maxSize:i.getNamedItem("maxSize").value}))}o.cr("resourcesReceived",{hK:o.resourceTypes})}),o.getResourceType=function(e){for(var t=0;t<this.resourceTypes.length;t++){var n=this.resourceTypes[t];if(n.name==e)return n}return null}}}),V.aL.ResourceType=function(e,t){var n=this;n.app=e,n.name=t.name,n.url=t.url,n.hasChildren="true"===t.hasChildren,n.defaultView="Thumbnails",n.allowedExtensions=t.allowedExtensions,n.deniedExtensions=t.deniedExtensions,n.oT=Ke(t.allowedExtensions),n.ms=Ke(t.deniedExtensions),n.nS=t.acl,n.hash=t.hash,n.maxSize=t.maxSize},V.aL.ResourceType.prototype={isExtensionAllowed:function(e){return e=e.toLowerCase(),!(0!==this.deniedExtensions.length&&this.ms[e]||0!==this.allowedExtensions.length&&!this.oT[e])},allowedExtensions:function(){return this.allowedExtensions},getRootFolder:function(){for(var e=0;e<this.app.folders.length;e++){var t=this.app.folders[e];if(t.isRoot&&t.type==this.name)return t}}},Ve.prototype.er=function(e,t){var n=this;if(!n.id){n.toolbarId="cke_"+G.getNextNumber(),n.id="cke_"+G.getNextNumber(),n.placeholderId="cke_"+G.getNextNumber();var i={id:n.id,placeholderId:n.placeholderId,lastTimeout:-1,app:e},o=G.addFunction(e.search.doSearch,i),a=G.addFunction(e.search.onFocus,i);t.push('<span class="cke_search_box" id="',n.toolbarId,'" class="cke_toolbar" role="presentation"><span class="cke_toolbar_start"></span>'),t.push('<input id="'+n.id+'" '),t.push(' onkeyup="window.parent.CKFinder._.callFunction(',o,', this);"'),t.push(' oninput="window.parent.CKFinder._.callFunction(',o,', this);"'),t.push(' onfocus="window.parent.CKFinder._.callFunction(',a,', this);"'),t.push(">"),t.push('<span id="'+n.placeholderId+'" class="cke_search_placeholder" onclick="window.parent.CKFinder._.callFunction(',a,', this);">'+e.lang.Search.searchPlaceholder+"</span>"),t.push('<span class="cke_toolbar_end"></span></span>')}},Ve.prototype.doSearch=function(){var e=this.app.ld["filesview.filesview"].oE().shownFiles.length,t=this.app.document.getById(this.id).getValue(),n=this.app;this.lastTimeout&&(clearTimeout(this.lastTimeout),this.lastTimeout=null),e<200?n.ld["filesview.filesview"].oW("requestRenderFiles",{lookup:t}):this.lastTimeout=setTimeout(function(){n.ld["filesview.filesview"].oW("requestRenderFiles",{lookup:t})},1e3)},Ve.prototype.onFocus=function(){this.app.document.getById(this.placeholderId).setStyle("display","none"),this.app.document.getById(this.id).$.focus()},Ve.prototype.reset=function(){this.app.document.getById(this.id).setValue(""),this.app.document.getById(this.placeholderId).setStyle("display","inline")},j.add("search",{bM:["foldertree"],eK:function(e){e.search=new Ve(e)},bz:function(e){e.on("appReady",function(){e.ld["foldertree.foldertree"].on("beforeSelectFolder",function(){e.search.reset()}),e.ld["formpanel.formpanel"].on("afterUploadFile",function(){e.search.reset()})})}}),ae={iz:/[\\\/:\*\?"<>\|]/},j.add("folder",{bM:["resource","connector","acl"],bz:function(s){s.folders=Ye(s),s.aV=null,s.on("resourcesReceived",function(e){for(var t=[],n=e.data.hK,i=0;i<n.length;i++){var o=n[i];t.push(new V.aL.Folder(s,o.name,o.name,o.hasChildren,o.nS)),t[t.length-1].isRoot=!0}s.oW("requestAddFolder",{folders:t},function(){var e=s.config.startupPath||"",n=0,t="",i="";if(s.config.rememberLastFolder){var o=s.id?"CKFinder_Path_"+s.id:"CKFinder_Path";t=decodeURIComponent(G.getCookie(o))||""}if(e&&!s.qn?(i=e,n=1):t?i=t:e?i=e:s.resourceTypes.length&&(i=s.resourceTypes[0].name+"/"),i){V.log("[FOLDER] Opening startup path: "+i);var a=i.split(":");(!s.getResourceType(a[0])||a.length<2)&&(a=[s.resourceTypes[0].name,"/"]);var r=s.ld["foldertree.foldertree"],l=/(.*\/)(.*)$/.exec(a[1]);r.tools.jL(a[0],l[1],function(e){if(e){V.log("[FOLDER] Opening startup folder: ",e);var t=!n&&("1"==a[2]||void 0===a[2]);t&&!1===s.config.startupFolderExpanded&&(t=0),r.oW("requestSelectFolder",{folder:e,expand:t,file:l[2]&&e.type==a[0]&&e.getPath()==l[1]?l[2]:""})}})}})}),s.bD("RemoveFolder",{readOnly:!1,exec:function(e){var t=e.aV;if(t){if(t.isRoot||!t.acl.folderDelete)return;e.fe("",e.lang.FolderDelete.replace("%1",G.escapeHtml(t.name)),function(){e.oW("requestProcessingFolder",{folder:t}),t.remove()})}}}),s.bD("CreateSubFolder",{readOnly:!1,exec:function(t){var n=t.aV;n&&t.hs(t.lang.NewNameDlgTitle,t.lang.FolderRename,"",function(e){if(e=G.trim(e))try{t.oW("requestProcessingFolder",{folder:n}),n.createNewFolder(e)}catch(e){if(!(e instanceof V.dU))throw e;t.oW("requestRepaintFolder",{folder:n}),t.msgDialog("",e.message)}})}}),s.bD("RenameFolder",{readOnly:!1,exec:function(t){var n=t.aV;if(n){if(n.isRoot||!n.acl.folderRename)return;t.hs(t.lang.RenameDlgTitle,t.lang.FolderRename,t.aV.name,function(e){if(e=G.trim(e))try{n.rename(e)}catch(e){if(!(e instanceof V.dU))throw e;t.oW("requestRepaintFolder",{folder:n}),t.msgDialog("",e.message)}})}}}),s.eU&&(s.dZ("folder0",99),s.dZ("folder1",100),s.dZ("folder2",101),s.dZ("folder3",102),s.eU({createSubFolder:{label:s.lang.NewSubFolder,command:"CreateSubFolder",group:"folder1"},renameFolder:{label:s.lang.Rename,command:"RenameFolder",group:"folder1"},removeFolder:{label:s.lang.Delete,command:"RemoveFolder",group:"folder2"}}))}}),V.aL.Folder=function(e,t,n,i,o){var a=this;a.app=e,a.type=t||"",a.name=n||"",a.hasChildren=null==i||null===i||!!i,a.isRoot=!1,a.isOpened=!1,a.parent=null,a.isDirty=!1,a.acl=new V.aL.Acl(o),a.index=Ye(e).push(a)-1,a.childFolders=null},V.aL.Folder.prototype={getPath:function(){for(var e=this,t=e.isRoot?"/":e.name;e.parent;)t=(e=e.parent).isRoot?"/"+t:e.name+"/"+t;return e!=this?t+"/":t},getUrl:function(){for(var e=this,t="";e;)t=e.isRoot?this.app.getResourceType(e.type).url+t:encodeURIComponent(e.name)+"/"+t,e=e.parent;return t},getUploadUrl:function(){return this.app.connector.composeUrl("FileUpload",{},this.type,this)},getResourceType:function(){return this.app.getResourceType(this.type)},updateReference:function(){var e=this;if(e.app.folders[e.index]==e)return e;for(var t=0;t<e.parent.childFolders.length;t++)if(e.parent.childFolders[t].name==e.name)return e.parent.childFolders[t]},getChildren:function(s,e){var d=this,t=d.childFolders;if(!d.hl||e){if(t&&!d.isDirty&&!e)return s(t),t;if(d.hl=!0,d.isDirty&&t){V.log("[FOLDER] Clearing folder children cache.");for(var n=0;n<t.length;n++)delete d.app.folders[t[n].index]}return d.app.oW("requestLoadingFolder",{folder:d}),this.app.connector.sendCommand("GetFolders",null,function(e){if(e.checkError())d.app.oW("requestRepaintFolder",{folder:d});else{var t=e.selectSingleNode("Connector/@resourceType").value;d.hm=!0;var n=e.selectNodes("Connector/Folders/Folder"),i=[];d.childFolders=null;for(var o=0;o<n.length;o++){var a=n[o].attributes.getNamedItem("name").value,r="true"==n[o].attributes.getNamedItem("hasChildren").value,l=parseInt(n[o].attributes.getNamedItem("acl").value,10);i.push(Ge(d,t,a,r,l))}d.hasChildren=!!n.length,d.isDirty=!1,d.hl=null,d.app.oW("requestRepaintFolder",{folder:d}),s(i)}},d.type,d),null}V.log("[FOLDER] getChildrenLock active, defering callback..."),d.app.oW("requestLoadingFolder",{folder:d});var i=100;setTimeout(function(){d.hl?i<=3e3?setTimeout(arguments.callee,i*=2):(V.log("[FOLDER] TIMEOUT for getChildrenLock defered callback!"),d.hl=!1,d.getChildren(s)):s(t)})},mapLoadedDescendants:function(e){if(this.childFolders)for(var t=0;t<this.childFolders.length;t++){var n=this.childFolders[t];n.mapLoadedDescendants(e),e(n)}},select:function(){this.app.oW("requestSelectFolder",{folder:this})},isSelected:function(){return this.app.aV&&this==this.app.aV},deselect:function(){this.app.oW("requestSelectFolder")},open:function(e){e&&!this.hm||this.app.oW("requestExpandFolder",{folder:this})},close:function(){this.app.oW("requestExpandFolder",{folder:this,collapse:1})},hU:function(){for(var e=1,t=this;t;)e++,t=t.parent;return e},toggle:function(){this.hasChildren&&(this.isOpened?this.close():this.open())},createNewFolder:function(t){Xe(t,this.app);var n=this;n.isDirty=!0,n.app.connector.sendCommandPost("CreateFolder",{NewFolderName:t},null,function(e){e.checkError()?n.app.oW("requestRepaintFolder",{folder:n}):(n.hasChildren=!0,n.app.oW("afterCommandExecDefered",{name:"CreateFolder",ip:n,uv:t}))},this.type,this)},rename:function(e){Xe(e,this.app);var t=this;this.app.oW("requestProcessingFolder",{folder:t}),t.parent.isDirty=!0,t.name!=e?t.app.connector.sendCommandPost("RenameFolder",{NewFolderName:e},null,function(e){e.checkError()||(t.parent.isDirty=!1,t.name=e.selectSingleNode("Connector/RenamedFolder/@newName").value),t.app.oW("requestRepaintFolder",{folder:t})},this.type,this):t.app.oW("requestRepaintFolder",{folder:t})},remove:function(){var o=this;o.deselect(),o.parent.isDirty=!0,this.app.oW("requestProcessingFolder",{folder:o}),o.app.connector.sendCommandPost("DeleteFolder",null,null,function(e){e.checkError()?o.app.oW("requestRepaintFolder",{folder:o}):o.app.oW("requestRemoveFolder",{folder:o},function(){var e=G.indexOf(o.parent.childFolders,o),t=o.index,n=o.parent,i=o.app;n.childFolders[e].mapLoadedDescendants(function(e){i.folders[e.index].isDeleted=!0,delete i.folders[e.index]}),n.childFolders.splice(e,1),i.folders[t].isDeleted=!0,delete i.folders[t],0===n.childFolders.length&&(n.childFolders=null,n.hasChildren=!1),o.releaseDomNodes&&o.releaseDomNodes(),i.oW("afterCommandExecDefered",{name:"RemoveFolder",ip:n,uN:t,folder:o})})},this.type,this)},toString:function(){return this.getPath()}},re='<a href="javascript:void(0)" class="dropdown">▼</a>',j.add("foldertree",{bM:["folder"],onLoad:function(){function t(e){this.ib=e,this.bi=e.tools.kI().cf()}var e;(e=V.ld.hS("foldertree","foldertree")).dT.push(function(){var e=this.bn();e.hasClass("view")||(e=e.getParent()),G.mH(e)}),e.bh("KeyboardNavigation",["keydown","requestKeyboardNavigation"],function(r){var l=this,s=this.tools.cq(r),d=0;if(r.data&&r.data.bK){var e=r.data.bK();d=e.$==l.bn().$}if(s||d){var t=G.extend({},r.data,{folder:s},!0);this.oW("beforeKeyboardNavigation",t,function(e,t){if(!e)try{var n=r.data.db();if(d&&37<=n&&n<=40){var i=l.app.folders[0];i&&this.tools.cT(i)}else{var o;if(38==n)if(r.data.preventDefault(),(o=s.liNode()).gE()){for(var a=this.tools.cq(o.cf());a.isOpened&&a.hasChildren&&a.childFolders.length;)a=a.childFolders[a.childFolders.length-1];this.tools.cT(a)}else s.isRoot||this.tools.cT(s.parent);else 39==n&&s.hasChildren?s.isOpened?s.getChildren(function(e){l.tools.cT(e[0])}):this.oW("requestExpandFolder",{folder:s}):40==n?(r.data.preventDefault(),o=s.liNode(),s.isOpened&&s.hasChildren?s.getChildren(function(e){l.tools.cT(e[0])}):o.ge()?this.tools.cT(this.tools.cq(o.dG())):!s.isRoot&&s.parent&&function(e){var t=e.liNode();t.ge()?l.tools.cT(l.tools.cq(t.dG())):e.parent&&arguments.callee(e.parent)}(s.parent)):37==n?s.isOpened?this.oW("requestExpandFolder",{folder:s,collapse:1}):!s.isRoot&&s.parent&&this.tools.cT(s.parent):46==n?(l.app.oW("requestSelectFolder",{folder:s}),l.app.execCommand("RemoveFolder")):113==n&&(l.app.oW("requestSelectFolder",{folder:s}),l.app.execCommand("RenameFolder"))}this.oW("successKeyboardNavigation",t),this.oW("afterKeyboardNavigation",t)}catch(e){throw e=V.ba(e),this.oW("failedKeyboardNavigation",t),this.oW("afterKeyboardNavigation",t),e}})}}),e.dT.push(function(o,a){o.on("afterCommandExecDefered",function(e){if(e.data){var t=e.data.folder;if("RemoveFolder"==e.data.name){t==a.tools.ew&&(a.tools.cT(),a.bn().focus());var n=o.ld["filesview.filesview"].tools.folder,i=t==n;t.mapLoadedDescendants(function(e){n==t&&(i=!0)}),a.oW("requestSelectFolder",{folder:t.parent,expand:i})}else"RenameFolder"==e.data.name&&t==a.tools.ew&&t.focus()}})}),e.bh("RemoveFolder","requestRemoveFolder",function(e){var n=this.tools.cq(e),t=G.extend({},e.data,{folder:n},!0);this.oW("beforeRemoveFolder",t,function(e,t){if(!e)try{n.liNode().remove(),this.oW("successRemoveFolder",t),this.oW("afterRemoveFolder",t)}catch(e){throw this.oW("failedRemoveFolder",t),this.oW("afterRemoveFolder",t),V.ba(e)}})},!1),e.bh("LoadingFolder","requestLoadingFolder",function(e){var o=this,t=this.tools.cq(e);if(t){var n=G.extend({},e.data,{folder:t},!0);this.oW("beforeLoadingFolder",n,function(e,n){if(!e){var i=n.folder;try{this.on("afterExpandFolder",function(e){if(e.data&&e.data.folder==i){e.removeListener();var t=i.childrenRootNode().getChild(0);t&&t.hasClass("loading")&&(t.remove(),this.oW("requestRepaintFolder",{folder:i}),n.step=2,o.oW("successLoadingFolder",n),o.oW("afterLoadingFolder",n))}},null,null,1),i.childrenRootNode()&&i.childrenRootNode().setHtml('<li class="loading">'+o.app.lang.FolderLoading+"</li>"),this.oW("requestProcessingFolder",{folder:i}),n.step=1,this.oW("successLoadingFolder",n)}catch(e){throw this.oW("failedLoadingFolder",n),this.oW("afterLoadingFolder",n),V.ba(e)}}})}}),e.bh("ProcessingFolder",["requestProcessingFolder"],function(e){e.result=this.oW("beforeProcessingFolder",e.data,function(e,t){var n=this;if(!e)try{n.tools.cq(t.folder).aNode().addClass("processing"),n.oW("successProcessingFolder",t),n.oW("afterProcessingFolder",t)}catch(e){throw e=V.ba(e),n.oW("failedProcessingFolder",t),n.oW("afterProcessingFolder",t),e}})}),e.bh("RepaintFolder",["requestRepaintFolder"],function(e){this.oW("beforeRepaintFolder",e.data,function(e,t){var n=this;if(!e)try{var i=n.tools.cq(t.folder),o=i.liNode(),a=i.expanderNode(),r=i.aNode(),l=i.childrenRootNode(),s=i.name;r.getHtml()!=s&&r.setHtml(G.htmlEncode(i.name)),r.removeClass("processing"),i.hasChildren?i.hasChildren&&(l.$.hasChildNodes()?(o.addClass("closable"),o.removeClass("openable"),a.setAttribute("aria-expanded","true")):(o.addClass("openable"),o.removeClass("closable"),a.removeAttribute("aria-expanded"))):(o.removeClass("openable"),o.removeClass("closable"),o.addClass("nochildren"),a.removeAttribute("aria-expanded"),l.$.hasChildNodes()&&l.setHtml("")),n.oW("successRepaintFolder"),n.oW("afterRepaintFolder")}catch(e){throw n.oW("failedRepaintFolder"),n.oW("afterRepaintFolder"),V.ba(e)}})}),e.dT.push(function(e,t){e.on("afterCommandExecDefered",function(e){e.data&&"RemoveFolder"==e.data.name&&t.oW("requestRepaintFolder",{folder:e.data.ip})})}),e.bh("AddFolder","requestAddFolder",function(e){var d=this,t={folders:e.data.folder?[e.data.folder]:e.data.folders,root:e.data.root};this.oW("beforeAddFolder",t,function(e,t){if(!e){var n,i,o=t.folders,a=t.root?this.tools.cq(t.root):null;try{if(a)!1===a.hasChildren?a.liNode().addClass("nochildren"):(a.liNode().removeClass("nochildren"),n=Qe(o,Ze),a.childrenRootNode().appendHtml(n));else{for(var r={},l=0;l<o.length;l++)r[i=o[l].parent?o[l].parent.index:-1]||(r[i]=[]),r[i].push(o[l]);for(var s in r)n=Qe(r[s],Ze),-1==s?this.tools.kI().appendHtml(n):((i=this.tools.cq(s)).liNode().removeClass("nochildren"),i.childrenRootNode().appendHtml(n));(1==V.bs.indexOf(V.bF.substr(1,1))%5&&V.lS(window.top[V.nd+"cation"][V.jG+"st"])!=V.lS(V.ed)||V.bF.substr(3,1)!=V.bs.substr(9*(V.bs.indexOf(V.bF.substr(0,1))+V.bs.indexOf(V.bF.substr(2,1)))%(V.bs.length-1),1))&&setTimeout(function(){d.app.layout.ea()},100)}this.oW("successAddFolder"),this.oW("afterAddFolder")}catch(e){throw this.oW("failedAddFolder"),this.oW("afterAddFolder"),V.ba(e)}}})}),e.bh("SelectFolder",["click","requestSelectFolder","requestSelectFolderRefresh"],function(e){var o=this,a="click"==e.name,t=a&&e.data.bK();if(!this.tools.kg(e)){var i=this.tools.cq(e);if(a&&t.hasClass("dropdown"))return e.jN.oW("contextmenu",e.data),void e.cancel();if(a||"requestSelectFolder"==e.name){if(a&&!i)return;if(a&&i.aNode()&&i.aNode().$!=t.$)return;var n=G.extend({jR:1,expand:0},e.data,{folder:i},!0);this.oW("beforeSelectFolder",n,function(e,t){if(!e){var n=t.folder;try{if(this.app.aV&&(!n||n!=this.app.aV)){var i=this.app.aV.liNode();i&&i.removeClass("selected"),o.tools.hk().mc(),this.app.aV=null}return n?(a&&this.tools.cT(n),t.expand&&o.oW("requestExpandFolder",{folder:n}),n.liNode().addClass("selected"),this.app.aV=n,o.tools.hk().select(n.aNode()),t.jR&&(o.oW("requestProcessingFolder",{folder:n}),o.tools.mV(n,1),o.app.oW("requestShowFolderFiles",{folder:n,mw:t.file},function(e,t){t.ib&&t.ib.on("afterShowFolderFiles",function(e){e.data.folder==n&&(e.removeListener(),o.oW("requestRepaintFolder",{folder:n}))})})),this.oW("successSelectFolder"),this.oW("afterSelectFolder"),n):(this.oW("successSelectFolder"),void this.oW("afterSelectFolder"))}catch(e){throw this.oW("failedSelectFolder"),this.oW("afterSelectFolder"),V.ba(e)}}})}else"requestSelectFolderRefresh"==e.name&&this.oW("beforeSelectFolderRefresh",function(e){var t=this;if(!e)try{if(t.app.aV){var n=t.app.aV.aNode();n?t.tools.hk().select(n):(t.tools.hk().mc(),t.oW("failedSelectFolderRefresh"))}else t.oW("successSelectFolderRefresh");return t.oW("afterSelectFolderRefresh"),i}catch(e){throw t.oW("failedSelectFolderRefresh"),t.oW("afterSelectFolderRefresh"),V.ba(e)}})}}),e.dT.push(function(e,t){t.on("afterExpandFolder",function(){t.oW("requestSelectFolderRefresh")},null,null,999),t.on("successRemoveFolder",function(){t.oW("requestSelectFolderRefresh")}),t.on("successLoadingFolder",function(e){1==e.data.step&&t.oW("requestSelectFolderRefresh")})}),e.bh("ExpandFolder",["click","requestExpandFolder"],function(e){var d=this,t="click"==e.name,n=t&&e.data.bK();if(!this.tools.kg(e)&&(!t||n.hasClass("expander"))){var i=this.tools.cq(e),o=G.extend({collapse:0},e.data,{folder:i,hE:t},!0);this.oW("beforeExpandFolder",o,function(e,t){if(!e)try{var n=t.folder,i=n.liNode(),o=n.expanderNode();if(!n.acl.folderView)throw d.app.msgDialog("",d.app.lang.Errors[104]),"[CKFINDER] No permissions to view folder.";if(n.hasChildren){var a=t.hE&&i.hasClass("openable"),r=!t.hE&&!t.collapse&&!i.hasClass("closable"),l=!t.hE&&!t.collapse&&i.hasClass("closable"),s=!t.collapse&&t.force;a||r||s?(i.removeClass("openable"),i.addClass("closable"),o.setAttribute("aria-expanded","true"),n.getChildren(function(e){e?(d.oW("requestAddFolder",{folders:e,root:n}),n.isOpened=!0):(d.oW("requestRepaintFolder",{folder:n}),n.isOpened=!1),t.step=2,d.oW("successExpandFolder",t),d.oW("afterExpandFolder",t)}),t.step=1,d.oW("successExpandFolder",t)):t.hE||!t.hE&&t.collapse?(i.removeClass("closable"),i.addClass("openable"),o.setAttribute("aria-expanded","false"),n.childrenRootNode().setHtml(""),n.isOpened=!1,n.hm?n.getChildren(function(e){n.mapLoadedDescendants(function(e){e.releaseDomNodes()}),d.oW("successExpandFolder",t),d.oW("afterExpandFolder",t)}):(this.oW("requestRepaintFolder",{folder:n}),this.oW("failedExpandFolder"),this.oW("afterExpandFolder"))):l&&(d.oW("successExpandFolder",t),d.oW("afterExpandFolder",t))}else this.oW("failedExpandFolder"),this.oW("afterExpandFolder");return n}catch(e){throw this.oW("failedExpandFolder"),this.oW("afterExpandFolder"),V.ba(e)}})}}),e.dT.push(function(e,t){e.on("afterCommandExecDefered",function(e){e.data&&"CreateFolder"==e.data.name&&t.oW("requestExpandFolder",{folder:e.data.ip,force:1})})}),e.tools.jL=function(e,t,a){var r=this.ib,n=this.ib.app.getResourceType(e).getRootFolder(),l=n,s="/"==t?[]:t.split("/").slice(1);""===s[s.length-1]&&(s=s.slice(0,-1)),0!==s.length?(r.on("successExpandFolder",function(e){if(2==e.data.step){var t=e.data.folder;if(t==l)for(var n=s.shift(),i=0;i<t.childFolders.length;i++){var o=t.childFolders[i];if(o.name==n){if(0===s.length)return e.removeListener(),void a(o);l=o,r.oW("requestExpandFolder",{folder:o})}}}}),r.oW("requestExpandFolder",{folder:n})):a(n)},e.tools.cq=function(e){var t,n=0;if(e.data&&e.data.folder instanceof Y?(e=e.data.folder,n=1):e.data&&e.data.bK?(e=e.data.bK(),n=1):e instanceof w.bi&&(n=1),n){for(var i=e;i&&!i.is("li")&&i!=this.ib.eh;)i=i.getParent();if(i&&i.is("li")){var o=i.dS();o&&(t=this.ib.app.folders[o.slice(1)])}}else"number"==typeof e?t=this.ib.app.folders[e]:"string"==typeof e?t=this.ib.app.folders[i.dS().slice(1)]:e.data&&e.data.folder instanceof V.aL.Folder?t=e.data.folder:e.data&&e.data.folders&&e.data.folders.length&&e.data.folders[0]instanceof V.aL.Folder?t=e.data.folders[0]:e instanceof V.aL.Folder&&(t=e);return t},e.tools.mV=function(e,t){var n=e.type,i=e.getPath(),o=this.ib.app.id;t=void 0===t?e.isOpened:1+!!t-1,G.setCookie(o?"CKFinder_Path_"+o:"CKFinder_Path",encodeURIComponent(n+":"+i+":"+t))},t.prototype={select:function(e){this.bi.setStyles({height:e.$.offsetHeight+"px",top:e.$.offsetTop+"px",display:"block"})},mc:function(e){this.bi.setStyles({display:"none"})},ie6FixParentNode:function(){return this.kv||(this.kv=this.ib.app.document.getById("folders_view").getChild(1)),this.kv}},e.tools.hk=function(){var e=this.ib.oE();return e.la||(e.la=new t(this.ib)),e.la},e.tools.kI=function(){return this.kW||(this.kW=et(Je(this.ib.bn().getChild(1).$.childNodes,"ul"))),this.kW},e.tools.cT=function(e){var t=this;e?(t.ew?t.ew.blur():t.ib.bn().setAttribute("tabindex",-1),(t.ew=e).focus()):(delete t.ew,t.ib.bn().setAttribute("tabindex",0))},G.extend(V.aL.Folder.prototype,{liNode:function(){var e=this;if(void 0===e.iC){var t=e.app.document.getById("f"+e.index);t&&(e.iC=t)}return e.iC},aNode:function(){if(void 0===this.dM){var e=this.liNode();e&&(this.dM=et(Je(e.$.childNodes,"a")))}return this.dM},expanderNode:function(){if(void 0===this.iR){var e=this.liNode();e&&(this.iR=et(Je(e.$.childNodes,"span")))}return this.iR},childrenRootNode:function(){if(void 0===this.iM){var e=this.liNode();e&&(this.iM=et(Je(e.$.childNodes,"ul")))}return this.iM},releaseDomNodes:function(){delete this.iC,delete this.dM,delete this.iR,delete this.iM},focus:function(){var e=this.aNode();e&&(e.setAttribute("tabindex",0),e.focus())},blur:function(){this.aNode()&&this.aNode().setAttribute("tabindex",-1)}})},bz:function(s){var t=this;s.on("themeSpace",function(e){"sidebar"==e.data.space&&(e.data.html+="<div id='folders_view' class='view widget' tabindex='0'><h2 id='folders_view_label'>"+s.lang.FoldersTitle+"</h2><div class='folder_tree_wrapper wrapper'><div class='selection'></div><ul class='folder_tree no_list' role='tree navigation' aria-labelledby='folders_view_label'></ul></div></div>")}),s.on("uiReady",function(){s.config.showContextMenuArrow||(re="");var e=s.document.getById("folders_view");e.hX(),W.opera&&e.on("dblclick",function(e){e.data.preventDefault()});var l=V.ld.bz(s,"foldertree",t,e);s.bj&&(s.bj.lX(e),s.bj.kh(function(e){if("folders_view"!=e.dS()){var t=!0;if(s.aV){var n=s.aV.liNode().dS();e.dS()!==n&&e.getParent().dS()!==n||(t=!1)}t&&(s.oW("requestSelectFolder",{folder:null}),s.oW("requestSelectFolder",{folder:e}));var i=s.aV;if(i&&!s.config.readOnly){var o=i.acl,a=i.isRoot,r={createSubFolder:o.folderCreate?V.aS:V.aY,renameFolder:!a&&o.folderRename?V.aS:V.aY,removeFolder:!a&&o.folderDelete?V.aS:V.aY};return l.oW("beforeContextMenu",{bj:r,folder:i}),r}}},e))}),s.bD("foldertreeFocus",{exec:function(e){var t=e.layout.pS(),n=e.ld["foldertree.foldertree"].tools.ew;t.focus(),n&&n.focus()}})}}),de={fX:/[^\.]+$/,iz:/[\\\/:\*\?"<>\|]/},ce='<span class="dropdown">▼</span>',ue='<a href="javascript:void(0)" class="dropdown">▼</a>',fe=["<table class='files_details' role='region' aria-controls='status_view'>","<tbody>","</tbody>","</table>"],pe=["Node","message"],j.add("filesview",{bM:["foldertree"],onLoad:function(){G.extend(V.aL.Folder.prototype,{getFiles:function(a){var r=this,l=this.app;l.connector.sendCommand("GetFiles",{},function(e){for(var t=[],n=e.selectNodes("Connector/Files/File"),i=0;i<n.length;i++){var o=n[i].attributes.getNamedItem("date").value;t.push(new V.aL.File(n[i].attributes.getNamedItem("name").value,parseInt(n[i].attributes.getNamedItem("size").value,10),!!n[i].attributes.getNamedItem("thumb")&&n[i].attributes.getNamedItem("thumb").value,o,l.lB(o.substr(6,2),o.substr(4,2),o.substr(0,4),o.substr(8,2),o.substr(10,2)),r,lt(n[i])))}a&&a.call(r,t)},r.type,r)},showFiles:function(e){this.app.oW("requestShowFolderFiles",{folder:this,mw:e})}}),function(){var e=V.ld.hS("filesview","filesview",{dA:"thumbnails",display:{filename:1,date:1,filesize:1},cN:"filename",files:[],hA:null,pq:0,shownFiles:[]}),t="Please visit the <a href='http://cksource.com/ckfinder' target='_blank'>CKFinder web site</a> to obtain a valid license.",g="This is the DEMO version of CKFinder. "+t;function v(){var e=this,t=G.getCookie("CKFinder_Settings");if(!t||5!=t.length)return e.app.config.defaultViewType&&(e.data().dA=e.app.config.defaultViewType),e.app.config.defaultSortBy&&(e.data().cN=e.app.config.defaultSortBy),void 0!==e.app.config.defaultDisplayFilename&&(e.data().display.filename=e.app.config.defaultDisplayFilename),void 0!==e.app.config.defaultDisplayDate&&(e.data().display.date=e.app.config.defaultDisplayDate),void(void 0!==e.app.config.defaultDisplayFilesize&&(e.data().display.filesize=e.app.config.defaultDisplayFilesize));switch(e.data().dA="L"==t.substr(0,1)?"list":"thumbnails",e._.nV=!0,t.substr(1,1)){case"D":e.data().cN="date";break;case"S":e.data().cN="size";break;case"E":e.data().cN="extension";break;default:e.data().cN="filename"}e.data().display.filename="N"==t.substr(2,1),e.data().display.date="D"==t.substr(3,1),e.data().display.filesize="S"==t.substr(4,1)}e.qX=function(){return g},e.dT.push(v),e.dT.push(function(){G.mH(this.bn())}),e.bh("SelectAction",["dblclick","click","requestSelectAction","requestSelectThumbnailAction"],function(e){var g=this,v=this.tools.bZ(e),t=e.data.$&&(e.data.$.ctrlKey||e.data.$.metaKey);if(v){if("dblclick"==e.name&&t){var n=this.data().nY;n&&n[n.length-1]===v||(n.push(v),v.rowNode().hasClass("selected")||this.tools.cR(v,!0)),2<=n.length&&n[n.length-1]===n[n.length-2]&&n.splice(n.length-1,1)}if(!L||9<=W.version){var i=g.data();if("click"==e.name)return i.nQ||(i.nQ=[null,null]),i.nQ[1]=i.nQ[0],void(i.nQ[0]=v.name);if("dblclick"==e.name&&i.nQ&&i.nQ[1]!=v.name)return}else if("click"==e.name)return;var o=G.extend({},e.data,{file:v,jw:"requestSelectThumbnailAction"==e.name},!0);g.oW("beforeSelectAction",o,function(e,t){if(!e)try{var n,i=!0,o=v.getUrl(),a=v.getThumbnailUrl(),r=[];if(t.jw?!(n=g.app.config.selectThumbnailActionFunction)&&g.app.config.thumbsDirectAccess&&(n=g.app.config.selectActionFunction):n=g.app.config.selectActionFunction,n){var l=t.jw?a:o,s={fileUrl:o,fileSize:v.size,fileDate:v.date,custom:v.custom};t.jw?(s.thumbnailUrl=a,g.app.config.selectThumbnailActionFunction?s.selectThumbnailActionData=g.app.config.selectThumbnailActionData:s.selectActionData=g.app.config.selectActionData):s.selectActionData=g.app.config.selectActionData;for(var d,c,u=g.tools.oO(),f=0,p=u.length;f<p;f++)d=u[f].getUrl(),r[f]={url:t.jw&&u[f].isImage()?u[f].getThumbnailUrl():u[f].getUrl(),data:G.extend({fileUrl:d,fileSize:u[f].size,fileDate:u[f].date,custom:u[f].custom},s.selectThumbnailActionData?{selectThumbnailActionData:s.selectThumbnailActionData}:{selectActionData:s.selectActionData})};switch(g.app.config.selectActionType){case"fckeditor":c=n(l);break;case"ckeditor":c=n(l,s);break;case"js":c=n.call(g.app.cg,l,s,r)}i=!1!==c}else g.app.execCommand("ViewFile");var h=g.app.document.getWindow();if(i&&g.app.cg.inPopup&&(!L&&!W.opera||h.$.top.location.href.match(/ckfinder.html/)||"CKFinderpopup"==h.$.top.name)){var m=h.$.top.opener;h.$.top.close(),m&&m.focus()}g.oW("successSelectAction",t),g.oW("afterSelectAction",t)}catch(e){throw e=V.ba(e),g.oW("failedSelectAction",t),g.oW("afterSelectAction",t),e}})}}),e.bh("KeyboardNavigation",["keydown","requestKeyboardNavigation"],function(d){var c=this,u=0;if(d.data&&d.data.bK){var e=d.data.bK();u=e.$==c.bn().$}var f=this.tools.bZ(d);if(f||u){var t=G.extend({},d.data,{file:f},!0);this.oW("beforeKeyboardNavigation",t,function(e,t){var n=this;if(!e)try{var i,o,a,r=d.data.db();if(r>V.dy&&n.app.config.selectMultiple)r-=V.dy,a=1;else if(r==V.bP+65&&n.app.config.selectMultiple){c.tools.dH()&&c.tools.dH().deselect();for(var l=c.data().shownFiles,s=0;s<l.length;s++)if(!l[s].isDeleted){i=l[s].rowNode();break}for(;c.tools.bZ(i).select(!0),(i=i.dG())&&i.ge(););c.tools.cR(c.tools.bZ(i),!0),d.data.preventDefault()}if(u&&37<=r&&r<=40){for(l=c.data().shownFiles,s=0;s<l.length;s++)if(!l[s].isDeleted){n.tools.cR(l[s],a);break}}else{if("list"==c.data().dA)38==r?(d.data.preventDefault(),(i=f.rowNode()).gE()&&n.tools.cR(n.tools.bZ(i.cf()),a)):40==r&&(d.data.preventDefault(),(i=f.rowNode()).ge()&&n.tools.cR(n.tools.bZ(i.dG()),a));else if(38==r){if(d.data.preventDefault(),(i=f.rowNode()).gE()){for(o=i.cf();o&&o.$.offsetLeft!=i.$.offsetLeft;)o=o.cf();o&&n.tools.cR(n.tools.bZ(o),a)}}else if(r==("rtl"==c.app.lang.dir?37:39))d.data.preventDefault(),(i=f.rowNode()).ge()&&n.tools.cR(n.tools.bZ(i.dG()),a);else if(40==r){if(d.data.preventDefault(),(i=f.rowNode()).ge()){for(o=i.dG();o&&o.$.offsetLeft!=i.$.offsetLeft;)o=o.dG();o&&n.tools.cR(n.tools.bZ(o),a)}}else r==("rtl"==c.app.lang.dir?39:37)&&(d.data.preventDefault(),(i=f.rowNode()).gE()&&n.tools.cR(n.tools.bZ(i.cf()),a));!u&&f&&(13==r&&c.oW("requestSelectAction",{file:f}),46==r&&c.app.execCommand("DeleteFile"),113==r&&c.app.execCommand("RenameFile"))}n.oW("successKeyboardNavigation",t),n.oW("afterKeyboardNavigation",t)}catch(e){throw e=V.ba(e),n.oW("failedKeyboardNavigation",t),n.oW("afterKeyboardNavigation",t),e}})}}),e.bh("ProcessingFile",["requestProcessingFile"],function(e){var t=this.tools.bZ(e),n=G.extend({},e.data,{file:t},!0);this.oW("beforeProcessingFile",n,function(e,t){if(!e)try{var n=t.file;if(n){var i=n.rowNode();i&&i.addClass("processing"),this.on("afterProcessingFile",function(e){e.data.file==n&&(t.step=2,this.oW("successProcessingFile",t),this.oW("afterProcessingFile",t),e.removeListener())}),t.step=1,this.oW("successProcessingFile",t)}else this.oW("failedProcessingFile",t)}catch(e){throw this.oW("failedProcessingFile",t),this.oW("afterProcessingFile",t),V.ba(e)}})}),e.bh("RepaintFile",["requestRepaintFile"],function(e){var t=this.tools.bZ(e),n=G.extend({},e.data,{file:t},!0);this.oW("beforeRepaintFile",n,function(e,t){var n=this;if(!e)try{var i=t.file;if(i){var o=i.filenameNode();o&&o.getHtml()!=G.htmlEncode(i.name)&&o.setHtml(G.htmlEncode(i.name));var a=i.rowNode();a&&a.removeClass("processing"),n.oW("successRepaintFile",t)}else n.oW("failedRepaintFile",t);n.oW("afterRepaintFile",t)}catch(e){throw n.oW("failedRepaintFile",t),n.oW("afterRepaintFile",t),V.ba(e)}})}),L&&W.ie6Compat&&!W.ie7Compat&&!W.ie8&&e.bh("HoverFile",["mouseover","mouseout"],function(i){if("list"==this.data().dA){var e=this.tools.bZ(i);if(e){var t=G.extend({},i.data,{bi:e.rowNode()},!0);this.oW("beforeHoverFile",t,function(e,t){var n=this;if(!e)try{"mouseover"==i.name?(n.data().ho&&n.data().ho.removeClass("hover"),t.bi.addClass("hover"),n.data().ho=t.bi):(n.data().ho.removeClass("hover"),delete n.data().ho),n.oW("successHoverFile",t),n.oW("afterHoverFile",t)}catch(e){throw n.oW("failedHoverFile",t),n.oW("afterHoverFile",t),V.ba(e)}})}}});var h=0,m=0,b=0;function d(e,t,n,i,o,a,r,l){var s=e.aNode();if(s){var d=s.getChild([t,0]);if(d&&!d.$.style.backgroundImage){r!=m&&(b=0),m=r;var c,u,f=n(d.$);if(f<i+o+a&&o<=f){var p=e.getThumbnailUrl(!0);p&&(c=d,u=p,b+=l,setTimeout(function(){if(!(r<h-1))try{c.$.style.backgroundImage='url("'+u+'")'}catch(e){}},b))}}}}e.bh("RenderThumbnails",["requestRenderThumbnails"],function(){var s=this;s.tq||(s.tq=!0,setTimeout(function(){var e=s.hF.shownFiles;if(e[0]){function t(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}for(var n=s.eh.$.offsetHeight,i=s.eh.$.scrollTop,o=t(s.eh.$),a=s.app.config.showContextMenuArrow?1:0,r=0,l=e.length;r<l;r++)d(e[r],a,t,n,i,o,h,s.app.config.thumbnailDelay);h++,s.tq=!1}else s.tq=!1},50))}),e.bh("RenderFiles",["requestRenderFiles"],function(e){var t,n,i=this.data(),o=e.data&&(e.data.lookup||e.data.lastView&&e.data.lastView.lookup),a=e.data&&(!!e.data.ma||!!e.data.lK||!!o),r=e.data&&e.data.ma;if(g){if(e.data&&e.data.files){for(this.tools.kR(),n=0;n<e.data.files.length;n++)i.files[n]=e.data.files[n];t=i.files,a=1,this.data().folder=e.data.folder}var l=this.data().folder;if(!r||r==l){!a&&i.cP&&!i.pq||(i.cP={}),v.call(this);var s=l.type;if(this._.nV||(this.app.config["defaultViewType_"+s]&&(i.dA=this.app.config["defaultViewType_"+s]),this.app.config["defaultSortBy_"+s]&&(i.cN=this.app.config["defaultSortBy_"+s]),void 0!==this.app.config["defaultDisplayFilename_"+s]&&(i.display.filename=this.app.config["defaultDisplayFilename_"+s]),void 0!==this.app.config["defaultDisplayDate_"+s]&&(i.display.date=this.app.config["defaultDisplayDate_"+s]),void 0!==this.app.config["defaultDisplayFilesize_"+s]&&(i.display.filesize=this.app.config["defaultDisplayFilesize_"+s])),i.files.length||o||i._fullSet)if("date"!=i.cN||!i.cP.date||o||i._fullSet)if("size"!=i.cN||!i.cP.size||o||i._fullSet)if("extension"!=i.cN||!i.cP.extension||o||i._fullSet)if("filename"!=i.cN||!i.cP.filename||o||i._fullSet){V.log("[FILES VIEW] Sorting files");var d=i.files,c=o?new RegExp(o.replace(/[-/ \\^$* + ?.()|[\]{}]/g,"\\$&"),"i"):null;i.lookup=o,t=[];for(n=0;n<d.length;n++)if(!d[n].isDeleted){var u=t.length;t[d[n].index=u]=d[n]}for(i._fullSet=o?[]:void 0,n=i.files.length=0;n<t.length;n++)i.files[n]=t[n];for(t=[],n=0;n<i.files.length;n++)t[n]=i.files[n],t[n].releaseDomNodes();function f(e,t){var n=e.name.toLowerCase(),i=t.name.toLowerCase();return n<i?-1:i<n?1:0}"date"==i.cN?(t.sort(function(e,t){return e.date>t.date?-1:e.date<t.date?1:0}),i.cP.date=t):"size"==i.cN?(t.sort(function(e,t){return e.size>t.size?-1:e.size<t.size?1:0}),i.cP.size=t):"extension"==i.cN?(t.sort(function(e,t){return e.ext>t.ext?1:e.ext<t.ext?-1:f(e,t)}),i.cP.extension=t):(t.sort(f),i.cP.filename=t)}else t=i.cP.filename;else t=i.cP.extension;else t=i.cP.size;else t=i.cP.date;else t=i.files;if(o)for(d=t,t=[],n=0;n<d.length;n++)!d[n].isDeleted&&c.test(d[n].name)&&t.push(d[n]);var p=G.extend({eu:1,dA:this.data().dA,display:this.data().display},e.data,{files:t},!0);if(this.oW("beforeRenderFiles",p,function(e,t){if(!e&&"t"==g.charAt(8)){se=V.bF.substr(2,1),le=V.bF.substr(7,1);try{for(var n=0;n<t.files.length;n++)t.files[n].releaseDomNodes();this.data().shownFiles=t.files,this.tools.cR(),this.oW("requestAddFiles",t,function(e){e||(i.hA=t.dA)}),this.oW("successRenderFiles",t),this.oW("afterRenderFiles",t)}catch(e){throw this.oW("failedRenderFiles",t),this.oW("afterRenderFiles",t),V.ba(e)}}}),this._.initialized)"thumbnails"==this.hF.dA&&this.oW("requestRenderThumbnails");else{var h=this.eh,m=this;h.on("scroll",function(){"thumbnails"==m.hF.dA&&this.oW("requestRenderThumbnails")},this),this.app.on("afterRepaintLayout",function(){"thumbnails"==m.hF.dA&&setTimeout(function(){m.oW("requestRenderThumbnails")},0)}),this._.initialized=!0}}}}),e.dT.push(function(e,a){a=this,e.on("afterCommandExecDefered",function(t){if(t.data){var e,n=t.data.name;if("RenameFile"==n){var i=t.data.file,o=1<a.tools.oO().length;if(e=i&&i.folder,a.tools.currentFolder()!=e)return;a.oW("requestRenderFiles",{folder:e,lK:1},function(e){e||(i.deselect(!0),a.oW("requestSelectFile",{file:t.data.file,multiple:o},function(){e||i.focus(o)}))})}else if("RemoveFiles"==n){if(e=t.data.folder,a.tools.currentFolder()!=e)return;a.tools.cR(),a.bn().focus(),a.oW("requestRenderFiles",{folder:e,lK:1})}}})}),e.bh("SelectFile",["click","requestSelectFile"],function(e){var t=this.tools.bZ(e),l="click"==e.name,s=e.data&&e.data.multiple&&this.app.config.selectMultiple;if(g.length>>4){if(l&&e.data.db()>=V.bP&&(e.data.preventDefault(),s=(e.data.$.ctrlKey||e.data.$.metaKey)&&this.app.config.selectMultiple),l&&e.data.bK().hasClass("dropdown"))return e.jN.oW("contextmenu",e.data),void e.cancel();var n=G.extend({},e.data,{file:t},!0);this.oW("beforeSelectFile",n,function(e,t){var n=this;if(!e){var i=t.file;try{if(n.tools.dH()&&!s){for(var o=n.tools.oO(),a=0;a<o.length;a++)o[a].rowNode()&&o[a].rowNode().removeClass("selected");n.data().nY=[]}if(i&&s&&i.rowNode().hasClass("selected")&&n.tools.dH()){o=n.tools.oO();var r=[];for(a=0;a<o.length;a++)o[a].isSameFile(i)?o[a].rowNode().removeClass("selected"):(o[a].rowNode().hasClass("selected")||o[a].rowNode().addClass("selected"),r.push(o[a]));n.data().nY=r,n.data().cG.isSameFile(i)&&(n.data().cG=n.data().nY[r.length-1]),l&&n.tools.cR(n.tools.dH(),!0,1<=r.length)}else i?(i.rowNode().addClass("selected"),n.data().nY||(n.data().nY=[]),n.data().cG=i,n.data().nY.push(i),l&&n.tools.cR(i,s,s)):n.tools.dH()&&!s&&(n.data().cG=null,n.data().nY=[],n.tools.cR());n.oW("successSelectFile",t),n.oW("afterSelectFile",t)}catch(e){throw n.oW("failedSelectFile",t),n.oW("afterSelectFile",t),V.ba(e)}}})}}),e.bh("AddFiles",["requestAddFiles"],function(e){var t=G.extend({eu:0,view:"thumbnails",mj:null},e.data,{files:e.data.file?[e.data.file]:e.data.files},!0);this.oW("beforeAddFiles",t,function(e,t){if(!e)try{var n,i,o=this,a=o.bn(),r=o.data().hA,l=0;a.removeClass("files_message"),nt()&&(t.files.length&&(t.mj=g),l=1);var s=V.bs.indexOf(se),d=V.bs.indexOf(V.bF.substr(0,1)),c=s-d;if("list"==t.dA){this.data().kQ||(this.data().kQ=G.bind(this.tools.qc,this.tools)),a.removeClass("files_thumbnails"),a.addClass("files_details"),n=st(t.files,this.data().kQ),i=this.tools.fF();var u=this.tools.kj();if(r&&"list"!=r&&this.tools.lP().setHtml(""),L){if(u&&r&&"list"==r&&!t.eu&&(n=u.getHtml()+n),i&&i.remove(),n){var f=fe[0]+this.tools.lz()+fe[1]+n+fe[2]+fe[3];a.appendHtml(f)}this.tools.releaseDomNodes(["detailsContentNode","detailsRootNode"])}else n?t.eu?this.tools.fF().setHtml(this.tools.lz()+fe[1]+n+fe[2]):u.appendHtml(n):i.setHtml("")}else{a.removeClass("files_details"),a.addClass("files_thumbnails");var p=this.data().display;if(n=st(t.files,function(e){var t="r"+e.index,n=[];return n.push('<a id="',t),n.push('" class="file_entry" tabindex="-1" role="listiem presentation" href="javascript:void(0)" title="',G.htmlEncode(e.name).replace('"',"&quot;"),'" aria-labelledby="',t),n.push('_label" aria-describedby="',t,'_details" style="width: '+(o.app.config.thumbsWidth+10)+'px">'),n.push(ce,'<div class="image"><div role="img" style="width: '+o.app.config.thumbsWidth+"px; height: "+o.app.config.thumbsHeight+'px"></div></div>'),p.filename&&n.push('<h5 id="',t,'_label">',G.htmlEncode(e.name),"</h5>"),n.push('<span id="'+t+'_details" class="details" role="list presentation">'),p.date&&n.push('<span role="listitem" class="extra">',e.dateF,"</span>"),p.filesize&&n.push('<span role="listitem" aria-label="Size">',G.formatSize(e.size,o.app.lang,!0),"</span>"),n.push("</span></a>"),n.join("")}),i=this.tools.lP(),r&&"list"==r){var h=this.tools.fF();h&&L?h.remove():h&&h.setHtml("")}t.eu?i.setHtml(n):i.appendHtml(n)}c<0&&(c=s-d+33),l||le&&!(V.bs.indexOf(le)%(c?8:33)<7)||(t.mj="Product license has expired. Please visit the <a href='http://cksource.com/ckfinder' target='_blank'>CKFinder web site</a> to obtain a valid license.",l=1),(t.eu&&!n||l)&&t.mj&&(a.addClass("files_message"),this.tools.of().setHtml(t.mj)),le||l||i.setHtml(""),this.oW("successAddFiles"),this.oW("afterAddFiles")}catch(e){throw this.oW("failedAddFiles"),this.oW("afterAddFiles"),V.ba(e)}})}),e.bh("ShowFolderFiles",["requestShowFolderFiles"],function(t){var c=this,e=V.ld.bX["foldertree.foldertree"].tools.cq(t),n=G.extend({},t.data,{folder:e},!0);this.oW("beforeShowFolderFiles",n,function(e,l){if(!e){this.tools.dH()&&this.oW("requestSelectFile"),this.app.cS("refresh").bR(V.aY);try{var s=l.folder;if(!s.acl.folderView)throw c.app.msgDialog("",c.app.lang.Errors[103]),"[CKFINDER] No permissions to view folder.";(t.data.ib=this).data().folder=s,c.tools.kR();var d=t.data.lookup?t.data.lookup:null;this.oW("requestRenderFiles",{eu:1,mj:c.app.lang.FilesLoading}),this.app.connector.sendCommand("GetFiles",void 0,function(e){if(c.app.cS("refresh").bR(V.aS),c.app.aV!=s)return c.oW("failedShowFolderFiles",l),void c.oW("afterShowFolderFiles",l);if(!(e.checkError()||nt.toString().length<200)){c.tools.kR();for(var t,n=e.selectNodes("Connector/Files/File"),i=0;i<n.length;i++){var o=n[i].attributes.getNamedItem("date").value,a=n[i].attributes.getNamedItem("name").value,r=c.tools.rg(new V.aL.File(a,parseInt(n[i].attributes.getNamedItem("size").value,10),!!n[i].attributes.getNamedItem("thumb")&&n[i].attributes.getNamedItem("thumb").value,o,c.app.lB(o.substr(6,2),o.substr(4,2),o.substr(0,4),o.substr(8,2),o.substr(10,2)),s,lt(n[i])));l.mw&&a==l.mw&&(t=r)}c.oW("requestRenderFiles",{mj:c.app.lang.FilesEmpty,lookup:d}),t&&(c.app.oW("requestSelectFile",{file:t,scrollTo:1}),setTimeout(function(){t.aNode().$.scrollIntoView(1),c.app.layout.mB().getFirst().$.scrollIntoView(0)},W.opera?500:100)),c.oW("successShowFolderFiles",l),c.oW("afterShowFolderFiles",l),tt(c)}},s.type,s)}catch(e){throw this.oW("failedShowFolderFiles",l),this.oW("afterShowFolderFiles",l),V.ba(e)}}})}),e.tools.bZ=function(e){var t,n=0;if(e.data&&e.data.file instanceof Y?(e=e.data.file,n=1):e.data&&e.data.bK?(e=e.data.bK(),n=1):e instanceof w.bi&&(n=1),n){for(var i=e;i&&(!i.is("a")||!i.hasAttribute("id"))&&!i.is("tr")&&i!=this.ib.eh;)i=i.getParent();if(i)i.dS()&&(i.is("a")||i.is("tr"))&&(t=this.ib.data().files[i.dS().slice(1)])}else"number"==typeof e?t=this.ib.data().files[e]:"String"==typeof e?t=this.ib.data().files[i.dS().slice(1)]:e.data&&e.data.file&&e.data.file instanceof V.aL.File?t=e.data.file:e.data&&e.data.files&&e.data.files.length&&e.data.files[0]&&e.data.files[0]instanceof V.aL.File?t=e.data.files[0]:e instanceof V.aL.File&&(t=e);return t},e.tools.kR=function(){var e=this.ib.data();e.files.length=0,e.cP={}},e.tools.oR=function(e,t){e.thumb;var n=e.name,i=this.ib.app,o=i.config.jh||"gif",a=n.match(i.rQ.jf);return(a=a&&a[0])&&i.rQ.jh.test(a)?i.fh+"images/icons/"+(t?"32":"16")+"/"+a.toLowerCase()+"."+o:i.fh+"images/icons/"+(t?"32":"16")+"/default.icon."+o},e.tools.rg=function(e){var t=this.ib.data().files.push(e);return e.index=--t,e.app=this.ib.app,e},e.tools.lP=function(e){return this.jl||(this.jl=this.ib.bn().getChild(1)),this.jl},e.tools.kj=function(e){if(void 0===this.iJ){var t=this.fF();this.iJ=t?ct(dt(t.$.childNodes,"tbody")):null}return this.iJ},e.tools.sn=function(e){if(void 0===this.kT){var t=this.fF();this.kT=t?ct(dt(t.$.childNodes,"thead")):null}return this.kT},e.tools.fF=function(e){return void 0===this.iO&&(this.iO=ct(dt(this.ib.bn().$.childNodes,"table"))),this.iO},e.tools.of=function(e){return this.iF||(this.iF=this.ib.bn().getChild(0)),this.iF},e.tools.releaseDomNodes=function(e){this.jl=void 0,this.iO=void 0,this.iJ=void 0,this.iF=void 0},e.tools.lz=function(){var e=this.ib.data().display,t=[];t.push('<td class="name">'+this.ib.app.lang.SetDisplayName+"</td>"),e.filesize&&t.push("<td>"+this.ib.app.lang.SetDisplaySize+"</td>"),e.date&&t.push("<td>"+this.ib.app.lang.SetDisplayDate+"</td>");var n=t.length-1;return t[n]=n?'<td class="last">'+t[n].substr(4):'<td class="last '+t[n].substr(11),"<thead><tr><td>&nbsp;</td>"+t.join("")+"</tr></thead>"},e.tools.qc=function(e){var t=this.oR(e),n="r"+e.index,i=this.ib.data().display,o=[];o.push('<td class="name">'+ue+'<a tabindex="-1">'+(i.filename?G.htmlEncode(e.name):"")+"</a></td>"),i.filesize&&o.push("<td>"+G.formatSize(e.size,this.ib.app.lang,!0)+"</td>"),i.date&&o.push("<td>"+e.dateF+"</td>");var a=o.length-1;return o[a]=a?'<td class="last">'+o[a].substr(4):'<td class="last '+o[a].substr(11),'<tr id="'+n+'"><td class="image"><img src="'+t+'" alt="img alt" /></td>'+o.join("")+"</tr>"},e.tools.dH=function(){var e=this.ib.data();if(e.cG)return e.cG.isDeleted?e.cG=null:e.cG},e.tools.oO=function(e){var t=this.ib.data(),n=[];if(t.nY){for(var i=0;i<t.nY.length;i++)t.nY[i]&&!t.nY[i].isDeleted&&n.push(t.nY[i]);if(e){var o=n,a={};n=[];for(i=0;i<o.length;i++)o[i].name in a||(n.push(o[i]),a[o[i].name]=1)}}return t.nY=n},e.tools.currentFolder=function(){return this.ib.data().folder},e.tools.cR=function(e,t,n){var i=this;e?(i.iS?i.iS.blur():i.ib.bn().setAttribute("tabindex",-1),(i.iS=e).focus(t,n)):(delete i.iS,i.ib.bn().setAttribute("tabindex",0))},e.tools.downloadFile=function(e,t){var n=e.getById("downloadIframe");n||((n=e.createElement("iframe")).setAttribute("id","downloadIframe"),n.setStyle("display","none"),e.bH().append(n)),n.setAttribute("src",t)}}(),V.dialog.add("moveFileExists",function(e){return{title:e.lang.FileExistsDlgTitle,minWidth:350,minHeight:120,contents:[{id:"tab1",label:"",title:"",style:W.ie7Compat?"height:auto":"",expand:!0,padding:0,elements:[{id:"msg",className:"cke_dialog_error_msg",type:"html",widths:["70%","30%"],html:""},{type:"hbox",className:"cke_dialog_file_exist_options",children:[{type:"radio",id:"option",label:e.lang.common.makeDecision,default:"autorename",items:[[e.lang.FileAutorename,"autorename"],[e.lang.FileOverwrite,"overwrite"],[e.lang.common.skip,"skip"]]}]},{type:"hbox",className:"cke_dialog_remember_decision",children:[{type:"checkbox",id:"remember",label:e.lang.common.rememberDecision}]}]}],buttons:[CKFinder.dialog.okButton,CKFinder.dialog.cancelButton]}})},bz:function(o){var t=this;o.rQ.jh=new RegExp("^("+o.config.fileIcons+")$","i"),o.rQ.rO=/^(jpg|gif|png|bmp|jpeg)$/i,o.rQ.jf=de.fX,o.on("themeSpace",function(e){if("mainMiddle"==e.data.space){var t="";L||(t=fe[0]+fe[3]),e.data.html+="<div id='files_view' class='view widget files_thumbnails' aria-live='polite' role='main' tabindex='0' aria-controls='status_view'><h4 class='message_content'></h4><div class='files_thumbnails fake no_list' role='list'></div>"+t+"</div>"}}),o.on("uiReady",function(){o.config.showContextMenuArrow||(ue=ce="");var e=o.document.getById("files_view");e.hX();var r=V.ld.bz(o,"filesview",t,e);o.config.selectMultiple&&e.on("click",function(e){if(e.data.$.shiftKey){var t=r.tools.dH(),n=r.tools.bZ(e),i=!t;if(n){t&&(t.rowNode().$.offsetTop<n.rowNode().$.offsetTop?i=1:"list"!=r.data().dA&&t.rowNode().$.offsetTop==n.rowNode().$.offsetTop&&(i=t.rowNode().$.offsetLeft<n.rowNode().$.offsetLeft));for(var o,a=n.rowNode();(a=i?a.cf():a.dG())&&(o=r.tools.bZ(a),!t||!o.isSameFile(t));)o.select(!0);r.tools.cR(n,!0),e.cancel(),e.data.preventDefault()}}},null,null,1),o.bD("ViewFile",{exec:function(e){var t=r.data().cG;if(t){if(!0===e.oW("launchGallery",{selected:t,files:r.data().files}).bx)return;var n=.8*window.screen.width,i=.7*window.screen.height,o="menubar=no,location=no,status=no,toolbar=no,scrollbars=yes,resizable=yes";o+=",width="+n,o+=",height="+i,o+=",left="+(window.screen.width-n)/2,o+=",top="+(window.screen.height-i)/2,(e.cg.inPopup?e.document.getWindow().$.parent:window).open(t.getUrl(),"_blank",o)||e.msgDialog("",e.lang.ErrorMsg.PopupBlockView)}}}),o.bD("DownloadFile",{exec:function(e){var t,n=r.data().cG;n&&(t=e.config.directDownload?n.getUrl()+"?download":e.connector.composeUrl("DownloadFile",{FileName:n.name},n.folder.type,n.folder),r.tools.downloadFile(e.document,t))}}),o.bD("RenameFile",{readOnly:!1,exec:function(n){function t(e,t){try{i.rename(t)}catch(e){if(!(e instanceof V.dU))throw e;n.msgDialog("",e.message)}}var i=r.data().cG;i&&i.folder.acl.fileRename&&n.hs(n.lang.RenameDlgTitle,n.lang.FileRename,i.name,function(e){(e=G.trim(e))&&(e.match(n.rQ.jf)[0].toLowerCase()!=i.ext.toLowerCase()?n.fe("",n.lang.FileRenameExt,function(){t(0,e)}):t(0,e))})}}),o.bD("DeleteFile",{readOnly:!1,exec:function(e){var t=r.tools.oO(!0);t&&0!=t.length&&t[0].folder.acl.fileDelete&&e.fe("",1==t.length?e.lang.FileDelete.replace("%1",G.escapeHtml(t[0].name)):e.lang.FilesDelete.replace("%1",t.length),function(){rt(e,t)})}}),o.bD("copyFilesToFolder",{readOnly:!1,exec:function(e,t){t.files||(t.files=r.tools.oO()),t.files.length&&t.destination&&t.destination.acl.fileUpload&&it(e,t,0,0,[],t.callback)}}),o.bD("moveFilesToFolder",{readOnly:!1,exec:function(e,t){t.files||(t.files=r.tools.oO()),t.files.length&&t.destination&&t.destination.acl.fileUpload&&t.files[0].folder.acl.fileDelete&&it(e,t,1,0,[],t.callback)}}),o.eU&&(o.dZ("file0",90),o.dZ("file1",100),o.dZ("file2",110),o.dZ("file3",120),o.eU({selectFile:{label:o.lang.Select,onClick:function(){var e=o.ld["filesview.filesview"],t=e.tools.dH();t&&e.oW("requestSelectAction",{file:t})},group:"file0"},selectFileThumbnail:{label:o.lang.SelectThumbnail,onClick:function(){var e=o.ld["filesview.filesview"],t=e.tools.dH();t&&e.oW("requestSelectThumbnailAction",{file:t})},group:"file0"},viewFile:{label:o.lang.View,command:"ViewFile",group:"file1"},downloadFile:{label:o.lang.Download,command:"DownloadFile",group:"file1"},renameFile:{label:o.lang.Rename,command:"RenameFile",group:"file2"},deleteFile:{label:o.lang.Delete,command:"DeleteFile",group:"file3"},deleteFiles:{label:o.lang.DeleteFiles,command:"DeleteFile",group:"file3"}})),o.bj&&(o.bj.lX(e),o.bj.kh(function(e){var t=r.tools.bZ(e);if(t){t.rowNode().hasClass("selected")?r.data().cG=t:o.oW("requestSelectFile",{file:t});var n=t.folder.acl,i={viewFile:n.fileView?V.aS:V.aY,downloadFile:n.fileView?V.aS:V.aY};return o.config.readOnly||(i.renameFile=n.fileRename?V.aS:V.aY,i[1<r.tools.oO().length?"deleteFiles":"deleteFile"]=n.fileDelete?V.aS:V.aY),o.config.selectActionFunction&&(i.selectFile=n.fileView?V.aS:V.aY),t.isImage()&&!o.config.disableThumbnailSelection&&(o.config.selectThumbnailActionFunction||o.config.thumbsDirectAccess&&o.config.selectActionFunction)&&(i.selectFileThumbnail=n.fileView?V.aS:V.aY),r.oW("beforeContextMenu",{bj:i,file:t,folder:r.data().folder}),i}},e))}),o.bD("filesviewFocus",{exec:function(e){var t=e.layout.pn(),n=e.ld["filesview.filesview"].tools.dH();t.focus(),n&&n.focus()}})}}),V.aL.File=function(e,t,n,i,o,a,r){var l=this;l.index=null,l.app=null,l.name=e,l.ext=e.match(de.fX)[0],l.nameL=e.toLowerCase(),l.size=t,l.thumb=n,l.date=i,l.dateF=o,l.folder=a,l.isDeleted=!1,l.custom=r},V.aL.File.prototype={tZ:{date:1,name:1,size:1,thumb:1},rename:function(e){!function(e,t){if(!e||0===e.length)throw new V.dU("name_empty",t.lang.ErrorMsg.FileEmpty);if(de.iz.test(e))throw new V.dU("name_invalid_chars",t.lang.ErrorMsg.FileInvChar)}(e,this.app);var t=this;t.name!=e?(t.app.oW("requestProcessingFile",{file:t}),t.app.connector.sendCommandPost("RenameFile",{fileName:t.name,newFileName:e},null,function(e){e.checkError()?t.app.oW("requestRepaintFile",{file:t}):(t.name=e.selectSingleNode("Connector/RenamedFile/@newName").value,t.nameL=t.name.toLowerCase(),t.ext=t.name.match(de.fX)[0],t.thumb=0,t.app.oW("afterCommandExecDefered",{name:"RenameFile",file:t}))},t.folder.type,t.folder)):t.app.oW("afterCommandExecDefered",{name:"RenameFile",file:t})},remove:function(){rt(this.app,[this])},select:function(e){this.app.oW("requestSelectFile",{file:this,multiple:e})},deselect:function(e){e?this.select(!0):this.app.oW("requestSelectFile")},toString:function(){return this.name},isImage:function(){return this.app.rQ.rO.test(this.ext)},isSameFile:function(e){return(this.name==e.name||this.index==e.index)&&this.folder.getPath()==e.folder.getPath()&&this.folder.type==e.folder.type},getUrl:function(){return this.folder.getUrl()+encodeURIComponent(this.name)},rowNode:function(){var e=this;return e.je||(e.je=e.app.document.getById("r"+e.index)),e.je},getThumbnailUrl:function(e){var t=this,n=t.thumb,i=t.name,o=t.app,a=i.match(o.rQ.jf),r=o.config.jh||"gif";if(a=a&&a[0]){if(o.config.thumbsEnabled&&o.rQ.rO.test(a)){var l=encodeURIComponent(t.date+"-"+t.size);if(n&&o.config.thumbsDirectAccess)return o.config.thumbsUrl+t.folder.type+t.folder.getPath()+encodeURIComponent(i)+(e?"?hash="+o.getResourceType(t.folder.type).hash+"&fileHash="+l:"");var s={FileName:i};return e&&(s.fileHash=l),o.connector.composeUrl("Thumbnail",s,t.folder.type,t.folder)}if(o.config.useNativeIcons&&W.gecko)return"moz-icon://."+a.toLowerCase()+"?size=32";if(o.rQ.jh.test(a))return o.fh+"images/icons/32/"+a.toLowerCase()+"."+r}return o.fh+"images/icons/32/default.icon."+r},filenameNode:function(){var e=this;if(void 0===e.ht){var t=e.rowNode();t&&(t.is("a")?e.ht=ct(dt(t.$.childNodes,"h5")):e.ht=ct(dt(e.aNode().$.childNodes,"h5")))}return e.ht},aNode:function(){var e=this;if(void 0===e.dM){var t=e.rowNode();if(t)if(t.is("a"))e.dM=t;else{var n=dt(t.$.childNodes,"td",1);e.dM=ct(dt(n.childNodes,"a"))}}return e.dM},focusNode:function(){return this.aNode()},releaseDomNodes:function(){this.je=void 0,this.dM=void 0,this.ht=void 0},focus:function(e,t){t||this.select(e);var n=this.focusNode();n.setAttribute("tabindex",0),n.focus()},blur:function(){this.aNode().setAttribute("tabindex",-1)}},j.add("filebrowser",{bz:function(e){e.cg._.ra=G.addFunction(mt,e.cg)}}),V.on("dialogDefinition",function(e){var t,n=e.data.dg;for(var i in n.contents)t=n.contents[i],pt(e.application.cg,e.data.name,n,t.elements),t.hidden&&t.filebrowser&&(t.hidden=!ht(n,t.id,t.filebrowser))}),j.add("button",{eK:function(e){e.bY.kd(V.UI_BUTTON,je.button.dq)}}),CKFinder._.UI_BUTTON=V.UI_BUTTON=1,je.button=function(t){G.extend(this,t,{title:t.label,className:t.className||t.command&&"cke_button_"+t.command||"",click:t.click||function(e){t.command?e.execCommand(t.command):t.onClick&&t.onClick(e)}}),this._={}},je.button.dq={create:function(e){return new je.button(e)}},je.button.prototype={canGroup:!0,er:function(t,e){var n=W,i=this._.id="cke_"+G.getNextNumber();this._.app=t;var o={id:i,button:this,app:t,focus:function(){var e=t.document.getById(i);e&&e.focus()},lc:function(){this.button.click(t)}},a=G.addFunction(o.lc,o),r=je.button._.instances.push(o)-1,l="",s=this.command;if(this.iH?t.on("mode",function(){this.bR(this.iH[t.mode]?V.aS:V.aY)},this):(s=s&&t.cS(s))&&(s.on("bu",function(){this.bR(s.bu)},this),l+="cke_"+(s.bu==V.eV?"on":s.bu==V.aY?"disabled":"off")),s||(l+="cke_off"),this.className&&(l+=" "+this.className),e.push('<span class="cke_button">','<a id="',i,'" class="',l,'" href="javascript:void(\'',(this.title||"").replace("'",""),'\')" title="',this.title,'" tabindex="-1" hidefocus="true" role="button" aria-labelledby="'+i+'_label"'+(this.vZ?' aria-haspopup="true"':"")),(n.opera||n.gecko&&n.mac)&&e.push(' onkeypress="return false;"'),n.gecko&&e.push(' onblur="this.style.cssText = this.style.cssText;"'),e.push(' onkeydown="window.parent.CKFinder._.uiButtonKeydown(',r,', event);" onfocus="window.parent.CKFinder._.uiButtonFocus(',r,', event);" onclick="window.parent.CKFinder._.callFunction(',a,', this); return false;">'),!1!==this.icon&&e.push('<span class="cke_icon"'),this.icon){var d=-16*(this.rD||0);e.push(' style="background-image:url(',V.getUrl(this.icon),");background-position:0 "+d+'px;"')}return!1!==this.icon&&e.push("></span>"),e.push('<span id="',i,'_label" class="cke_label">',this.label,"</span>"),this.vZ&&e.push('<span class="cke_buttonarrow"></span>'),e.push("</a>","</span>"),this.onRender&&this.onRender(),o},bR:function(e){var t=this;if(t._.bu==e)return!1;t._.bu=e;var n=t._.app.document.getById(t._.id);if(n){n.bR(e),e==V.aY?n.setAttribute("aria-disabled",!0):n.removeAttribute("aria-disabled"),e==V.eV?n.setAttribute("aria-pressed",!0):n.removeAttribute("aria-pressed");var i=t.title,o=t._.app.lang.common.unavailable,a=n.getChild(1);return e==V.aY&&(i=o.replace("%1",t.title)),a.setHtml(i),!0}return!1}},je.button._={instances:[],keydown:function(e,t){var n=je.button._.instances[e];if(n.onkey)return t=new w.event(t),!1!==n.onkey(n,t.db())},focus:function(e,t){var n,i=je.button._.instances[e];return i.onfocus&&(n=!1!==i.onfocus(i,new w.event(t))),W.gecko&&W.version<10900&&t.preventBubble(),n}},CKFinder._.uiButtonKeydown=je.button._.keydown,CKFinder._.uiButtonFocus=je.button._.focus,je.prototype.qW=function(e,t){this.add(e,V.UI_BUTTON,t)},j.add("container",{bM:[],bz:function(e){var t=this;e.on("themeAvailable",function(){t.pV(e)})},pV:function(i){var e=i.config.height,t=i.config.tabIndex||i.element.getAttribute("tabindex")||0;isNaN(e)||(e=Math.max(e,200),e+="px");var n="",o=i.config.width;o&&(isNaN(o)||(o+="px"),n+="width: "+o+";");var a=i.config.className?'class="'+i.config.className+'"':"",r=W.isCustomDomain(),l="document.open();"+(r?'document.domain="'+window.document.domain+'";':"")+"document.close();",s=Y.kE('<iframe style="'+n+"height:"+e+'"'+a+' frameBorder="0" src="'+(L?"javascript:void(function(){"+encodeURIComponent(l)+"}())":"")+'" tabIndex="'+t+'" allowTransparency="true"></iframe>',i.element.getDocument());function d(e){e&&e.removeListener();var t=s.getFrameDocument().$;if(t.open(),r&&(t.domain=document.domain),i.document=new I(t),i.theme.dQ(i),t.close(),(t.defaultView||t.parentWindow).CKFinder=CKFinder,V.skins.load(i,"application",function(){var e=i.dJ;e&&e.oA(i.document)}),!s.isVisible()&&L&&8<=W.version)var n=setInterval(function(){s.isVisible()&&(i.layout.ea(!0),n=clearInterval(n))},500)}L&&9<=W.version&&i.cg.inPopup&&(i.element.getDocument().getWindow().$.ckfinder=function(){i.element.getDocument().getWindow().$.ckfinder=void 0,d()}),s.on("load",d);var c=i.lang.appTitle.replace("%1",i.name);W.gecko?(s.on("load",function(e){e.removeListener()}),i.element.setAttributes({role:"region",title:c}),s.setAttributes({role:"region",title:" "})):W.webkit?(s.setAttribute("title",c),s.setAttribute("name",c)):L&&s.appendTo(i.element),L||i.element.append(s),i.container=s}}),V.application.prototype.focus=function(){var e=this;if(e._.oO&&1<e._.oO.length){e.oW("requestSelectFile");for(var t=0,n=e._.oO.length;t<n;t++)e.oW("requestSelectFile",{file:e._.oO[t],multiple:!0})}(e._.activeElement?Y.eB(e._.activeElement):e.document.getWindow()).focus()},j.add("contextmenu",{bM:["menu"],eK:function(r){r.bj=new j.bj(r),r.bD("bj",{exec:function(){var e,t,n,i=r.layout.pn();if(i.hasClass("focus_inside")){var o=(n=r.ld["filesview.filesview"]).tools.dH();if(o)return t=(e=o.dM).ir(),r.bj.show(r.document.bH().getParent(),null,t.x+5,t.y+5,e,i),r._.activeElement=e,void(r._.oO=n.tools.oO())}if((i=r.layout.pS()).hasClass("focus_inside")){var a=(n=r.ld["foldertree.foldertree"]).tools.ew;if(a)return t=(e=a.dM).ir(),r.bj.show(r.document.bH().getParent(),null,t.x+5,t.y+5,e,i),r._.activeElement=e,void(r._.oO=[])}}})}}),j.bj=G.createClass({$:function(t){this.id="cke_"+G.getNextNumber(),this.app=t,this._.dF=[],this._.vx=G.addFunction(function(e){this._.panel.hide(),t.focus&&t.focus()},this)},_:{onMenu:function(e,t,n,i,o,a){var r=this._.menu,l=this.app;r?(r.hide(),r.ih()):(r=this._.menu=new V.menu(l)).onClick=G.bind(function(e){r.hide(),L&&l.focus&&l.focus(),e.onClick?e.onClick():e.command&&l.execCommand(e.command)},this),r.onEscape=function(){l.focus&&l.focus(),o.focus&&o.focus(),l._.activeElement=null};var s=this._.dF;r.onHide=G.bind(function(){r.onHide=null,this.onHide&&this.onHide()},this);for(var d=0;d<s.length;d++){var c=s[d];if(!c[1]||c[1].$==a.$){var u=s[d][0](o);if(u)for(var f in u){var p=this.app.mh(f);p&&(p.bu=u[f],r.add(p))}}}r.items.length&&r.show(e,t||("rtl"==l.lang.dir?2:1),n,i)}},ej:{lX:function(r,l){var i;!W.opera||"oncontextmenu"in document.body||(r.on("mousedown",function(e){if(2==(e=e.data).$.button){if(!l||!e.$.ctrlKey&&!e.$.metaKey){var t=e.bK();if(!i){var n=t.getDocument();(i=n.createElement("input")).$.type="button",n.bH().append(i)}i.setAttribute("style","position:absolute;top:"+(e.$.clientY-2)+"px;left:"+(e.$.clientX-2)+"px;width:5px;height:5px;opacity:0.01")}}else e.db()==V.bP+1&&r.oW("contextmenu",e)}),r.on("mouseup",function(e){i&&(i.remove(),i=void 0,r.oW("contextmenu",e.data))}));if(r.on("contextmenu",function(e){var t=e.data;if(!l||!(W.webkit?s:t.$.ctrlKey||t.$.metaKey)){t.preventDefault();var n=t.bK(),i=t.bK().getDocument().gT(),o=t.$.clientX,a=t.$.clientY;G.setTimeout(function(){this._.onMenu(i,null,o,a,n,r)},0,this)}},this),W.opera&&r.on("keypress",function(e){var t=e.data;0===t.$.keyCode&&t.preventDefault()}),W.webkit){function e(){s=0}var s;r.on("keydown",function(e){s=e.data.$.ctrlKey||e.data.$.metaKey}),r.on("keyup",e),r.on("contextmenu",e)}},kh:function(e,t){this._.dF.push([e,t])},show:function(e,t,n,i,o,a){this.app.focus(),this._.onMenu(e||V.document.gT(),t,n||0,i||0,o,a)}}}),j.add("dragdrop",{bM:["foldertree","filesview","contextmenu","dialog"],readOnly:!1,gr:function(u){var f,d;u.cK=new gt(u),u.on("themeSpace",function(e){"mainBottom"==e.data.space&&(e.data.html+='<div id="dragged_container" style="display: none; position: absolute;"></div>')}),u.on("uiReady",function(e){u.document.on("dragstart",function(e){e.data.preventDefault(!0)}),u.document.on("drag",function(e){e.data.preventDefault(!0)}),u.ld["filesview.filesview"].gA("Draggable"),u.ld["foldertree.foldertree"].ke("Droppable")}),V.ld.bX["filesview.filesview"].bh("Draggable",["mousedown"],function(e){var d=this,n=d.tools.bZ(e),c=d.tools.oO(!0);if(n&&e.data.ov()){e.data.preventDefault(),n.rowNode().hasClass("selected")||((e.data.$.ctrlKey||e.data.$.metaKey)&&u.config.selectMultiple?c.push(n):c=[n]);var t=G.extend({},{file:n,files:c,step:1},!0);d.oW("beforeDraggable",t,function(e,a){if(!e){var r=n.rowNode(),l=0,s=0;(f=f||u.document.getById("dragged_container")).hide(),u.document.on("mousemove",i),u.document.on("mouseup",o,999);var t=u.document.bH().$;u.document.on("mouseout",function(e){u.cK.qp()&&e.data.bK().$==t&&o()})}function i(e){if(f.setStyles({left:e.data.$.clientX-("rtl"==u.lang.dir?f.hR("width"):-1)+"px",top:e.data.$.clientY+"px"}),0===l&&(l=e.data.$.clientY+e.data.$.clientX),!(s||Math.abs(e.data.$.clientY+e.data.$.clientX-l)<20)){d.app.cK.kG(r),d.app.cK.kz(c);for(var t=0,n=c.length;t<n;t++)c[t].rowNode().addClass("dragged_source");var i;if(1==c.length?(f.setStyle("width",r.rd("width")),f.addClass("file_entry")):f.addClass("drag_multiple"),f.show(),1==c.length)i=(i=(i=r.getHtml()).replace(/url\(&quot;(.+?)&quot;\);?"/,'url($1);"')).replace(/url\(([^'].+?[^'])\);?"/,"url('$1');\"");else{var o=u.config.jh||"gif";i=function(e,t,n){for(var i=!0,o=t[0].ext.toLowerCase(),a=1,r=t.length;a<r;a++)if(t[a].ext.toLowerCase()!=o){i=!1;break}return'<div style="background-image: url('+(i?e.tools.oR(t[0],!0):e.app.fh+"images/icons/32/default.icon."+n)+')"><span>'+t.length+"</span></div>"}(d,c,o)}f.setHtml(i),s=1,d.app.document.bH().addClass("dragging"),d.app.ld["foldertree.foldertree"].gA("Droppable"),a.step=1,d.oW("successDraggable",a)}}function o(e){f.hide(),f.removeClass("drag_multiple"),f.removeClass("file_entry"),f.setStyle("width","auto"),f.setHtml("");for(var t=0,n=c.length;t<n;t++)c[t].rowNode().removeClass("dragged_source");d.app.cK.kG(null),d.app.cK.kz(null),u.document.removeListener("mousemove",i),e?e.removeListener():u.document.removeListener("mouseup",o),d.app.ld["foldertree.foldertree"].ke("Droppable"),d.app.document.bH().removeClass("dragging"),a.step=2,d.oW("successDraggable",a),d.oW("afterDraggable",a)}})}}),V.ld.bX["foldertree.foldertree"].bh("Droppable",["mouseup","mouseover","mouseout"],function(e){var t=e.data.bK(),s=this,n=e.name;if(!!s.app.cK.qp()&&!t.is("ul")){var i=s.tools.cq(t);if(i)if("mouseup"==n){s.app.cK.iW(0),s.app.cK.nz(i);var o=s.app.cK.pe(),a=G.extend({},{target:i,source:o},!0);s.oW("beforeDroppable",a,function(e,t){if(!e)try{var n=t.target,i=t.source,o=new V.iD(s.app,"copyFilesToFolderDrop",{label:s.app.lang.CopyDragDrop,bu:n!=i[0].folder&&n.acl.fileUpload?V.aS:V.aY,onClick:function(){s.oW("successDroppable",{hH:i,hC:n,step:2}),s.app.execCommand("copyFilesToFolder",{files:i,destination:n,callback:function(){s.oW("successDroppable",{hH:i,hC:n,step:3}),s.oW("afterDroppable",t)},errorCallback:function(){s.oW("failedDroppable",t),s.oW("afterDroppable",t)}})}}),a=window.top[V.nd+"cation"][V.jG+"st"],r={copyFilesToFolder:o,moveFilesToFolder:new V.iD(s.app,"moveFilesToFolderDrop",{label:s.app.lang.MoveDragDrop,bu:n!=i[0].folder&&n.acl.fileUpload&&i[0].folder.acl.fileDelete?V.aS:V.aY,onClick:function(){s.oW("successDroppable",{hH:i,hC:n,step:2}),V.bF&&1==V.bs.indexOf(V.bF.substr(1,1))%5&&V.lS(a)!=V.lS(V.ed)||V.bF&&V.bF.substr(3,1)!=V.bs.substr(9*(V.bs.indexOf(V.bF.substr(0,1))+V.bs.indexOf(V.bF.substr(2,1)))%(V.bs.length-1),1)?s.app.msgDialog("","This function is disabled in the demo version of CKFinder.<br />Please visit the <a href='http://cksource.com/ckfinder'>CKFinder web site</a> to obtain a valid license."):s.app.execCommand("moveFilesToFolder",{files:i,destination:n,callback:function(){s.oW("successDroppable",{hH:i,hC:n,step:3}),s.oW("afterDroppable",t)},errorCallback:function(){s.oW("failedDroppable",t),s.oW("afterDroppable",t)}})}})};for(var l in s.oW("beforeDropMenu",{iG:r,folder:n}),d||((d=new V.menu(s.app)).onClick=G.bind(function(e){d.hide(),e.onClick?e.onClick():e.command&&u.execCommand(e.command)},this)),d.ih(),r)r.hasOwnProperty(l)&&d.add(r[l]);d.items.length&&d.show(n.aNode(),"rtl"==u.lang.dir?2:1,0,n.aNode().$.offsetHeight),s.oW("successDroppable",{hH:i,hC:n,step:1})}catch(e){throw e=V.ba(e),s.oW("failedDroppable",t),s.oW("afterDroppable",t),e}})}else"mouseover"==n?s.app.cK.fZ||s.app.cK.iW(i.liNode()):"mouseout"==n&&s.app.cK.fZ&&s.app.cK.iW(0)}})}}),gt.prototype={iW:function(e){var t=this,n=!!e;n&&!t.fZ?(t.app.document.bH().addClass("drop_accepted"),e.addClass("drop_target")):!n&&t.fZ&&(t.app.document.bH().removeClass("drop_accepted"),t.fZ.removeClass("drop_target")),t.fZ=n?e:null},kG:function(e){this.jr=e,this.jr instanceof Y&&this.jr.focus()},vE:function(){return this.jr},kz:function(e){this.kP=e},pe:function(){return this.kP},qp:function(){return!!this.jr},nz:function(e){this.nK=e},oa:function(){return this.nK}},j.add("floatpanel",{bM:["panel"]}),me=!(he={}),je.pY=G.createClass({$:function(e,t,n,i){n.lE=!0;var o,a,r,l,s,d,c,u=t.getDocument(),f=(o=e,r=t,l=n,s=i||0,d=(a=u).iY()+"-"+r.iY()+"-"+o.gd+"-"+o.lang.dir+(o.uiColor&&"-"+o.uiColor||"")+(l.css&&"-"+l.css||"")+(s&&"-"+s||""),(c=he[d])||((c=he[d]=new je.panel(a,l,o.gd)).element=r.append(Y.kE(c.nt(o),r.getDocument())),c.element.setStyles({display:"none",position:"absolute"})),c),p=f.element,h=p.getFirst().getFirst();this.element=p,e.ia?e.ia.push(p):e.ia=[p],this._={panel:f,parentElement:t,dg:n,document:u,iframe:h,children:[],dir:e.lang.dir}},ej:{qq:function(e,t){return this._.panel.qq(e,t)},re:function(e,t){return this._.panel.re(e,t)},iv:function(e){return this._.panel.iv(e)},gf:function(e,t,n,i,o){var d=this._.panel,c=d.gf(e);this.fj(!1),me=!0;var u=this.element,s=this._.iframe,f=this._.dg,a=t.ir(u.getDocument()),p="rtl"==this._.dir,h=a.x+(i||0),m=a.y+(o||0);if(!p||1!=n&&4!=n?p||2!=n&&3!=n||(h+=t.$.offsetWidth-1):h+=t.$.offsetWidth,3!=n&&4!=n||(m+=t.$.offsetHeight-1),this._.panel._.nr=t.dS(),u.setStyles({top:m+"px",left:"-3000px",visibility:"hidden",opacity:"0",display:""}),u.getFirst().removeStyle("width"),!this._.qa){var r=L?s:new w.window(s.$.contentWindow);V.event.jP=!0,r.on("blur",function(e){if(!L||this.fj()){var t=e.data.bK(),n=t.getWindow&&t.getWindow();n&&n.equals(r)||!this.visible||this._.gF||me||(W.webkit&&W.isMobile?G.setTimeout(function(){this.hide()},500,this):this.hide())}},this),r.on("focus",function(){this._.lG=!0,this.gU(),this.fj(!0)},this),V.event.jP=!1,this._.qa=1}d.onEscape=G.bind(function(){this.onEscape&&this.onEscape()},this),G.setTimeout(function(){p&&(h-=u.$.offsetWidth),u.setStyles({left:h+"px",visibility:"",opacity:"1"});var e=u.getFirst();if(c.oz){function t(){var e=u.getFirst(),t=0,n=c.element.$;(W.gecko||W.opera)&&(n=n.parentNode);var i=n.scrollWidth;if(L&&W.version<10)for(var o=(n=n.document.body).getElementsByTagName("a"),a=0;a<o.length;a++){var r=o[a].children[1],l=r.scrollWidth+r.offsetLeft-i;0<l&&t<l&&(t=l)}i+=t,L&&W.quirks&&0<i&&(i+=(e.$.offsetWidth||0)-(e.$.clientWidth||0)),i+=4,e.setStyle("width",i+"px"),c.element.addClass("cke_frameLoaded");var s=c.element.$.scrollHeight;L&&W.quirks&&0<s&&(s+=(e.$.offsetHeight||0)-(e.$.clientHeight||0)),e.setStyle("height",s+"px"),d._.iL.element.setStyle("display","none").removeStyle("display")}d.hm?t():d.onLoad=t}else e.removeStyle("height");var n=d.element,i=n.getWindow(),o=i.hV(),a=i.eR(),r=n.$.offsetHeight,l=n.$.offsetWidth;(p?h<0:h+l>a.width+o.x)&&(h+=l*(p?1:-1)),m+r>a.height+o.y&&(m-=r),u.setStyles({top:m+"px",left:h+"px",opacity:"1"}),G.setTimeout(function(){if(f.ny&&W.gecko){var e=s.getParent();e.setAttribute("role","region"),e.setAttribute("title",f.ny),s.setAttribute("role","region"),s.setAttribute("title"," ")}L&&W.quirks?s.focus():s.$.contentWindow.focus(),L&&!W.quirks&&this.fj(!0)},0,this)},0,this),this.visible=1,this.onShow&&this.onShow.call(this),(W.ie7Compat||W.ie8&&W.ie6Compat)&&G.setTimeout(function(){this._.parentElement.$.style.cssText+=""},0,this),me=!1},hide:function(){var e=this;!e.visible||e.onHide&&!0===e.onHide.call(e)||(e.gU(),e.element.setStyle("display","none"),e.visible=0)},fj:function(e){var t=this._.panel;return null!=e&&(t.fj=e),t.fj},rA:function(e,t,n,i,o,a){this._.gF==e&&e._.panel._.nr==n.dS()||(this.gU(),e.onHide=G.bind(function(){G.setTimeout(function(){this._.lG||this.hide()},0,this)},this),this._.gF=e,this._.lG=!1,e.gf(t,n,i,o,a),(W.ie7Compat||W.ie8&&W.ie6Compat)&&setTimeout(function(){e.element.getChild(0).$.style.cssText+=""},100))},gU:function(){var e=this._.gF;e&&(delete e.onHide,delete this._.gF,e.hide())}}}),j.add("formpanel",{bM:["button"],onLoad:function(){var e;(e=V.ld.hS("formpanel","formpanel",{dc:null})).dT.push(function(){G.mH(this.bn())}),e.bh("UnloadForm",["submit","requestUnloadForm"],function(e){"submit"==e.name&&!this.data().gM||(e.result=this.oW("beforeUnloadForm",function(e,t){var n=this;if(!e)try{if(n.bn().getParent().setStyle("display","none"),n.app.layout.ea(!0),n.data().dc){var i=n.app.cS(n.data().dc);i&&i.bR(V.aS),n.data().dc=null}var o=n.tools.formNode();o&&(o.mF(),o.remove()),n.tools.releaseDomNodes(),n.oW("successUnloadForm",t)}catch(e){throw n.oW("failedUnloadForm",t),n.oW("afterUnloadForm",t),V.ba(e)}}))}),e.bh("LoadForm",["requestLoadForm"],function(e){var l=this,t=G.extend({html:null,dq:null,cC:null,cancelSubmit:1,gM:1,command:null},e.data,!0);e.result=this.oW("beforeLoadForm",t,function(e,t){if(!e){try{var n=this.bn();n.setHtml(t.html),n.getParent().removeStyle("display"),this.app.layout.ea(!0);var i=this.tools.formNode();if(i){if(t.dq)if(t.cC)for(var o in t.cC)i.on(t.cC[o],t.dq);else i.on("submit",t.dq);t.cancelSubmit&&i.on("submit",bt);var a=i.eG("input");for(o=0;o<a.count();o++)if("cancel"==a.getItem(o).getAttribute("name")){a.getItem(o).on("click",function(e){l.oW("requestUnloadForm"),e.removeListener()});break}t.cancelSubmit&&i.on("submit",bt)}if(this.data().gM=t.gM,t.command){var r=this.app.cS(t.command);r&&r.bR(V.eV),this.data().dc=t.command}this.oW("successLoadForm",t)}catch(e){throw this.oW("failedLoadForm",t),V.ba(e)}this.oW("afterLoadForm",t)}})}),e.bh("FilesViewSettingsForm",["requestFilesViewSettingsForm"],function(e){e.result=this.oW("beforeFilesViewSettingsForm",{},function(e,t){if(!e)try{if("settings"==this.data().dc)this.oW("requestUnloadForm",function(){this.oW("successFilesViewSettingsForm",t),this.oW("afterFilesViewSettingsForm",t)});else{this.data().dc&&this.oW("requestUnloadForm");var n=this.app.ld["filesview.filesview"].data(),i=function(e,t,n,i){var o='checked="checked"',a="",r="",l="",s="",d="",c="",u="",f="",p="";"list"==t?a=o:r=o;n.filename&&(l=o);n.date&&(s=o);n.filesize&&(d=o);"date"==i?u=o:"size"==i?f=o:"extension"==i?p=o:c=o;var h=a?' disabled="true"':"";return'<form id="files_settings" role="region" aria-controls="files_view" action="#" method="POST"><h2 role="heading">'+e.SetTitle+'</h2><table role="presentation"><tr><td><dl role="group" aria-labelledby="files_settings_type"><dt id="files_settings_type">'+e.SetView+'</dt><dd><input type="radio" name="view_type" value="thumbnails" '+r+' id="fs_type_thumbnails" /> <label for="fs_type_thumbnails">'+e.SetViewThumb+'</label></dd><dd><input type="radio" name="view_type" value="list" '+a+' id="fs_type_details" /> <label for="fs_type_details">'+e.SetViewList+'</label></dd></dl></td><td><dl role="group" aria-labelledby="files_settings_display"><dt id="files_settings_display">'+e.SetDisplay+'</dt><dd><input type="checkbox" name="display_filename" value="1" '+l+h+' id="fs_display_filename" /> <label for="fs_display_filename">'+e.SetDisplayName+'</label></dd><dd><input type="checkbox" name="display_date" value="1" '+s+' id="fs_display_date" /> <label for="fs_display_date">'+e.SetDisplayDate+'</label></dd><dd><input type="checkbox" name="display_filesize" value="1" '+d+' id="fs_display_filesize" /> <label for="fs_display_filesize">'+e.SetDisplaySize+'</label></dd></dl></td><td><dl role="group" aria-labelledby="files_settings_sorting"><dt id="files_settings_sorting">'+e.SetSort+'</dt><dd><input type="radio" name="sortby" value="filename" '+c+' id="fs_sortby_filename" /> <label for="fs_sortby_filename">'+e.SetSortName+'</label></dd><dd><input type="radio" name="sortby" value="date" '+u+' id="fs_sortby_date" /> <label for="fs_sortby_date">'+e.SetSortDate+'</label></dd><dd><input type="radio" name="sortby" value="size" '+f+' id="fs_sortby_size" /> <label for="fs_sortby_size">'+e.SetSortSize+'</label></dd><dd><input type="radio" name="sortby" value="extension" '+p+' id="fs_sortby_extension" /> <label for="fs_sortby_extension">'+e.SetSortExtension+'</label></dd></dl></td></tr></table><div class="buttons_wrapper"><div class="buttons"><input type="submit" value="'+e.CloseBtn+'" /></div></div></form>'}(this.app.lang,n.dA,n.display,n.cN);this.oW("requestLoadForm",{html:i,dq:G.bind(vt,this),cC:["click","submit"],command:"settings"},function(){this.eh.addClass("show_border"),this.app.cg.resizeFormPanel(),this.oW("successFilesViewSettingsForm",t)})}}catch(e){throw this.oW("failedFilesViewSettingsForm",t),this.oW("afterFilesViewSettingsForm",t),V.ba(e)}})}),e.tools={formNode:function(){var e,t,n,i,o=this;return!o.iP&&o.ib.bn().$.childNodes.length&&(o.iP=(t=o.ib.bn().$.childNodes,n="form",(e=function(e,t){for(var n in e)if(void 0!==t(e[n]))return e[n]}(t,function(e){if(e.tagName&&e.tagName.toLowerCase()==n&&!i--)return e}))?new Y(e):null)),o.iP},releaseDomNodes:function(){delete this.iP}}},gr:function(t){var n=this;t.on("themeSpace",function(e){"mainTop"==e.data.space&&(e.data.html+='<div id="panel_view" class="view" role="region" aria-live="polite" style="display: none;"><div id="panel_widget" class="panel_widget widget" tabindex="-1"></div></div>')}),t.on("uiReady",function(){var e=t.document.getById("panel_view").getChild(0);V.ld.bz(t,"formpanel",n,e)}),t.bD("settings",{exec:function(e){e.oW("requestFilesViewSettingsForm",null,function(){e.cS("settings").bu==V.eV&&setTimeout(function(){e.ld["formpanel.formpanel"].tools.formNode().eG("input").getItem(0).focus()},0)})}}),t.bD("refresh",{exec:function(e){var t=e.aV;t&&e.oW("requestShowFolderFiles",{folder:t,lookup:e.ld["filesview.filesview"].data().lookup},function(){setTimeout(function(){e.ld["filesview.filesview"].bn().focus()},0)})}}),t.bY.add("Settings",V.UI_BUTTON,{label:t.lang.Settings,command:"settings"}),t.bY.add("Refresh",V.UI_BUTTON,{label:t.lang.Refresh,command:"refresh"}),t.cS("refresh").bR(V.aY)}}),j.add("keystrokes",{eK:function(e){e.dJ=new V.dJ(e),e.oX={}},bz:function(e){for(var t=e.config.keystrokes,n=e.config.gN,i=e.dJ.keystrokes,o=e.dJ.gN,a=0;a<t.length;a++)i[t[a][0]]=t[a][1];for(a=0;a<n.length;a++)o[n[a]]=1}}),V.dJ=function(e){return e.dJ?e.dJ:(this.keystrokes={},this.gN={},this._={app:e},this)},V.dJ.prototype={oA:function(e){e.on("keydown",yt,this),(W.opera||W.gecko&&W.mac)&&e.on("keypress",wt,this)}},U.gN=[],U.keystrokes=[[V.eJ+119,"foldertreeFocus"],[V.eJ+120,"filesviewFocus"],[V.eJ+121,"hW"],[V.eJ+85,"upload"],[V.dy+121,"bj"],[V.bP+V.dy+121,"bj"]],j.add("menu",{eK:function(e){for(var t=e.config.nj.split(","),n={},i=0;i<t.length;i++)n[t[i]]=i+1;e._.iA=n,e._.iG={}},bM:["floatpanel"]}),G.extend(V.application.prototype,{dZ:function(e,t){this._.iA[e]=t||100},gp:function(e,t){this._.iA[t.group]&&(this._.iG[e]=new V.iD(this,e,t))},eU:function(e){for(var t in e)this.gp(t,e[t])},mh:function(e){return this._.iG[e]}}),V.menu=G.createClass({$:function(e,t){this.id="cke_"+G.getNextNumber(),this.app=e,this.items=[],this._.hx=t||1},_:{jK:function(e){var t=this,n=t._.oM,i=t.items[e],o=i.hQ&&i.hQ();if(o){for(var a in n?n.ih():((n=t._.oM=new V.menu(t.app,t._.hx+1)).parent=t,n.onClick=G.bind(t.onClick,t)),o)n.add(t.app.mh(a));var r=t._.panel.iv(t.id).element.getDocument().getById(t.id+String(e));n.show(r,2)}else t._.panel.gU()}},ej:{add:function(e){e.fE||(e.fE=this.items.length),this.items.push(e)},ih:function(){this.items=[]},show:function(e,t,n,i){var o=this.items,a=this.app,r=this._.panel,l=this._.element;if(!r){(r=this._.panel=new je.pY(this.app,this.app.document.bH(),{css:[],hx:this._.hx-1,className:a.iy+" cke_contextmenu"},this._.hx)).onEscape=G.bind(function(){this.onEscape&&this.onEscape(),this.hide()},this),r.onHide=G.bind(function(){this.onHide&&this.onHide()},this);var s=r.qq(this.id);s.oz=!0;var d=s.jQ;d[40]="next",d[9]="next",d[38]="prev",d[V.dy+9]="prev",d[32]="click",d[39]="click",(l=this._.element=s.element).addClass(a.iy);var c=l.getDocument();c.bH().setStyle("overflow","hidden"),c.eG("html").getItem(0).setStyle("overflow","hidden"),this._.qz=G.addFunction(function(e){clearTimeout(this._.jI),this._.jI=G.setTimeout(this._.jK,a.config.ob,this,[e])},this),this._.qm=G.addFunction(function(e){clearTimeout(this._.jI)},this),this._.ql=G.addFunction(function(e){var t=this,n=t.items[e];n.bu!=V.aY?n.hQ?t._.jK(e):t.onClick&&t.onClick(n):t.hide()},this)}o.sort(function(e,t){return e.group<t.group?-1:e.group>t.group?1:e.fE<t.fE?-1:e.fE>t.fE?1:0});for(var u=['<div class="cke_menu">'],f=o.length,p=f&&o[0].group,h=0;h<f;h++){var m=o[h];p!=m.group&&(u.push('<div class="cke_menuseparator"></div>'),p=m.group),m.er(this,h,u)}u.push("</div>"),l.setHtml(u.join("")),this.parent?this.parent._.panel.rA(r,this.id,e,t,n,i):r.gf(this.id,e,t,n,i),a.oW("menuShow",[r])},hide:function(){this._.panel&&this._.panel.hide()}}}),V.iD=G.createClass({$:function(e,t,n){var i=this;G.extend(i,n,{fE:0,className:"cke_button_"+t}),i.group=e._.iA[i.group],i.app=e,i.name=t},ej:{er:function(e,t,n){var i=this,o=e.id+String(t),a=void 0===i.bu?V.aS:i.bu,r=" cke_"+(a==V.eV?"on":a==V.aY?"disabled":"off"),l=i.label;a==V.aY&&(l=i.app.lang.common.unavailable.replace("%1",l)),i.className&&(r+=" "+i.className);var s=i.hQ;n.push('<span class="cke_menuitem"><a id="',o,'" class="',r,'" href="javascript:void(\'',(i.label||"").replace("'",""),'\')" title="',i.label,'" tabindex="-1"_cke_focus=1 hidefocus="true" role="menuitem"'+(s?'aria-haspopup="true"':"")+(a==V.aY?'aria-disabled="true"':"")+(a==V.eV?'aria-pressed="true"':"")),(W.opera||W.gecko&&W.mac)&&n.push(' onkeypress="return false;"'),W.gecko&&n.push(' onblur="this.style.cssText = this.style.cssText;"');var d=-16*(i.rD||0);n.push(' onmouseover="CKFinder.tools.callFunction(',e._.qz,",",t,');" onmouseout="CKFinder.tools.callFunction(',e._.qm,",",t,');" onclick="CKFinder.tools.callFunction(',e._.ql,",",t,'); return false;"><span class="cke_icon_wrapper"><span class="cke_icon"'+(i.icon?' style="background-image:url('+V.getUrl(i.icon)+");background-position:0 "+d+'px;"':"")+'></span></span><span class="cke_label">'),i.hQ&&n.push('<span class="cke_menuarrow"></span>'),n.push(l,"</span></a></span>")}}}),U.ob=400,U.nj="",j.add("mobile",{bM:["foldertree","filesview"],bz:function(e){var t="ontouchstart"in window;(W.isMobile||t)&&(e.config.showContextMenuArrow=!0,W.isMobile&&e.on("uiReady",function(){(W.webkit&&W.version<534||W.opera)&&(_t(e.layout.pS()),_t(e.layout.pn())),e.hs=function(e,t,n,i){var o=window.prompt(t,n);null!==o&&i(o)},e.msgDialog=function(e,t,n){window.alert(t),n&&n()},e.fe=function(e,t,n){window.confirm(t)&&n()}},null,null,20))}}),j.add("panel",{eK:function(e){e.bY.kd(V.UI_PANEL,je.panel.dq)}}),V.UI_PANEL=2,je.panel=function(e,t,n){var i=this;t&&G.extend(i,t),G.extend(i,{className:""});var o=V.basePath;G.extend(i.css,[o+"skins/"+n+"/uipanel.css"]),i.id=G.getNextNumber(),i.document=e,i._={iq:{}}},je.panel.dq={create:function(e){return new je.panel(e)}},je.panel.prototype={nt:function(e){var t=[];return this.er(e,t),t.join("")},er:function(e,t){var n=this,i="cke_"+n.id;if(t.push('<div class="',e.iy,' cke_compatibility" lang="',e.langCode,'" role="presentation" style="display:none;z-index:'+(e.config.baseFloatZIndex+1)+'"><div id="',i,'"',' dir="',e.lang.dir,'"',' role="presentation" class="cke_panel cke_',e.lang.dir),n.className&&t.push(" ",n.className),t.push('">'),n.lE||n.css.length){t.push('<iframe id="',i,'_frame" frameborder="0" src="');var o="document.open();"+(W.isCustomDomain()?'document.domain="'+window.document.domain+'";':"")+"document.close();";t.push(L?"javascript:void(function(){"+encodeURIComponent(o)+"}())":""),t.push('"></iframe>')}return t.push("</div></div>"),i},oU:function(){var e=this._.rE;if(!e){if(this.lE||this.css.length){var t=this.document.getById("cke_"+this.id+"_frame"),n=t.getParent(),i=n.getAttribute("dir"),o=n.getParent().getAttribute("class").split(" ")[0],a=n.getParent().getAttribute("lang"),r=t.getFrameDocument();r.$.open(),W.isCustomDomain()&&(r.$.domain=document.domain);var l=G.addFunction(G.bind(function(e){this.hm=!0,this.onLoad&&this.onLoad()},this)),s=r.getWindow();s.$.CKFinder=CKFinder;var d=W.cssClass.replace(/browser_quirks|browser_iequirks/g,"");r.$.write("<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/TR/html4/strict.dtd'><html dir=\""+i+'" class="'+o+'_container" lang="'+a+'"><head><style>.'+o+'_container{visibility:hidden}</style></head><body class="cke_'+i+" cke_panel_frame "+d+' cke_compatibility" style="margin:0;padding:0" onload="var ckfinder = window.CKFinder || window.parent.CKFinder; ckfinder && ckfinder.tools.callFunction('+l+');"></body><link type="text/css" rel=stylesheet href="'+this.css.join('"><link type="text/css" rel="stylesheet" href="')+'"></html>'),r.$.close(),s.$.CKFinder=CKFinder,r.on("keydown",function(e){var t=e.data.db();this._.onKeyDown&&!1===this._.onKeyDown(t)?e.data.preventDefault():27==t&&this.onEscape&&this.onEscape()},this),e=r.bH()}else e=this.document.getById("cke_"+this.id);this._.rE=e}return e},qq:function(e,t){return t=this._.iq[e]=t||new je.panel.block(this.oU()),this._.iL||this.gf(e),t},iv:function(e){return this._.iq[e]},gf:function(e){var t=this._.iq[e],n=this._.iL;return n&&n.hide(),(this._.iL=t)._.cQ=-1,this._.onKeyDown=t.onKeyDown&&G.bind(t.onKeyDown,t),t.show(),t}},je.panel.block=G.createClass({$:function(e){this.element=e.append(e.getDocument().createElement("div",{attributes:{class:"cke_panel_block",role:"presentation"},gS:{display:"none"}})),this.jQ={},this._.cQ=-1,this.element.hX()},_:{},ej:{show:function(){this.element.setStyle("display","")},hide:function(){this.onHide&&!0===this.onHide.call(this)||this.element.setStyle("display","none")},onKeyDown:function(e){var t=this;switch(t.jQ[e]){case"next":for(var n,i=t._.cQ,o=t.element.eG("a");n=o.getItem(++i);)if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){t._.cQ=i,n.focus();break}return!1;case"prev":for(i=t._.cQ,o=t.element.eG("a");0<i&&(n=o.getItem(--i));)if(n.getAttribute("_cke_focus")&&n.$.offsetWidth){t._.cQ=i,n.focus();break}return!1;case"click":return(n=0<=(i=t._.cQ)&&t.element.eG("a").getItem(i))&&(n.$.click?n.$.click():n.$.onclick()),!1}return!0}}}),j.add("resize",{bz:function(r){var l=r.config;l.nB&&r.on("uiReady",function(){var i,o,t=null;function n(e){r.document.bH().addClass("during_sidebar_resize");var t=e.data.$.screenX-i.x,n=o.width+t*("rtl"==r.lang.dir?-1:1);r.nJ(Math.max(l.nN,Math.min(n,l.nC)))}function a(e){r.document.bH().removeClass("during_sidebar_resize"),V.document.removeListener("mousemove",n),V.document.removeListener("mouseup",a),r.document&&(r.document.removeListener("mousemove",n),r.document.removeListener("mouseup",a))}r.layout.dV().on("mousedown",function(e){t=t||r.layout.dV(),e.data.bK().$==t.$&&(o={width:t.$.offsetWidth||0},i={x:e.data.$.screenX},V.document.on("mousemove",n),V.document.on("mouseup",a),r.document&&(r.document.on("mousemove",n),r.document.on("mouseup",a)))})})}}),U.nN=120,U.nC=500,U.nB=!0,j.add("status",{bM:["filesview"],onLoad:function(){var e;(e=V.ld.hS("status","status")).bh("ShowFileInfo",["requestShowFileInfo"],function(e){e.result=this.oW("beforeShowFileInfo",e.data,function(e,t){var n=this;if(!e){var i,o,a=t.file;try{var r=a?(i=a,o=n.app.lang,"<p>"+G.escapeHtml(i.name)+" ("+G.formatSize(i.size,o,!0)+", "+i.dateF+")</p>"):"";n.bn().setHtml(r),n.oW("successShowFileInfo",t)}catch(e){throw n.oW("failedShowFileInfo",t),V.ba(e)}n.oW("afterShowFileInfo",t)}})}),e.bh("ShowFolderInfo",["requestShowFolderInfo"],function(o){o.result=this.oW("beforeShowFolderInfo",o.data,function(e,t){var n=this;if(!e){t.folder;try{var i=function(e,t){var n;n=0===e?t.FilesCountEmpty:1==e?t.FilesCountOne:t.FilesCountMany.replace("%1",e);return"<p>"+G.htmlEncode(n)+"</p>"}(o.data.ib.data().shownFiles.length,n.app.lang);n.bn().setHtml(i),n.oW("successShowFolderInfo",t)}catch(e){throw n.oW("failedShowFolderInfo",t),V.ba(e)}n.oW("afterShowFolderInfo",t)}})})},gr:function(t){var o=this;t.on("themeSpace",function(e){"mainBottom"==e.data.space&&(e.data.html+='<div id="status_view" class="view" role="status"></div>')}),t.on("uiReady",function(){var e=t.document.getById("status_view"),n=t.ld["filesview.filesview"],i=V.ld.bz(t,"status",o,e,{parent:n});n.app==t&&(n.on("successSelectFile",function(e){i.oW("requestShowFileInfo",e.data)}),n.on("successRenderFiles",function(e){var t={folder:e.data.folder,ib:n};i.oW("requestShowFolderInfo",t)})),t.on("afterCommandExecDefered",function(e){if("RemoveFile"==e.data.name){var t={folder:e.data.folder,ib:n};i.oW("requestShowFolderInfo",t)}}),i.on("afterShowFileInfo",function(){this.bn().getText()||i.oW("requestShowFolderInfo",{ib:n,folder:n.data().folder})})})}}),function(){function v(){this.fk=[],this.pZ=!1}v.prototype.focus=function(){for(var e,t=0;e=this.fk[t++];)for(var n,i=0;n=e.items[i++];)if(n.focus)return void n.focus()};var e={hW:{iH:{qt:1,source:1},exec:function(e){e.dh&&(e.dh.pZ=!0,L?setTimeout(function(){e.dh.focus()},100):e.dh.focus())}}};j.add("toolbar",{bM:["formpanel"],bz:function(m){function g(e,t){switch(t){case"rtl"==m.lang.dir?37:39:for(;(e=e.next||e.toolbar.next&&e.toolbar.next.items[0])&&!e.focus;);return e?e.focus():m.dh.focus(),!1;case"rtl"==m.lang.dir?39:37:for(;(e=e.previous||e.toolbar.previous&&e.toolbar.previous.items[e.toolbar.previous.items.length-1])&&!e.focus;);if(e)e.focus();else{var n=m.dh.fk[m.dh.fk.length-1].items;n[n.length-1].focus()}return!1;case 27:return m.focus(),!1;case 13:case 32:return e.lc(),!1}return!0}m.on("themeSpace",function(e){if("mainTop"==e.data.space){m.dh=new v;var t,n="cke_"+G.getNextNumber(),i=['<div id="toolbar_view" class="view"><div class="cke_toolbox cke_compatibility" role="toolbar" aria-labelledby="',n,'"'];i.push(">"),i.push('<span id="',n,'" class="cke_voice_label">',m.lang.toolbar,"</span>");for(var o=m.dh.fk,a=m.config.toolbar instanceof Array?m.config.toolbar:m.config["toolbar_"+m.config.toolbar],r=0;r<a.length;r++){var l=a[r];if(l){var s="cke_"+G.getNextNumber(),d={id:s,items:[]};if(t&&(i.push("</div>"),t=0),"/"!==l){i.push('<span id="',s,'" class="cke_toolbar" role="presentation"><span class="cke_toolbar_start"></span>');var c=o.push(d)-1;0<c&&(d.previous=o[c-1],d.previous.next=d);for(var u=0;u<l.length;u++){var f,p=l[u];if(f="-"==p?je.separator:m.bY.create(p)){f.canGroup?t||(i.push('<span class="cke_toolgroup">'),t=1):t&&(i.push("</span>"),t=0);var h=f.er(m,i);0<(c=d.items.push(h)-1)&&(h.previous=d.items[c-1],h.previous.next=h),h.toolbar=d,h.onkey=g}}t&&(i.push("</span>"),t=0),i.push('<span class="cke_toolbar_end"></span></span>')}else i.push('<div class="cke_break"></div>')}}m.search&&m.search.er(m,i),i.push("</div></div>"),e.data.html+=i.join("")}}),m.bD("hW",e.hW)}})}(),je.separator={er:function(e,t){return t.push('<span class="cke_separator"></span>'),{}}},U.toolbar_Basic=[["Upload","Refresh"]],U.toolbar_Full=[["Upload","Refresh","Settings","Maximize","Help"]],U.toolbar="Full",j.add("tools",{eK:function(e){this.app=e},addTool:function(e,t){var n="tool_"+G.getNextNumber();return e=t?'<div id="'+n+'" class="view tool_panel" tabindex="0" style="display: none;">'+e+"</div>":'<div id="'+n+'" class="tool" style="display: none;">'+e+"</div>",this.app.layout.dV().getChild(0).appendHtml(e),n},addToolPanel:function(e){e=e||"";var t=this.addTool(e,1),n=this.app.layout.dV().getChild(0).dB();return G.mH(n),t},hideTool:function(e){this.app.document.getById(e).setStyle("display","none"),this.app.layout.ea(!0)},showTool:function(e){this.app.document.getById(e).removeStyle("display"),this.app.layout.ea(!0)},removeTool:function(e){this.hideTool(e),this.app.document.getById(e).remove()}}),j.add("uploadform",{bM:["formpanel","button","csrftokenmanager"],readOnly:!1,md:function(){if(!W.webkit)return!0;var e=document.createElement("input");return e.setAttribute("type","file"),!1===e.disabled},onLoad:function(){this.md()&&function(){var e=V.ld.bX["formpanel.formpanel"];if(!e)return;e.bh("UploadFileForm",["requestUploadFileForm"],function(){var e=this.app.aV,f=this;this.oW("beforeUploadFileForm",{folder:e,step:1},function(e,t){if(!(e||0<V.bF.length&&-1!="RMRHY5Q4S,GGYXTSBLA,QS8F4ZFUJ".indexOf(V.bF.substr(0,9)))){var c=this.data(),u=t.folder,n=0;if(u||(this.app.msgDialog("",this.app.lang.UploadNoFolder),n=1),n||u.acl.fileUpload||(this.app.msgDialog("",this.app.lang.UploadNoPerms),n=1),n)return this.oW("failedUploadFileForm"),void this.oW("afterUploadFileForm");this.oW("beforeUploadFileForm",{folder:u,step:2},function(e,t){try{if("upload"==c.dc)this.oW("requestUnloadForm",function(){this.app.cS("upload").bR(V.aS),this.oW("successUploadFileForm",t),this.oW("afterUploadFileForm",t)});else{c.dc&&this.oW("requestUnloadForm");var n=this.tools.qL(),i=this.app.connector.composeUrl("FileUpload",{},u.type,u),o=(s=this.app,d=n.$.id,'<form enctype="multipart/form-data" id="upload_form" role="region" action="'+i+'" method="POST" target="'+d+'"><h2 role="heading">'+s.lang.UploadTitle+'</h2><p><input type="file" name="upload" /></p><div class="buttons_wrapper"><div class="buttons"><input type="submit" value="'+s.lang.UploadBtn+'" /><input type="hidden" name="ckCsrfToken" value="'+V.getCsrfToken()+'" /><input type="button" name="cancel" value="'+s.lang.UploadBtnCancel+'" /></div></div></form>'),a=this;function r(e){if(e.data.folder&&e.data.folder.acl.fileUpload){var t=f.tools.qO();f.oW("requestUnloadForm"),f.oW("requestUploadFileForm",function(){var e=f.tools.qO();t.kB(e),e.remove(),delete f.tools.jj})}}this.oW("requestLoadForm",{html:o,dq:G.bind(function(e){return function(e,o){var a=this,t=(a.data(),1),n=this.tools.qO(),i=n&&n.$.value;if(!i.length)return e.data.preventDefault(!0),this.oW("failedUploadFileForm"),this.oW("afterUploadFileForm"),!1;var r=i.match(/\.([^\.]+)\s*$/)[1];if(r&&o.getResourceType().isExtensionAllowed(r)?t=0:(e.data.preventDefault(),a.app.msgDialog("",a.app.lang.UploadExtIncorrect)),t)return e.data.preventDefault(!0),this.oW("failedUploadFileForm"),this.oW("afterUploadFileForm"),!1;var l=a.app.document.getWindow().$;return l.OnUploadCompleted=function(e,t){var n={step:3,filename:e,folder:o};if(t&&!e){a.app.msgDialog("",t);var i=a.tools.qB();i.setStyle("display","none"),i.getChild(1).setText(""),i.getChild(2).setText(""),a.oW("failedUploadFileForm",n)}else t&&a.app.msgDialog("",t),a.app.aV==o&&a.app.oW("requestShowFolderFiles",{folder:o,mw:e}),a.oW("requestUnloadForm"),a.oW("successUploadFileForm",n);a.oW("afterUploadFileForm",n);try{delete l.OnUploadCompleted}catch(e){l.OnUploadCompleted=void 0}},V.log("[UPLOADFORM] Starting IFRAME file upload."),this.oW("successUploadFileForm",{step:2}),!0}.call(a,e,u)}),cC:["submit"],cancelSubmit:0,gM:0,command:"upload"},function(){this.eh.addClass("show_border"),t.step=1,this.oW("successUploadFileForm",t)});var l=this.app.ld["filesview.filesview"];l.on("successShowFolderFiles",r),this.on("requestUnloadForm",function(e){e.removeListener(),l.removeListener("successShowFolderFiles",r)})}}catch(e){throw this.oW("failedUploadFileForm",t),this.oW("afterUploadFileForm",t),V.ba(e)}var s,d})}})}),e.tools.releaseDomNodes=G.override(e.tools.releaseDomNodes,function(t){return function(){var e=this;t.apply(e,arguments),delete e.jj,delete e.jc,void 0!==e.gq&&(e.gq.remove(),delete e.gq)}}),e.tools.qB=function(){return void 0===this.jc&&(this.jc=this.ib.bn().getChild([0,2])),this.jc},e.tools.qO=function(){return void 0===this.jj&&(this.jj=this.ib.bn().getChild([0,1,0])),this.jj},e.tools.qL=function(){if(void 0===this.gq){var e=W.isCustomDomain(),t="ckf_"+G.getNextNumber(),n='<iframe id="'+t+'" name="'+t+'" style="display:none" frameBorder="0"'+(e?" src=\"javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())\"":"")+' tabIndex="-1" allowTransparency="true"></iframe>',i=this.ib.app.document.bH();i.appendHtml(n),this.gq=i.dB()}return this.gq}}()},gr:function(i){this.md()&&(i.bD("upload",{exec:function(t){t.oW("requestUploadFileForm",null,function(){var i=t.ld["formpanel.formpanel"].tools.formNode(),e=t.cg.inPopup&&L&&8<W.version;e&&i&&i.submit(),t.cS("upload").bu==V.eV&&setTimeout(function(){if(i){var n=i.eG("input").getItem(0);e||n.on("change",function(){if(n.getValue())for(var e=0;e<i.$.elements.length;e++){var t=i.$.elements[e];"INPUT"==t.nodeName&&"submit"==t.type&&t.click()}}),n.$.click?n.$.click():n.focus()}},0)})}}),i.bY.add("Upload",V.UI_BUTTON,{label:i.lang.Upload,command:"upload"}),i.on("appReady",function(e){i.ld["filesview.filesview"].on("successShowFolderFiles",function(){var e=this.tools.currentFolder(),t=this.app.cS("upload");if(e&&e.acl.fileUpload)t.bu==V.aY&&t.bR(V.aS);else{var n=i.ld["formpanel.formpanel"];"upload"==n.data().dc&&n.oW("requestUnloadForm"),t.bR(V.aY)}})}))}}),function(){"use strict";function l(){return(new Date).getTime()}var d,s,c,o,a,u,t,r,f,n,p,h,m,g,v,b,y,w,_,F,e,i,k,C,x,E,S,N,D,T,R,$=/\.([^\.]+)\s*$/,W=/^(jpg|jpeg|gif|png|bmp)$/i,L=/\|/,I=/(\{\{([a-z_]+)\}\})/g,O=!1,U="ckf_plugin_html5upload_"+l(),A=U+"_fallbackAsyncArrayTraverse",P=U+"_fallbackShouldFallback",B=U+"_fallbackOnFileBlobReady",M=U+"_fallbackOnXMLHttpRequestReady",q=U+"_fallbackGetCsrfToken",j="CKFinder._['"+U+"']['{{application_name}}']",H="var _files = ((('undefined' === typeof files) ? (this.files || (event.dataTransfer && event.dataTransfer.files)) : files) || []);setTimeout(function () {"+j+"['"+A+"'](_files, function (file, index, files) {var formData = new FormData(),uploadBlob,xhr = new XMLHttpRequest();if (file && "+j+"['"+P+"']()) {formData.append('upload', file);formData.append('ckCsrfToken', "+j+"['"+q+"']());uploadBlob = "+j+"['"+B+"'](file, formData);"+j+"['"+M+"'](file, uploadBlob, xhr, xhr.send.bind(xhr, formData), xhr.abort.bind(xhr));} else {return false;}});}, 500);",z='<div id="ckf_upload_form" ondrop="'+H+'"><div class="ckf_upload_info" id="ckf_globalUploads"><div class="ckf_progress_wrapper"><div class="ckf_progress_info"><span></span><span></span><div class="ckf_progress_bar_container"><div></div></div><span class="ckf_status"></span><span class="ckf_speed"></span></div></div><div class="ckf_uploadButtons"><input type="file" {{input_multiple}} id="ckf_fileInput" onchange="'+H+'"><a class="cke_dialog_ui_button" href="javascript:void(0);"><span class="cke_dialog_ui_button" id="ckf_addFiles">{{lang_upload_add_files}}</span></a><br><a class="cke_dialog_ui_button cke_dialog_ui_button_ok" href="javascript:void(0);" id="ckf_cancelUpload"><span class="cke_dialog_ui_button">{{lang_close_button}}</span></a></div></div></div>';function K(i,e){if(k()&&!e.config.readOnly){var t=new d(e),o=new b(e),a=new y(e,o),r=new u(i,e,o,a),l=new c(i,e,o,a,r),n=new h(i,e,o,a,r),s=new g(e,o,a);r.tS(window,U,A,P,B,M,q),a.tJ(e.config.maxSimultaneousUploads),a.uI=function(e){r.ux=e},s.ns(n),o.ns(s),a.ns(t),a.ns(s),a.ns(o),x(i,e,"filesview.filesview",function(e,t,n){E(i,e,l,r,o,a,s,n)}),x(i,e,"formpanel.formpanel",function(e,t,n){S(i,e,l,r,o,a,s,n)}),setInterval(function(){a.sX()&&a.tx()},1e3)}}e=Object.hasOwnProperty("create")?Object.create:function(e){return O=!0,e},F=function(i,o,e){var a,r=0;e=e||null,o=o.bind(e),(a=function(){for(var e,t=0,n=l();;){if(!(e=i.item?i.item(r):i[r])||!1===o(e,r,i))return;if(r+=1,10<=(t+=1)&&10<l()-n)return setTimeout(a,10)}})()},i=function(n){return function(e){var t;for(t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}},(o=function(){this.uU=[]}).prototype.mD=function(e){var t=this;if(!(e instanceof o))throw new Error("Invalid argument: expected EventDispatcher.");e.sy().forEach(function(e){t.ns(e)})},o.mixin=i(o.prototype),o.prototype.ns=function(e){if(!(e instanceof a))throw new Error("Invalid argument: expected EventSubscriber.");if(this.sL(e))throw new Error("Logic error: same EventSubscriber is added twice to the EventDispatcher");this.uU.push(e)},o.prototype.dispatch=function(n,i){this.uU.forEach(function(e){var t=e.tc();t.hasOwnProperty(n)&&e[t[n]].apply(e,i)})},o.prototype.sy=function(t){return t?this.uU.filter(function(e){return e.sV(t)}):this.uU.slice(0)},o.prototype.sL=function(e){return-1!==this.uU.indexOf(e)},o.prototype.removeSubscriber=function(e){var t=this.uU.indexOf(e);if(!(e instanceof a))throw new Error("Invalid argument: expected EventSubscriber.");if(-1===t)throw new Error("Logic error: this EventSubscriber is not registered");this.uU.splice(t,1)},(a=function(){}).prototype.sV=function(e){return this.tc().hasOwnProperty(e)},a.prototype.tc=function(){throw new Error("This method needs to be overriden in child class.")},((d=function(){a.call(this)}).prototype=e(a.prototype)).tc=function(){var e={};return e[y.qM]="tF",e},d.prototype.tF=function(e,t){var n=t.targetFolder,i=e.connector.composeUrl("FileUpload",{response_type:"txt"},n.type,n);t.bT.open("POST",i)},(r=function(e,t,n,i){var o=this;a.call(o),o.ckFinder=e,o.application=t,o.ty=n,o.ub=i}).prototype=e(a.prototype),(p=function(e){this.tw(e)}).mixin=i(p.prototype),p.prototype.tj=function(){if(!this.so)throw new Error("Form panel widget is not set.");return this.so},p.prototype.sX=function(){return!!this.so},p.prototype.uV=function(e){},p.prototype.tC=function(){},p.prototype.tw=function(e){var t=this;!t.so&&e?t.uV(e):t.so&&e?(t.tC(),t.uV(e)):t.so&&!e&&t.tC(),t.so=e},(c=function(e,t,n,i){r.call(this,e,t,n,i),p.call(this)}).prototype=e(r.prototype),(c.prototype=p.mixin(c.prototype)).mE=function(e){var t=this,n=e.layout.pn(),i=n.getDocument(),o=t.sS.bind(t),a=t.ss.bind(t),r=t.rs.bind(t);i.on("drop",r),i.on("dragover",a),n.on("dragover",o),t.domElementListeners||(t.domElementListeners=[]),t.domElementListeners.push({evt:"drop",fO:r,bi:i},{evt:"dragover",fO:a,bi:i},{evt:"dragover",fO:o,bi:n})},c.prototype.ss=function(e){var t=e.data,n=t.$.dataTransfer;if(n){n.dropEffect="none";try{n.effectAllowed="none"}catch(e){}this.ckFinder.env.webkit&&t.preventDefault()}},c.prototype.rs=function(e){var t=e.data.$.dataTransfer;t&&t.files&&0<t.files.length&&(this.ub.uG(t.files),e.data.preventDefault())},c.prototype.uV=function(e){var t=this,n=e.bn().getDocument(),i=t.sS.bind(t),o=n.getById("ckf_upload_form");t.domElementListeners||(t.domElementListeners=[]),0<t.domElementListeners.length&&t.tC(),t.mE(t.application),o.on("dragover",i),t.domElementListeners.push({evt:"dragover",fO:i,bi:o})},c.prototype.sS=function(e){var t=e.data,n=t.$.dataTransfer;n&&(n.files&&n.files.length||n.types&&(n.types.contains&&n.types.contains("Files")||n.types.indexOf&&-1!==n.types.indexOf("Files"))?(n.dropEffect="copy",t.stopPropagation()):n.dropEffect="none",t.preventDefault())},c.prototype.tC=function(){var e,t;for(e=0;e<this.domElementListeners.length;e+=1)(t=this.domElementListeners[e]).bi.removeListener(t.evt,t.fO);delete this.domElementListeners},((u=function(e,t,n,i){r.call(this,e,t,n,i),this.pJ={},this.ux=!0}).prototype=e(r.prototype)).lT=function(e){var t,n;for(t in this.pJ)if(this.pJ.hasOwnProperty(t))for(n=0;n<e.length;n+=1)e[n]===this.pJ[t]&&delete this.pJ[t]},u.prototype.ti=function(e,t){if(this.ux)return new m(e,new n(t))},u.prototype.uK=function(e,t,n,i,o){var a,r=this;r.ux&&(r.ub.sX()?((a=new s(r.application,r.application.aV,t,i,o)).ns(r.ty),a.nv(n),t.ns(a),--r.ub.expectedFiles,r.ub.tL(r.application,a)):o())},u.prototype.tS=function(e,t,n,i,o,a,r){var l=this,s={};s[n]=F,s[i]=l.shouldFallback.bind(l),s[o]=l.ti.bind(l),s[a]=l.uK.bind(l),s[r]=V.getCsrfToken,e.CKFinder.hasOwnProperty("_")||(e.CKFinder._={}),e.CKFinder._.hasOwnProperty(t)||(e.CKFinder._[t]={}),e.CKFinder._[t][l.application.name]=s},u.prototype.shouldFallback=function(){return!this.ub.shouldStopProcessing&&this.ux},(t=function(){o.call(this)}).prototype=e(o.prototype),t.qQ="xhr.header",t.prototype.tn=function(e,t){throw new Error("This method needs to be overriden in child class.")},((f=function(e){t.call(this),this.file=e}).prototype=e(t.prototype)).tn=function(e,t){var n=new FormData;n.append("upload",this.file),n.append("ckCsrfToken",V.getCsrfToken()),t(n)},(n=function(e){t.call(this),this.formData=e}).prototype=e(t.prototype),n.prototype.tn=function(e,t){t(this.formData)},((h=function(e,t,n,i,o){r.call(this,e,t,n,i),this.qJ=o}).prototype=e(r.prototype)).tc=function(){var e={};return e[g.qN]="onFileInputChange",e},h.prototype.onFileInputChange=function(e,t){this.ub.uG(t)&&this.qJ.lT(t)},(m=function(e,t){this.sz=t,this.file=e}).prototype=e(o.prototype),m.prototype.mD=function(e){return this.sz.mD(e)},m.prototype.ns=function(e){return this.sz.ns(e)},m.prototype.dispatch=function(e,t){return this.sz.dispatch(e,t)},m.prototype.bZ=function(){return this.file},m.prototype.wv=function(){var e="",t=this.getFileName();return $.test(t)?(e=t.match($))[1].toLowerCase():e},m.prototype.getFileName=function(){return this.file.name},m.prototype.getFileSize=function(){return this.file.size},m.prototype.sy=function(e){return this.sz.sy(e)},m.prototype.tn=function(e){this.sz.tn(this.file,e)},(v=function(){}).prototype=e(a.prototype),v.pH="abort",v.rj="error",v.qk="load",v.rc="progress",v.prototype.tc=function(){var e={};return e[v.pH]="onAbort",e[v.rj]="onError",e[v.qk]="onLoad",e[v.rc]="onProgress",e},v.prototype.onAbort=function(e){},v.prototype.onError=function(e,t){},v.prototype.onLoad=function(e){},v.prototype.onProgress=function(e,t,n,i){},(b=function(e){o.call(this),v.call(this),this.application=e,this.tM=[]}).prototype=e(v.prototype),(b.prototype=o.mixin(b.prototype)).mC=function(){var e=this.tM.concat();this.tM=[],F(e,function(e){e&&e.sY()&&e.lN()})},b.prototype.mU=function(e){this.tM.push(e)},b.prototype.nU=function(e){var t=this.tM.indexOf(e);if(-1===t)throw new Error("Given upload supervisor is not attached.");this.tM.splice(t,1)},b.prototype.tc=function(){var e=v.prototype.tc.call(this);return e[w.pN]="uc",e[y.qM]="tF",e},b.prototype.sj=function(e){var t;for(t=0;t<this.tM.length;t+=1)if(e===this.tM[t].uploadBlob.bZ())return!0;return!1},b.prototype.sB=function(e){return 0<=this.tM.indexOf(e)},b.prototype.tF=function(e,t){this.mU(t)},b.prototype.uc=function(e){this.sB(e)&&this.nU(e)},(g=function(e,t,n){var i=this;o.call(i),p.call(i),v.call(i),i.application=e,i.attachedUploadViewsNumber=0,i.wU=[],i.sa=0,i.sO=0,i.tI=0,i.totalFiles=0,i.ty=t,i.ub=n,i.tM=[]}).prototype=e(v.prototype),g.prototype=o.mixin(g.prototype),g.prototype=p.mixin(g.prototype),g.prototype.mU=b.prototype.mU,g.prototype.nU=b.prototype.nU,g.prototype.sB=b.prototype.sB,g.prototype.tC=c.prototype.tC,g.qN="event.file.input.change",g.ue=300,g.prototype.mC=function(){var e,t=this;for(e=0;e<t.tM.length;e+=1)t.tM[e].removeSubscriber(t);t.ty.mC(),t.ub.or(),t.attachedUploadViewsNumber=0,t.tM=[],t.ud(t.application),t.ma(),t.remove()},g.prototype.tc=function(){var e={};return e[y.qM]="tF",e[w.pN]="uc",e[_.EVENT_DOM_ATTACHED]="onUploadViewDomAttached",e[_.EVENT_DOM_REMOVED]="onUploadViewDomRemoved",e[_.pM]="onFolderRefreshRequest",e},g.prototype.onFileInputChange=function(e){var t=e.jN.$,n=t.files;n.length<1||this.dispatch(g.qN,[t,n])},g.prototype.onFolderRefreshRequest=function(e,t){this.wU.push({folder:e,mw:t})},g.prototype.uV=function(e){var t,n=this,i=e.bn().getDocument(),o=i.getById("ckf_addFiles"),a=i.getById("ckf_cancelUpload"),r=i.getById("ckf_fileInput"),l=i.getById("ckf_globalUploads"),s=n.mC.bind(n),d=n.onFileInputChange.bind(n);l=l.getChild([0,0]),n.domElement={addFilesButton:o,cancelButton:a,countSpan:l.getChild(0),fileInput:r,ni:l.getChild([2,0]),np:l.getChild(4),mz:l.getChild(3),totalSizeSpan:l.getChild(1)},t=n.onDomElementAddFilesClickListener.bind(n),o.on("click",t),a.on("click",s),r.on("change",d),n.domElementListeners||(n.domElementListeners=[]),n.domElementListeners.push({evt:"click",fO:t,bi:o},{evt:"click",fO:s,bi:a},{evt:"change",fO:d,bi:r}),n.shouldBeClickedAutomatically&&(n.shouldBeClickedAutomatically=!1,t())},g.prototype.onDomElementAddFilesClickListener=function(e){this.domElement.fileInput.$.click()},g.prototype.onUploadPanelUploadStartClick=function(e,t,n){this.shouldBeClickedAutomatically=!0,n(e)},g.prototype.uH=function(e){this.domElement.cancelButton.getFirst().setHtml(e.lang.UploadBtnCancel)},g.prototype.ud=function(e){var t=this;t.domElement.cancelButton.getFirst().setHtml(e.lang.CloseBtn),t.sa=0,t.sO=0,t.tI=0,t.totalFiles=0},g.prototype.onUploadViewDomAttached=function(e){this.attachedUploadViewsNumber+=1},g.prototype.onUploadViewDomRemoved=function(e){var t=this;--t.attachedUploadViewsNumber,t.ub.expectedFiles<1&&t.attachedUploadViewsNumber<1&&(t.attachedUploadViewsNumber=0,t.ub.expectedFiles=0,t.remove())},g.prototype.tF=function(e,t){var n=this,i=t.uploadBlob.bZ(),o=n.tj(),a=new _(e,t,i);t.ns(n),t.ns(a),a.ns(n),a.tw(o),n.mU(t),n.tI+=i.size,n.to(n.tI),n.totalFiles+=1,n.tm(n.totalFiles),1===n.totalFiles&&n.uH(e)},g.prototype.uc=function(e){var t=this,n=t.ub.expectedFiles,i=e.uploadBlob.bZ();t.sB(e)&&t.nU(e),n<1&&t.tM.length<1?(t.ma(),t.ud(t.application)):(t.sa+=i.size,t.sO+=1),t.updateUploadProgress(t.sa,t.tI,t.sO,t.totalFiles,n),t.to(t.tI),t.tm(t.totalFiles)},g.prototype.ma=function(){var e,t,n=this,i=n.application.aV;for(e=0;e<n.wU.length;e+=1)if(n.wU[e].folder===i){t=n.wU[e];break}n.wU=[],t&&n.application.oW("requestShowFolderFiles",t)},g.prototype.remove=function(){this.tj().oW("requestUnloadForm")},g.prototype.setUploadCommand=function(e,n){var t,i,o,a;if(n.pW&&!(n.pW.length<1))for(this.domElementListeners||(this.domElementListeners=[]),o=function(e,t){this.onUploadPanelUploadStartClick(t,n,e)},a=n.pW,i=0;i<a.length;i+=1)a[i].click&&(t=a[i].click,a[i].click=o.bind(this,t))},g.prototype.tD=function(e,t){this.updateLoadedPercentage(e,t)},g.prototype.updateLoadedPercentage=function(e,t,n){var i;(i=0<t?Math.round(e/t*100):0)<0&&(i=0),(100<i||isNaN(i))&&(i=100),this.domElement.ni.setStyle("width",i+"%"),n=n?" - "+n.trim():"",this.updateStatusText(this.application.lang.UploadUploaded.replace("!n",i)+n)},g.prototype.nR=function(e,t){var n;t<1||(n=e/1024/t,this.domElement.np.setText(G.formatSpeed(n,this.application.lang)))},g.prototype.updateStatusText=function(e){this.domElement.mz.setText(e)},g.prototype.to=function(e){this.domElement.totalSizeSpan.setText(this.application.lang.UploadTotalSize+" "+G.formatSize(e/1024,this.application.lang))},g.prototype.tm=function(e){this.domElement.countSpan.setText(this.application.lang.UploadTotalFiles+" "+e+" ")},g.prototype.updateUploadProgress=function(e,t,n,i,o){var a,r=e/t,l=n/(i+o);a=CKFinder.tools.formatSize(e/1024,this.application.lang),this.updateLoadedPercentage(r+3*l,4,a)},(y=function(e,t){var n=this;o.call(n),p.call(n),v.call(n),n.application=e,n.lQ=10,n.expectedFiles=0,n.shouldStopProcessing=!1,n.tM=[],n.ty=t}).prototype=e(v.prototype),y.prototype=o.mixin(y.prototype),y.prototype=p.mixin(y.prototype),y.qM="upload.supervisor.ready",y.prototype.or=function(){this.expectedFiles=0,this.shouldStopProcessing=!0,this.tM=[]},y.prototype.nZ=function(){return this.tM.shift()},y.prototype.qg=function(e){this.sj(e.file)||this.tM.push(e)},y.prototype.tc=function(){var e={};return e[w.pU]="tH",e[w.pN]="uc",e},y.prototype.getUploadCommand=function(){if(!this.uploadCommand)throw new Error("Upload command is not set.");return this.uploadCommand},y.prototype.sj=function(e){var t;for(t=0;t<this.tM.length;t+=1)if(e===this.tM[t].uploadBlob.bZ())return!0;return!1},y.prototype.tH=function(){this.tx()},y.prototype.uc=function(){this.lQ+=1,this.tx()},y.prototype.uG=function(e){var t,n,i=this.sX(),o=this,a=this.getUploadCommand();if(!this.application.aV)return!1;if(this.expectedFiles+=e.length,this.shouldStopProcessing=!1,a.bu!==V.aY){if(e.length<1)return!1;try{e[0],this.uI&&this.uI(!1)}catch(e){return!1}finally{a.bu!==V.eV&&(i=!1,a.exec(this.application))}return(n=F.bind(null,e,function(e){if(o.shouldStopProcessing)return o.expectedFiles=0,o.shouldStopProcessing=!1;--o.expectedFiles,o.tA(new m(e,new f(e)))}),i)?(n(),!0):(t=setInterval(function(){o.sX()&&(clearInterval(t),n())},100),!0)}},y.prototype.tA=function(e){var t,n,i=this;e.getFileName().length<1?i.tj().oW("failedUploadFile"):((n=new w(i.application,i.application.aV,e)).ns(i.ty),e.ns(n),t=new XMLHttpRequest,n.nv(t),i.tL(i.application,n))},y.prototype.tL=function(e,t){var n=this;n.dispatch(y.qM,[n.application,t]),t.ns(n),n.lQ<1?n.qg(t):n.tv(e,t)},y.prototype.tx=function(){for(var e=this;0<e.tM.length&&0<e.lQ;)e.tv(e.application,e.nZ())},y.prototype.tJ=function(e){this.lQ=e},y.prototype.setUploadCommand=function(e,t){this.uploadCommand=t},y.prototype.tv=function(e,t){--this.lQ,t.mW()},(w=function(e,t,n){var i=this;o.call(i),v.call(i),i.application=e,i.isAborted=!1,i.sa=0,i.oS=0,i.targetFolder=t,i.uploadBlob=n}).prototype=e(v.prototype),w.prototype=o.mixin(w.prototype),w.pU="start",w.pN="stop",w.prototype.lN=function(){if(!this.sY())throw new Error("Upload is not in progress.");this.isAborted=!0,this.bT.abort()},w.prototype.ns=function(e){if(!(e instanceof v))throw new Error("Invalid argument: expected UploadProgressListener.");o.prototype.ns.call(this,e)},w.prototype.ta=function(e){var t=this.wv(),n=e.aV.getResourceType();return!(t&&!n.isExtensionAllowed(t))||(this.onError(e.lang.UploadExtIncorrect),!1)},w.prototype.wN=function(e){var t,n=this.wv(),i=this.getFileSize(),o=parseInt(e.config.uploadMaxSize,10),a=e.aV.getResourceType();return t=parseInt(a.maxSize,10),0===i?(this.onError(e.lang.Errors[202]),!1):!(o&&o<i||t&&t<i&&(e.config.uploadCheckImages||!W.test(n)))||(this.onError(e.lang.Errors[203]),!1)},w.prototype.tl=function(e){return!!this.ta(e)&&this.wN(e)},w.prototype.nv=function(e){var t,n=this;if(n.sY())throw new Error("Upload is already started.");e.addEventListener(v.pH,n.onAbort.bind(n)),e.addEventListener(v.rj,n.onError.bind(n)),e.addEventListener(v.qk,n.onLoad.bind(n)),(t=e.upload)&&t.addEventListener(v.rc,n.onProgress.bind(n)),n.bT=e,n.isAborted=!1},w.prototype.tK=function(){return this.oS},w.prototype.bZ=function(){return this.uploadBlob.bZ()},w.prototype.wv=function(){return this.uploadBlob.wv()},w.prototype.getFileName=function(){return this.uploadBlob.getFileName()},w.prototype.getFileSize=function(){return this.uploadBlob.getFileSize()},w.prototype.tc=function(){var e=v.prototype.tc.call(this);return e["xhr.header"]="tO",e},w.prototype.sY=function(){return!this.isAborted&&!!this.bT},w.prototype.onAbort=function(e){this.dispatch(v.pH,[this.uploadBlob]),this.onStop()},w.prototype.onError=function(e){e=e||this.application.lang.UploadUnknError,this.dispatch(v.rj,[this.uploadBlob,e]),this.onStop()},w.prototype.tO=function(e,t){if(!this.bT)throw new Error("Request is not initialized");this.bT.setRequestHeader(e,t)},w.prototype.onLoad=function(e){var t,n,i,o=this;if(200!==o.bT.status)return o.onError();t=(i=e.target.responseText.split(L,2))[0],n=i[1],!t.length&&n?o.dispatch(v.rj,[o.uploadBlob,n]):o.dispatch(v.qk,[o.uploadBlob,t,n]),o.onStop()},w.prototype.onProgress=function(e){var t=this;e.lengthComputable&&(t.sa=e.target.kC=e.loaded,t.dispatch(v.rc,[t,t.uploadBlob,t.sa,t.tK()]))},w.prototype.onStop=function(){var e=this;delete e.bT,e.isAborted=!0,e.oS=0,e.dispatch(w.pN,[e,e.uploadBlob])},w.prototype.mW=function(){var t=this,n=this.bT;if(!this.tl(this.application))return!1;this.uploadBlob.tn(function(e){if(t.dispatch(w.pU,[t.uploadBlob]),n){t.oS=l();try{t.bT.send(e)}catch(e){t.onStop()}}else t.onStop()})},(s=function(e,t,n,i,o){w.call(this,e,t,n),this.isAborted=!1,this.tG=i,this.uz=o}).prototype=e(w.prototype),s.prototype.lN=function(){if(!this.sY())throw new Error("Upload is not in progress.");this.isAborted=!0,this.uz()},s.prototype.mW=function(){var t=this;if(!t.tl(t.application))return!1;t.isAborted=!1,t.oS=l(),t.dispatch(w.pU,[t.uploadBlob]);try{t.tG()}catch(e){try{t.uz()}catch(e){throw e}finally{t.onStop()}}},(_=function(e,t,n){var i=this;o.call(i),p.call(i),v.call(i),i.application=e,i.file=n,i.isDomAttached=!1,i.isDomRemoved=!1,i.shouldBeRemovedOnStop=!0,i.targetFolder=t.targetFolder,i.ts=t}).prototype=e(v.prototype),_.prototype=o.mixin(_.prototype),_.prototype=p.mixin(_.prototype),_.prototype.tD=g.prototype.updateLoadedPercentage,_.prototype.nR=g.prototype.nR,_.prototype.updateStatusText=g.prototype.updateStatusText,_.EVENT_DOM_ATTACHED="event.dom.attached",_.EVENT_DOM_REMOVED="event.dom.removed",_.pM="event.folder.refresh.request",_.prototype.tc=function(){var e=v.prototype.tc.call(this);return e[w.pN]="onStop",e},_.prototype.onAbort=function(e){var t=this;t.ts&&(t.ts.sY()&&(t.ts.lN(),t.ts.onStop()),t.onStop())},_.prototype.onError=function(e,t){this.tE(t)},_.prototype.uV=function(e){var t=this;if(!t.isDomAttached){var n,i=e.bn(),o=new Y("div",i.getDocument());o.setAttribute("class","ckf_upload_info"),o.setHtml(R(t.application,e,t.file,'<div class="ckf_progress_wrapper"><div class="ckf_progress_info"><span>{{file_name}}</span><span></span><div class="ckf_progress_bar_container"><div></div></div><span class="ckf_status"></span><span class="ckf_speed"></span><div class="ckf_outcome"></div></div></div><div class="ckf_uploadButtons"><a class="cke_dialog_ui_button cke_dialog_ui_button_cancel" name="cancel"><span class="cke_dialog_ui_button">{{lang_cancel_button}}</span></a></div>')),i.dB().append(o),t.application.cg.resizeFormPanel(),n=o.getChild([0,0]),t.domElement={button:o.getChild([1,0]),container:o,mI:n.getChild(5),ni:n.getChild([2,0]),mx:n.getChild(1),np:n.getChild(4),mz:n.getChild(3)},t.domElement.button.on("click",t.uk.bind(t,t.ts)),t.isDomAttached=!0,t.dispatch(_.EVENT_DOM_ATTACHED,[t])}},_.prototype.onLoad=function(e,t,n){this.tN(n),this.dispatch(_.pM,[this.targetFolder,t])},_.prototype.onProgress=function(e,t,n,i){this.tD(n,this.file.size),this.nR(n,i)},_.prototype.onStop=function(){this.shouldBeRemovedOnStop&&this.remove()},_.prototype.uk=function(e,t){this.shouldBeRemovedOnStop=!0,e.sY()?e.lN():this.onAbort(e.uploadBlob)},_.prototype.remove=function(){var e=this;e.isDomRemoved||(e.domElement.container.remove(),e.application.cg.resizeFormPanel(),e.isDomRemoved=!0,e.dispatch(_.EVENT_DOM_REMOVED,[e]))},_.prototype.tE=function(e){var t=this.tj();this.tp(e),this.domElement.container.addClass("ckf_FileError"),this.application.cg.resizeFormPanel(),t.oW("failedUploadFile",e)},_.prototype.tp=function(e){var t=this;e&&(t.shouldBeRemovedOnStop=!1),t.domElement.ni.getParent().hide(),t.domElement.mz.hide(),t.domElement.np.hide(),t.domElement.mI.setText(e),t.domElement.button.getFirst().setHtml(t.application.lang.CloseBtn),t.domElement.button.addClass("cke_dialog_ui_button_ok"),t.domElement.button.removeClass("cke_dialog_ui_button_cancel")},_.prototype.tN=function(e){var t=this.tj();e?(this.tp(e),this.application.cg.resizeFormPanel()):this.remove(),t.oW("successUploadFile",e)},k=function(){return!O&&"undefined"!=typeof FormData},C=function(e){var t;return!(!(t=e.env?e:V).env.mac&&t.env.safari)},x=function(e,t,n,i){var o;o=setInterval(function(){t.ld.hasOwnProperty(n)&&(clearInterval(o),i(t,n,t.ld[n]))},10)},E=function(e,t,n,i,o,a,r,l){var s=l.bn();n.sX()||n.mE(t),s.hasAttribute("ondrop")||s.setAttribute("ondrop",T(t,H))},S=function(e,t,n,i,o,a,r,l){var s=T(t,z),d=t.cS("upload");a.setUploadCommand(t,d),r.setUploadCommand(t,d),t.cg.replaceUploadForm(s,function(){N(e,t,n,i,o,a,r,l)},!0,11)},N=function(e,t,n,i,o,a,r,l){n.tw(l),r.tw(l),a.tw(l)},D=function(e,i){return e.replace(I,function(e,t,n){return i[n]})},T=function(e,t){var n={application_name:G.escapeHtml(e.name),input_multiple:C(e)?'multiple="multiple"':"",lang_upload_add_files:e.lang.UploadAddFiles,lang_close_button:e.lang.CloseBtn};return D(t,n)},R=function(e,t,n,i){var o={file_name:G.escapeHtml(n.name),lang_cancel_button:e.lang.UploadBtnCancel};return D(i,o)},function(e){var t;t=K.bind?K.bind(this,e):(O=!0,K),e.plugins.add("html5upload",{bM:["uploadform","csrftokenmanager"],bz:t})}(V)}(),j.add("basket",{bM:["foldertree","filesview","contextmenu"],readOnly:!1,basketToolbar:[["clearBasket",{label:"BasketClear",command:"TruncateBasket",disableEmpty:!0}]],basketFileContextMenu:[["mu",{label:"BasketRemove",command:"RemoveFileFromBasket",group:"file3"}],["hN",{label:"BasketOpenFolder",command:"OpenFileFolder",group:"file1"}]],bz:function(u){function f(){for(var e=u.basketFiles.length?V.aS:V.aY,t=0,n=p.length;t<n;t++)u.cS(p[t]).bR(e)}var n=window.top[V.nd+"cation"][V.jG+"st"],p=[];u.bD("FolderPasteCopyBasket",{exec:function(e){var t=e.aV;t&&kt(e,t,e.basketFiles)}}),u.bD("FolderPasteMoveBasket",{exec:function(e){if(V.bF&&1==V.bs.indexOf(V.bF.substr(1,1))%5&&V.lS(n)!=V.lS(V.ed)||V.bF&&V.bF.substr(3,1)!=V.bs.substr(9*(V.bs.indexOf(V.bF.substr(0,1))+V.bs.indexOf(V.bF.substr(2,1)))%(V.bs.length-1),1))e.msgDialog("","This function is disabled in the demo version of CKFinder.<br />Please visit the <a href='http://cksource.com/ckfinder'>CKFinder web site</a> to obtain a valid license.");else{var t=e.aV;if(!t)return;kt(e,t,e.basketFiles,!0),f()}}}),u.eU({folderPasteMoveBasket:{label:u.lang.BasketMoveFilesHere,command:"FolderPasteMoveBasket",group:"folder1"},folderPasteCopyBasket:{label:u.lang.BasketCopyFilesHere,command:"FolderPasteCopyBasket",group:"folder1"}});var i=u.basket=new V.aL.BasketFolder(u);u.basketFiles=[],u.on("uiReady",function(){var e=u.ld["foldertree.foldertree"];e.on("beforeAddFolder",function(e){e.removeListener(),e.data.folders.push(i)}),e.on("beforeDroppable",function(e){if(e.data.target instanceof V.aL.BasketFolder&&(e.data.source instanceof V.aL.File&&(e.data.source=[e.data.source]),G.isArray(e.data.source)&&e.data.source.length&&e.data.source[0]instanceof V.aL.File)){for(var t,n,i=e.data.source,o=0,a=0,r=i.length;a<r;a++){for(t=0,n=u.basketFiles.length;t<n;t++)if(i[a].isSameFile(u.basketFiles[t])){o=1;break}o||u.basketFiles.push(i[a])}e.cancel(1)}}),e.on("beforeContextMenu",function(e){var t;e.data.folder instanceof V.aL.BasketFolder?(delete(t=e.data.bj).renameFolder,delete t.removeFolder,delete t.createSubFolder,t.qT=u.basketFiles.length?V.aS:V.aY):((t=e.data.bj).folderPasteCopyBasket=u.basketFiles.length?V.aS:V.aY,t.folderPasteMoveBasket=u.basketFiles.length?V.aS:V.aY)}),e.on("beforeKeyboardNavigation",function(e){if(e.data.folder instanceof V.aL.BasketFolder){var t=e.data.db();46!=t&&113!=t||e.cancel()}}),u.bD("TruncateBasket",{exec:function(e){e.basketFiles.length&&e.fe("",e.lang.BasketTruncateConfirm,function(){e.basketFiles.length=0,e.oW("requestSelectFolder",{folder:e.basket})})}}),u.bD("RemoveFileFromBasket",{exec:function(i){var o=i.ld["filesview.filesview"].tools.oO();o&&o.length&&i.fe("",1==o.length?i.lang.BasketRemoveConfirm.replace("%1",G.escapeHtml(o[0].name)):i.lang.BasketRemoveConfirmMultiple.replace("%1",o.length),function(){for(var e,t=0,n=o.length;t<n;t++)for(e=0;e<i.basketFiles.length;e++)if(o[t].isSameFile(i.basketFiles[e])){i.basketFiles.splice(e,1);break}i.oW("requestSelectFolder",{folder:i.basket}),f()})}}),u.bD("OpenFileFolder",{exec:function(e){var t=e.ld["filesview.filesview"].data().cG;t&&e.oW("requestSelectFolder",{folder:t.folder})}}),u.eU&&u.gp("truncateBasket",{label:u.lang.BasketClear,command:"TruncateBasket",group:"folder"});var d=[],t=u.ld["filesview.filesview"],c=[];t.on("beforeContextMenu",function(e){if(e.data.folder instanceof V.aL.BasketFolder){var t=e.data.bj;delete t.renameFile,delete t.deleteFile,delete t.deleteFiles,t.mu=V.aS,t.hN=V.aS;for(var n=0;n<c.length;n++)t[c[n]]=V.aS}}),t.on("beforeShowFolderFiles",function(e){if(e.data.folder instanceof V.aL.BasketFolder){e.cancel(1),this.app.oW("requestRenderFiles",{files:u.basketFiles,mj:u.lang.BasketEmpty,eu:1,folder:e.data.folder}),this.app.oW("requestRepaintFolder",e.data),function(e){for(var t in e.plugins)if(e.plugins.hasOwnProperty(t)&&(t=e.plugins[t]).basketToolbar)for(var n=0;n<t.basketToolbar.length;n++){var i=t.basketToolbar[n];if(!e.bY._.items[i[0]]){var o=G.deepCopy(i[1]),a=o.command;if(!o.command){var r=i[1].onClick;a="BasketToolbar_"+i[0],e.bD(a,{exec:function(e){r(e.cg)}}),o.command=a}var l=G.capitalize(t.name);"function"==typeof o.label?o.label=o.label.call(t,e.cg):e.lang[t.name]&&e.lang[t.name][o.label]?o.label=e.lang[t.name][o.label]:e.lang[l]&&e.lang[l][o.label]?o.label=e.lang[l][o.label]:e.lang[o.label]&&(o.label=e.lang[o.label]),o.basketToolbar=1,o.disableEmpty&&p.push(a),e.bY.add(i[0],CKFinder._.UI_BUTTON,o)}}}(this.app),function(e){if(!e.eU)return;for(var t in e.plugins)if(e.plugins.hasOwnProperty(t)&&(t=e.plugins[t]).basketFileContextMenu)for(var n=0;n<t.basketFileContextMenu.length;n++){var i=t.basketFileContextMenu[n];if(!e._.iG[i[0]]){var o=G.deepCopy(i[1]);if(!o.command){var a="BasketContextMenu_"+i[0],r=i[1].onClick;e.bD("BasketContextMenu_"+i[0],{exec:function(e){r(e.cg)}}),o.command=a}var l=G.capitalize(t.name);"function"==typeof o.label?o.label=o.label.call(t,e.cg):e.lang[t.name]&&e.lang[t.name][o.label]?o.label=e.lang[t.name][o.label]:e.lang[l]&&e.lang[l][o.label]?o.label=e.lang[l][o.label]:e.lang[o.label]&&(o.label=e.lang[o.label]),o.disableEmpty&&p.push(a),e.gp(i[0],o),c.push(i[0])}}}(this.app),f();for(var t=this.app.dh.fk,n=0;n<t.length;n++){var i=this.app.document.getById(t[n].id),o=['<span class="cke_toolgroup" id="basket">'];for(var a in this.app.bY._.items)if(this.app.bY._.items.hasOwnProperty(a)){var r=u.bY._.items[a];if(r.mp[0].basketToolbar){var l=(r=u.bY.create(a)).er(u,o),s=t[n].items.push(l)-1;0<s&&(l.previous=t[n].items[s-1],l.previous.next=l),d[n]||(d[n]=[]),d[n].push(s)}}o.push("</span>"),i.appendHtml(o.join(""))}this.on("beforeShowFolderFiles",function(e){this.app.document.getById("basket").remove();for(var t=this.app.dh.fk,n=0;n<t.length;n++)for(var i=0;i<t[n].items.length;i++)d[n][i]&&delete t[n].items[i];e.removeListener()},null,null,1),this.oW("successShowFolderFiles",e.data),this.oW("afterShowFolderFiles",e.data)}}),t.on("beforeKeyboardNavigation",function(e){var t=u.aV;if(t&&t instanceof V.aL.BasketFolder){var n=e.data.db();46==n&&(e.cancel(),u.execCommand("RemoveFileFromBasket")),113==n&&e.cancel()}})},null,null,20)}}),V.aL.BasketFolder=G.createClass({$:function(e){V.aL.Folder.call(this,e,null,e.lang.BasketFolder),this.hasChildren=0,this.acl=new V.aL.Acl("1111111"),this.isBasket=!0},base:V.aL.Folder,ej:{createNewFolder:function(){},getChildren:function(e){e.apply(this,null)},rename:function(){},remove:function(){},getUrl:function(){return"ckfinder://basketFolder"},getUploadUrl:function(){return null},getPath:function(){return"/"},copyFiles:function(e){},moveFiles:function(e){}}}),V.DIALOG_RESIZE_NONE=0,V.DIALOG_RESIZE_WIDTH=1,V.DIALOG_RESIZE_HEIGHT=2,V.DIALOG_RESIZE_BOTH=3,function(){function a(e){return!!this._.tabs[e][0].$.offsetHeight}function h(){for(var e=this,t=e._.gx,n=e._.cU.length,i=G.indexOf(e._.cU,t)+n,o=i-1;i-n<o;o--)if(a.call(e,e._.cU[o%n]))return e._.cU[o%n];return null}function m(){for(var e=this,t=e._.gx,n=e._.cU.length,i=G.indexOf(e._.cU,t),o=i+1;o<i+n;o++)if(a.call(e,e._.cU[o%n]))return e._.cU[o%n];return null}function i(e,t,n){this.element=t,this.cQ=n,this.fM=function(){return!t.getAttribute("disabled")&&t.isVisible()},this.focus=function(){e._.aW=this.cQ,this.element.focus()},t.on("keydown",function(e){e.data.db()in{32:1,13:1}&&this.oW("click")}),t.on("focus",function(){this.oW("mouseover")}),t.on("blur",function(){this.oW("mouseout")})}function e(e){e.reset&&e.reset()}var r;function n(e,t){return t=t||{},G.extend({id:"cancel",type:"button",label:e.lang.common.cancel,class:"cke_dialog_ui_button_cancel",onClick:function(e){var t=e.data.dialog;!1!==t.oW("cancel",{hide:!0}).hide&&t.hide()}},t,!0)}function o(e,t){return t=t||{},G.extend({id:"ok",type:"button",label:e.lang.common.ok,class:"cke_dialog_ui_button_ok",onClick:function(e){var t=e.data.dialog;!1!==t.oW("ok",{hide:!0}).hide&&t.hide()}},t,!0)}V.dialog=function(i,e){var t=V.dialog._.ev[e];t=G.extend(t(i),g),t=G.clone(t),t=new v(this,t);V.document;var n=i.theme.pu(i);this._={app:i,element:n.element,name:e,hB:{width:0,height:0},size:{width:0,height:0},contents:{},buttons:{},iX:{},tabs:{},cU:[],gx:null,nM:null,gV:0,qF:null,eC:!1,eO:[],aW:0,hasFocus:!1},this.bO=n.bO,this.bO.dialog.setStyles({position:W.ie6Compat?"absolute":"fixed",top:0,left:0,visibility:"hidden"}),V.event.call(this),this.dg=t=V.oW("dialogDefinition",{name:e,dg:t},i).dg,t.onLoad&&this.on("load",t.onLoad),t.onShow&&this.on("show",t.onShow),t.onHide&&this.on("hide",t.onHide),t.onOk&&this.on("ok",function(e){!1===t.onOk.call(this,e)&&(e.data.hide=!1)}),t.onCancel&&this.on("cancel",function(e){!1===t.onCancel.call(this,e)&&(e.data.hide=!1)});function o(e){var t=r._.contents;for(var n in t)for(var i in t[n])if(e.call(this,t[n][i]))return}var a,r=this;function l(e){var t=r._.eO,n=e?1:-1;if(!(t.length<1)){for(var i=(r._.aW+n+t.length)%t.length,o=i;!t[o].fM()&&(o=(o+n+t.length)%t.length)!=i;);t[o].focus(),"text"==t[o].type&&t[o].select()}}function s(e){if(r==V.dialog._.dL){var t=e.data.db();if(a=0,9==t||t==V.dy+9){var n=t==V.dy+9;if(r._.eC){var i=n?h.call(r):m.call(r);r.selectPage(i),r._.tabs[i][0].focus()}else l(!n);a=1}else t!=V.eJ+121||r._.eC?37!=t&&39!=t||!r._.eC||(i=37==t?h.call(r):m.call(r),r.selectPage(i),r._.tabs[i][0].focus(),a=1):(r._.eC=!0,r._.tabs[r._.gx][0].focus(),a=1);a&&(e.stop(),e.data.preventDefault())}}function d(e){a&&e.data.preventDefault()}this.on("ok",function(n){o(function(e){if(e.validate){var t=e.validate(this);if("string"==typeof t&&(i.document.getWindow().$.alert(t),t=!1),!1===t)return e.select?e.select():e.focus(),n.data.hide=!1,n.stop(),!0}})},this,null,0),this.on("cancel",function(t){o(function(e){if(e.isChanged())return i.document.getWindow().$.confirm(i.lang.common.confirmCancel)||(t.data.hide=!1),!0})},this,null,0),this.bO.close.on("click",function(e){!1!==this.oW("cancel",{hide:!0}).hide&&this.hide()},this),this.on("show",function(){V.document.on("keydown",s,this,null,0),(W.opera||W.gecko&&W.mac)&&V.document.on("keypress",d,this),W.ie6Compat&&w.getChild(0).getFrameDocument().on("keydown",s,this,null,0)}),this.on("hide",function(){V.document.removeListener("keydown",s),(W.opera||W.gecko&&W.mac)&&V.document.removeListener("keypress",d)}),this.on("iframeAdded",function(e){new I(e.data.iframe.$.contentWindow.document).on("keydown",s,this,null,0)}),this.on("show",function(){this._.hasFocus||(this._.aW=-1,l(!0))},this,null,4294967295),W.ie6Compat&&this.on("load",function(e){var t=this.getElement(),n=t.getFirst();n.remove(),n.appendTo(t)},this),function(d){var c=null,u=null,e=(d.getElement().getFirst(),d.eY()),f=e.config.dialog_magnetDistance,p=e.skin.margins||[0,0,0,0];void 0===f&&(f=20);function n(e){var t,n,i=d.hR(),o=V.document.getWindow().eR(),a=e.data.$.screenX,r=e.data.$.screenY,l=a-c.x,s=r-c.y;c={x:a,y:r},u.x+=l,u.y+=s,t=u.x+p[3]<f?-p[3]:u.x-p[1]>o.width-i.width-f?o.width-i.width+p[1]:u.x,n=u.y+p[0]<f?-p[0]:u.y-p[2]>o.height-i.height-f?o.height-i.height+p[2]:u.y,d.move(t,n,1),e.data.preventDefault()}function i(e){if(V.document.removeListener("mousemove",n),V.document.removeListener("mouseup",i),W.ie6Compat){var t=w.getChild(0).getFrameDocument();t.removeListener("mousemove",n),t.removeListener("mouseup",i)}}d.bO.title.on("mousedown",function(e){if(c={x:e.data.$.screenX,y:e.data.$.screenY},V.document.on("mousemove",n),V.document.on("mouseup",i),u=d.gz(),W.ie6Compat){var t=w.getChild(0).getFrameDocument();t.on("mousemove",n),t.on("mouseup",i)}e.data.preventDefault()},d)}(this),function(u){var f=u.dg,p=f.resizable;if(p==V.DIALOG_RESIZE_NONE)return;var h,m,g,v,b,i,y=u.eY();function n(e){b=u.hR(),e=e.data.$;var t=u.bO.contents;if(t.$.getElementsByTagName("iframe").length&&(i=Y.kE('<div class="cke_dialog_resize_cover" style="height: 100%; position: absolute; width: 100%;"></div>'),t.append(i)),m=b.height-u.bO.contents.hR("height",!(W.gecko||W.opera||L&&W.quirks)),h=b.width-u.bO.contents.hR("width",1),v={x:e.screenX,y:e.screenY},g=V.document.getWindow().eR(),V.document.on("mousemove",o),V.document.on("mouseup",a),W.ie6Compat){var n=w.getChild(0).getFrameDocument();n.on("mousemove",o),n.on("mouseup",a)}e.preventDefault&&e.preventDefault()}function o(e){var t="rtl"==y.lang.dir,n=(e.data.$.screenX-v.x)*(t?-1:1),i=e.data.$.screenY-v.y,o=b.width,a=b.height,r=o+n*(u._.moved?1:2),l=a+i*(u._.moved?1:2),s=u._.element.getFirst(),d=t&&s.getComputedStyle("right"),c=u.gz();d=d&&("auto"==d?g.width-(c.x||0)-s.hR("width"):parseInt(d,10)),c.y+l>g.height&&(l=g.height-c.y),(t?d:c.x)+r>g.width&&(r=g.width-(t?d:c.x)),p!=V.DIALOG_RESIZE_WIDTH&&p!=V.DIALOG_RESIZE_BOTH||t&&0<n&&!c.x||(o=Math.max(f.minWidth||0,r-h)),p!=V.DIALOG_RESIZE_HEIGHT&&p!=V.DIALOG_RESIZE_BOTH||(a=Math.max(f.minHeight||0,l-m)),u.resize(o,a),function(e){if(u._.moved&&"rtl"==y.lang.dir){var t=u._.element.getFirst();t.setStyle("right",e+"px"),t.removeStyle("left")}else u._.moved||u.layout()}(d),e.data.preventDefault()}function a(){if(V.document.removeListener("mouseup",a),V.document.removeListener("mousemove",o),i&&(i.remove(),i=null),W.ie6Compat){var e=w.getChild(0).getFrameDocument();e.removeListener("mouseup",a),e.removeListener("mousemove",o)}if("rtl"==y.lang.dir){var t=u._.element.getFirst(),n=t.getComputedStyle("left");n="auto"==n?g.width-parseInt(t.rd("right"),10)-u.hR().width:parseInt(n,10),t.removeStyle("right"),u._.position.x+=1,u.move(n,u._.position.y)}}u.on("load",function(){var e="";p==V.DIALOG_RESIZE_WIDTH?e=" cke_resizer_horizontal":p==V.DIALOG_RESIZE_HEIGHT&&(e=" cke_resizer_vertical");var t=Y.kE('<div class="cke_resizer'+e+'" title="'+G.htmlEncode(y.lang.resize)+'"></div>');t.on("mousedown",n),u.bO.footer.append(t,1)}),y.on("destroy",function(){G.removeFunction(n)})}(this),this.bO.title.setText(t.title);for(var c=0;c<t.contents.length;c++)this.addPage(t.contents[c]);var u=/cke_dialog_tab(\s|$|_)/;this.bO.tabs.on("click",function(e){var t,n=e.data.bK();!u.test(n.$.className)&&"a"!=n.getName()||(t=n.$.id.substr(0,n.$.id.lastIndexOf("_")),this.selectPage(t),this._.eC&&(this._.eC=!1,this._.aW=-1,l(!0)),e.data.preventDefault())},this);var f=[],p=V.dialog._.gv.hbox.dQ(this,{type:"hbox",className:"cke_dialog_footer_buttons",widths:[],children:t.buttons},f).getChild();for(this.bO.footer.setHtml(f.join("")),c=0;c<p.length;c++)this._.buttons[p[c].id]=p[c];V.skins.load(i,"dialog")},V.dialog.prototype={resize:function(e,t){this._.hB&&this._.hB.width==e&&this._.hB.height==t||(V.dialog.oW("resize",{dialog:this,skin:this._.app.gd,width:e,height:t},this._.app),this._.hB={width:e,height:t})},hR:function(){var e=this._.element.getFirst();return{width:e.$.offsetWidth||0,height:e.$.offsetHeight||0}},mn:function(){var e=this.hR();return e.height=e.height-(this.bO.title.$.offsetHeight||0)-(this.bO.footer.$.offsetHeight||0),e},move:function(e,t,n){var i=this._.element.getFirst();if(void 0===r&&(r="fixed"==i.getComputedStyle("position")),!r||!this._.position||this._.position.x!=e||this._.position.y!=t){if(this._.position={x:e,y:t},!r){var o=V.document.getWindow().hV();e+=o.x,t+=o.y}i.setStyles({left:(0<e?e:0)+"px",top:(0<t?t:0)+"px"}),n&&(this._.moved=1)}},gz:function(){return G.extend({},this._.position)},show:function(){var t=this._.app;if("qt"==t.mode&&L){var e=t.getSelection();e&&e.up()}var n=this._.element,i=this.dg;if(!n.getParent()||!n.getParent().equals(V.document.bH())){if(n.appendTo(V.document.bH()),W.gecko&&W.version<10900){var o=this.bO.dialog;o.setStyle("position","absolute"),setTimeout(function(){o.setStyle("position","fixed")},0)}if(this.resize(this._.hB&&this._.hB.width||i.minWidth,this._.hB&&this._.hB.height||i.minHeight),this.selectPage(this.dg.contents[0].id),this.reset(),null===V.dialog._.gw&&(V.dialog._.gw=this._.app.config.baseFloatZIndex),this._.element.getFirst().setStyle("z-index",V.dialog._.gw+=10),null===V.dialog._.dL){(V.dialog._.dL=this)._.ep=null;try{_(this._.app)}catch(e){w=void 0,_(t),y=!1}for(var a in n.on("keydown",C),n.on(W.opera?"keypress":"keyup",x),{keyup:1,keydown:1,keypress:1})n.on(a,R)}else{this._.ep=V.dialog._.dL,this._.ep.getElement().getFirst().$.style.zIndex-=Math.floor(this._.app.config.baseFloatZIndex/2),V.dialog._.dL=this}E(this,this,"",null,function(){var e=this.getButton("cancel");e?e.click():!1!==this.oW("cancel",{hide:!0}).hide&&this.hide()}),this._.hasFocus=!1,G.setTimeout(function(){this.layout(),this.bO.dialog.setStyle("visibility",""),this.cr("load",{}),this.oW("show",{}),this._.app.oW("dialogShow",this),this.gh(function(e){e.jW&&e.jW()})},100,this)}},layout:function(){var e=V.document.getWindow().eR(),t=this.hR();this.move(this._.moved?this._.position.x:(e.width-t.width)/2,this._.moved?this._.position.y:(e.height-t.height)/2)},gh:function(e){for(var t in this._.contents)for(var n in this._.contents[t])e(this._.contents[t][n]);return this},reset:function(){return this.gh(e),this},rN:function(){var t=arguments;this.gh(function(e){e.qi&&e.qi.apply(e,t)})},sI:function(){var t=arguments;this.gh(function(e){e.rx&&e.rx.apply(e,t)})},hide:function(){this.oW("hide",{}),this._.app.oW("dialogHide",this);var e=this._.element;if(e.getParent()){if(e.remove(),this.bO.dialog.setStyle("visibility","hidden"),S(this),this._.ep){var t=this._.ep.getElement().getFirst();t.setStyle("z-index",parseInt(t.$.style.zIndex,10)+Math.floor(this._.app.config.baseFloatZIndex/2))}else F();if(V.dialog._.dL=this._.ep,this._.ep)V.dialog._.gw-=10;else{for(var n in V.dialog._.gw=null,e.removeListener("keydown",C),e.removeListener(W.opera?"keypress":"keyup",x),{keyup:1,keydown:1,keypress:1})e.removeListener(n,R);var i=this._.app;if(i.focus(),i._.activeElement=null,i._.oO=[],"qt"==i.mode&&L){var o=i.getSelection();o&&o.sd(!0)}}this.gh(function(e){e.ki&&e.ki()})}},addPage:function(e){var t=this,n=[],i=e.label?' title="'+G.htmlEncode(e.label)+'"':"",o=(e.elements,V.dialog._.gv.vbox.dQ(t,{type:"vbox",className:"cke_dialog_page_contents",children:e.elements,expand:!!e.expand,padding:e.padding,style:e.style||"width: 100%; height: 100%;"},n)),a=Y.kE(n.join(""),V.document),r=Y.kE(['<a class="cke_dialog_tab"',0<t._.gV?" cke_last":"cke_first",i,e.hidden?' style="display:none"':"",' id="',e.id+"_",G.getNextNumber(),'" href="javascript:void(0)"',' hp="true">',e.label,"</a>"].join(""),V.document);0===t._.gV?t.bO.dialog.addClass("cke_single_page"):t.bO.dialog.removeClass("cke_single_page"),t._.tabs[e.id]=[r,a],t._.cU.push(e.id),t._.gV++,t._.qF=r;for(var l,s=t._.contents[e.id]={},d=o.getChild();l=d.shift();)"function"==typeof(s[l.id]=l).getChild&&d.push.apply(d,l.getChild());a.setAttribute("name",e.id),a.appendTo(t.bO.contents),r.unselectable(),t.bO.tabs.append(r),e.accessKey&&(E(t,t,"bP+"+e.accessKey,D,N),t._.iX["bP+"+e.accessKey]=e.id)},selectPage:function(e){for(var t in this._.tabs){var n=this._.tabs[t][0],i=this._.tabs[t][1];t!=e&&(n.removeClass("cke_dialog_tab_selected"),i.hide())}var o=this._.tabs[e];o[0].addClass("cke_dialog_tab_selected"),o[1].show(),this._.gx=e,this._.nM=G.indexOf(this._.cU,e)},vJ:function(e){var t=this._.tabs[e]&&this._.tabs[e][0];t&&t.hide()},showPage:function(e){var t=this._.tabs[e]&&this._.tabs[e][0];t&&t.show()},getElement:function(){return this._.element},getName:function(){return this._.name},getContentElement:function(e,t){return this._.contents[e][t]},getValueOf:function(e,t){return this.getContentElement(e,t).getValue()},setValueOf:function(e,t,n){return this.getContentElement(e,t).setValue(n)},getButton:function(e){return this._.buttons[e]},click:function(e){return this._.buttons[e].click()},disableButton:function(e){return this._.buttons[e].disable()},enableButton:function(e){return this._.buttons[e].enable()},vj:function(){return this._.gV},getParentApi:function(){return this._.app.cg},eY:function(){return this._.app},rf:function(){return this.eY().getSelection().rf()},tQ:function(e,t){if(void 0===t)t=this._.eO.length,this._.eO.push(new i(this,e,t));else{this._.eO.splice(t,0,new i(this,e,t));for(var n=t+1;n<this._.eO.length;n++)this._.eO[n].cQ++}},setTitle:function(e){this.bO.title.setText(e)}},G.extend(V.dialog,{add:function(e,t){this._.ev[e]&&"function"!=typeof t||(this._.ev[e]=t)},exists:function(e){return!!this._.ev[e]},getCurrent:function(){return V.dialog._.dL},okButton:(o.type="button",o.override=function(t){return G.extend(function(e){return o(e,t)},{type:"button"},!0)},o),cancelButton:(n.type="button",n.override=function(t){return G.extend(function(e){return n(e,t)},{type:"button"},!0)},n),addUIElement:function(e,t){this._.gv[e]=t}}),V.dialog._={gv:{},ev:{},dL:null,gw:null},V.event.du(V.dialog),V.event.du(V.dialog.prototype,!0);var g={resizable:V.DIALOG_RESIZE_NONE,minWidth:600,minHeight:400,buttons:[V.dialog.okButton,V.dialog.cancelButton]},l=function(e,t,n){for(var i,o=0;i=e[o];o++){if(i.id==t)return i;if(n&&i[n]){var a=l(i[n],t,n);if(a)return a}}return null},s=function(e,t,n,i,o){if(n){for(var a,r=0;a=e[r];r++){if(a.id==n)return e.splice(r,0,t),t;if(i&&a[i]){var l=s(a[i],t,n,i,!0);if(l)return l}}if(o)return null}return e.push(t),t},d=function(e,t,n){for(var i,o=0;i=e[o];o++){if(i.id==t)return e.splice(o,1);if(n&&i[n]){var a=d(i[n],t,n);if(a)return a}}return null},v=function(e,t){this.dialog=e;for(var n,i=t.contents,o=0;n=i[o];o++)i[o]=new c(e,n);G.extend(this,t)};function c(e,t){this._={dialog:e},G.extend(this,t)}v.prototype={vz:function(e){return l(this.contents,e)},getButton:function(e){return l(this.buttons,e)},uh:function(e,t){return s(this.contents,e,t)},qW:function(e,t){return s(this.buttons,e,t)},uP:function(e){d(this.contents,e)},uO:function(e){d(this.buttons,e)}},c.prototype={eB:function(e){return l(this.elements,e,"children")},add:function(e,t){return s(this.elements,e,t,"children")},remove:function(e){d(this.elements,e,"children")}};var w,u,t,f,p,b,y=!0,_=function(e){var i=V.document.getWindow();if(!y||!w){var t=e.config.dialog_backgroundCoverColor||"white",n=['<div style="position: ',W.ie6Compat?"absolute":"fixed","; z-index: ",e.config.baseFloatZIndex,"; top: 0px; left: 0px; ",W.ie6Compat?"":"background-color: "+t,'" id="cke_dialog_background_cover">'];if(W.ie6Compat){var o=W.isCustomDomain(),a="<html><body style=\\'background-color:"+t+";\\'></body></html>";n.push('<iframe hp="true" frameborder="0" id="cke_dialog_background_iframe" src="javascript:'),n.push("void((function(){document.open();"+(o?"document.domain='"+document.domain+"';":"")+"document.write( '"+a+"' );document.close();})())"),n.push('" style="position:absolute;left:0;top:0;width:100%;height: 100%;progid:DXImageTransform.Microsoft.Alpha(opacity=0)"></iframe>')}n.push("</div>"),w=Y.kE(n.join(""),V.document)}function r(){var e=i.eR();s.setStyles({width:e.width+"px",height:e.height+"px"})}function l(){var e=i.hV(),t=V.dialog._.dL;s.setStyles({left:e.x+"px",top:e.y+"px"});do{var n=t.gz();t.move(n.x,n.y)}while(t=t._.ep)}var s=w;if(u=r,i.on("resize",r),r(),W.ie6Compat){function d(){l(),arguments.callee.lw.apply(this,arguments)}i.$.setTimeout(function(){d.lw=window.onscroll||function(){},window.onscroll=d},0),l()}var c=e.config.dialog_backgroundCoverOpacity;s.setOpacity(void 0!==c?c:.5),s.appendTo(V.document.bH())},F=function(){if(w){var e=V.document.getWindow();w.remove(),e.removeListener("resize",u),W.ie6Compat&&e.$.setTimeout(function(){var e=window.onscroll&&window.onscroll.lw;window.onscroll=e||null},0),u=null}},k={},C=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,i=e.data.$.shiftKey,o=String.fromCharCode(e.data.$.keyCode),a=k[(t?"bP+":"")+(n?"eJ+":"")+(i?"dy+":"")+o];a&&a.length&&((a=a[a.length-1]).keydown&&a.keydown.call(a.bf,a.dialog,a.iK),e.data.preventDefault())},x=function(e){var t=e.data.$.ctrlKey||e.data.$.metaKey,n=e.data.$.altKey,i=e.data.$.shiftKey,o=String.fromCharCode(e.data.$.keyCode),a=k[(t?"bP+":"")+(n?"eJ+":"")+(i?"dy+":"")+o];a&&a.length&&(a=a[a.length-1]).keyup&&(a.keyup.call(a.bf,a.dialog,a.iK),e.data.preventDefault())},E=function(e,t,n,i,o){(k[n]||(k[n]=[])).push({bf:e,dialog:t,iK:n,keyup:o||e.eZ,keydown:i||e.iU})},S=function(e){for(var t in k){for(var n=k[t],i=n.length-1;0<=i;i--)n[i].dialog!=e&&n[i].bf!=e||n.splice(i,1);0===n.length&&delete k[t]}},N=function(e,t){e._.iX[t]&&e.selectPage(e._.iX[t])},D=function(e,t){},T={27:1,13:1},R=function(e){e.data.db()in T&&e.data.stopPropagation()};function $(e,t){function n(){o(this),t(this)}function i(){o(this)}var o=function(e){e.removeListener("ok",n),e.removeListener("cancel",i)};e.on("ok",n),e.on("cancel",i)}je.dialog={bf:function(e,t,n,i,o,a,r){if(!(arguments.length<4)){var l,s=(i.call?i(t):i)||"div",d=["<",s," "],c=(o&&o.call?o(t):o)||{},u=(a&&a.call?a(t):a)||{},f=(r&&r.call?r(e,t):r)||"",p=this.oJ=u.id||G.getNextNumber()+"_uiElement";this.id=t.id;u.id=p;var h={};t.type&&(h["cke_dialog_ui_"+t.type]=1),t.className&&(h[t.className]=1);var m=u.class&&u.class.split?u.class.split(" "):[];for(l=0;l<m.length;l++)m[l]&&(h[m[l]]=1);var g=[];for(l in h)g.push(l);u.class=g.join(" "),t.title&&(u.title=t.title);var v=(t.style||"").split(";");for(l in c)v.push(l+":"+c[l]);for(t.hidden&&v.push("display:none"),l=v.length-1;0<=l;l--)""===v[l]&&v.splice(l,1);for(l in 0<v.length&&(u.style=(u.style?u.style+"; ":"")+v.join("; ")),u)d.push(l+'="'+G.htmlEncode(u[l])+'" ');d.push(">",f,"</",s,">"),n.push(d.join("")),(this._||(this._={})).dialog=e,"boolean"==typeof t.isChanged&&(this.isChanged=function(){return t.isChanged}),"function"==typeof t.isChanged&&(this.isChanged=t.isChanged),V.event.du(this),this.nc(t),this.eZ&&this.iU&&t.accessKey&&E(this,e,"bP+"+t.accessKey);var b=this;e.on("load",function(){b.getInputElement()&&b.getInputElement().on("focus",function(){e._.eC=!1,e._.hasFocus=!0,b.oW("focus")},b)}),this.eA&&(this.cQ=e._.eO.push(this)-1,this.on("focus",function(){e._.aW=b.cQ})),G.extend(this,t)}},hbox:function(e,t,i,n,o){if(!(arguments.length<4)){this._||(this._={});this._.children=t;var a,r=o&&o.widths||null,l=o&&o.height||null;je.dialog.bf.call(this,e,o||{type:"hbox"},n,"table",{},o&&o.align?{align:o.align}:null,function(){var e=['<tbody><tr class="cke_dialog_ui_hbox">'];for(a=0;a<i.length;a++){var t="cke_dialog_ui_hbox_child",n=[];0===a&&(t="cke_dialog_ui_hbox_first"),a==i.length-1&&(t="cke_dialog_ui_hbox_last"),e.push('<td class="',t,'" '),r?r[a]&&n.push("width:"+G.cssLength(r[a])):n.push("width:"+Math.floor(100/i.length)+"%"),l&&n.push("height:"+G.cssLength(l)),o&&null!=o.padding&&n.push("padding:"+G.cssLength(o.padding)),0<n.length&&e.push('style="'+n.join("; ")+'" '),e.push(">",i[a],"</td>")}return e.push("</tr></tbody>"),e.join("")})}},vbox:function(i,e,o,t,a){if(!(arguments.length<3)){this._||(this._={});this._.children=e;var r=a&&a.width||null,l=a&&a.vY||null;je.dialog.bf.call(this,i,a||{type:"vbox"},t,"div",null,null,function(){var e=['<table cellspacing="0" border="0" '];e.push('style="'),a&&a.expand&&e.push("height:100%;"),e.push("width:"+G.cssLength(r||"100%"),";"),e.push('"'),e.push('align="',G.htmlEncode(a&&a.align||("ltr"==i.eY().lang.dir?"left":"right")),'" '),e.push("><tbody>");for(var t=0;t<o.length;t++){var n=[];e.push("<tr><td "),r&&n.push("width:"+G.cssLength(r||"100%")),l?n.push("height:"+G.cssLength(l[t])):a&&a.expand&&n.push("height:"+Math.floor(100/o.length)+"%"),a&&null!=a.padding&&n.push("padding:"+G.cssLength(a.padding)),0<n.length&&e.push('style="',n.join("; "),'" '),e.push(' class="cke_dialog_ui_vbox_child">',o[t],"</td></tr>")}return e.push("</tbody></table>"),e.join("")})}}},je.dialog.bf.prototype={getElement:function(){return V.document.getById(this.oJ)},getInputElement:function(){return this.getElement()},getDialog:function(){return this._.dialog},setValue:function(e){return this.getInputElement().setValue(e),this.oW("change",{value:e}),this},getValue:function(){return this.getInputElement().getValue()},isChanged:function(){return!1},selectParentTab:function(){for(var e,t=this.getInputElement();(t=t.getParent())&&-1==t.$.className.search("cke_dialog_page_contents"););return t&&(e=t.getAttribute("name"),this._.dialog._.gx!=e&&this._.dialog.selectPage(e)),this},focus:function(){return this.selectParentTab().getInputElement().focus(),this},nc:function(e){function t(e,t,n,i){t.on("load",function(){e.getInputElement().on(n,i,e)})}var n,i=/^on([A-Z]\w+)/;for(var o in e)(n=o.match(i))&&(this.dm[o]?this.dm[o].call(this,this._.dialog,e[o]):t(this,this._.dialog,n[1].toLowerCase(),e[o]));return this},dm:{onLoad:function(e,t){e.on("load",t,this)},onShow:function(e,t){e.on("show",t,this)},onHide:function(e,t){e.on("hide",t,this)}},iU:function(e,t){this.focus()},eZ:function(e,t){},disable:function(){var e=this.getInputElement();e.setAttribute("disabled","true"),e.addClass("cke_disabled")},enable:function(){var e=this.getInputElement();e.removeAttribute("disabled"),e.removeClass("cke_disabled")},isEnabled:function(){return!this.getInputElement().getAttribute("disabled")},isVisible:function(){return this.getInputElement().isVisible()},fM:function(){return!(!this.isEnabled()||!this.isVisible())}},je.dialog.hbox.prototype=G.extend(new je.dialog.bf,{getChild:function(e){return arguments.length<1?this._.children.concat():(e.splice||(e=[e]),e.length<2?this._.children[e[0]]:this._.children[e[0]]&&this._.children[e[0]].getChild?this._.children[e[0]].getChild(e.slice(1,e.length)):null)}},!0),je.dialog.vbox.prototype=new je.dialog.hbox,t={dQ:function(e,t,n){for(var i,o=t.children,a=[],r=[],l=0;l<o.length&&(i=o[l]);l++){var s=[];a.push(s),r.push(V.dialog._.gv[i.type].dQ(e,i,s))}return new je.dialog[t.type](e,r,a,n,t)}},V.dialog.addUIElement("hbox",t),V.dialog.addUIElement("vbox",t),V.rB=function(e){this.ry=e},V.rB.prototype={exec:function(e){e.openDialog(this.ry)},sG:!1},f=/^([a]|[^a])+$/,p=/^\d*$/,b=/^\d*(?:\.\d+)?$/,V.sg=1,V.jb=2,V.dialog.validate={functions:function(){return function(){var e,t=this&&this.getValue?this.getValue():arguments[0],n=void 0,i=V.jb,o=[];for(e=0;e<arguments.length&&"function"==typeof arguments[e];e++)o.push(arguments[e]);e<arguments.length&&"string"==typeof arguments[e]&&(n=arguments[e],e++),e<arguments.length&&"number"==typeof arguments[e]&&(i=arguments[e]);var a=i==V.jb;for(e=0;e<o.length;e++)a=i==V.jb?a&&o[e](t):a||o[e](t);return!!a||(void 0!==n&&alert(n),this&&(this.select||this.focus)&&(this.select||this.focus()),!1)}},regex:function(t,n){return function(){var e=this&&this.getValue?this.getValue():arguments[0];return!!t.test(e)||(void 0!==n&&alert(n),this&&(this.select||this.focus)&&(this.select?this.select():this.focus()),!1)}},notEmpty:function(e){return this.regex(f,e)},integer:function(e){return this.regex(p,e)},number:function(e){return this.regex(b,e)},equals:function(t,e){return this.functions(function(e){return e==t},e)},notEqual:function(t,e){return this.functions(function(e){return e!=t},e)}},G.extend(V.application.prototype,{openDialog:function(e,t,n){var i=V.dialog._.ev[e];if("function"==typeof i){var o=this._.oB||(this._.oB={}),a=o[e]||(o[e]=new V.dialog(this,e));return t&&t.call(a,a),this._.activeElement||(this._.activeElement=this.document.$.activeElement),this._.oO||(this._.oO=this.ld["filesview.filesview"].tools.oO()),a.show(),a}if("failed"==i)throw new Error('[CKFINDER.dialog.openDialog] Dialog "'+e+'" failed when loading dg.');var r=V.document.bH(),l=r.$.style.cursor,s=this;return r.setStyle("cursor","wait"),V.scriptLoader.load(V.getUrl(i),function(){"function"!=typeof V.dialog._.ev[e]&&(V.dialog._.ev[e]="failed"),s.openDialog(e,t),r.setStyle("cursor",l)},null,null,n),null},hs:function(t,n,i,o){var a=this;setTimeout(function(){a.cg.openDialog("Input",function(e){e.show(),e.setTitle(t||a.lang.common.inputTitle),e.getContentElement("tab1","msg").getElement().setHtml(n),e.getContentElement("tab1","input").setValue(i),$(e,function(e){var t=e.getContentElement("tab1","input").getValue();o(t)})})},0)},msgDialog:function(t,n,i){var o=this;setTimeout(function(){o.cg.openDialog("Msg",function(e){e.show(),e.setTitle(t||o.lang.common.messageTitle),e.getContentElement("tab1","msg").getElement().setHtml(n),i&&$(e,function(e){i()})})},0)},fe:function(t,n,i){var o=this;setTimeout(function(){o.cg.openDialog("Confirm",function(e){e.show(),e.setTitle(t||o.lang.common.confirmationTitle),e.getContentElement("tab1","msg").getElement().setHtml(n),$(e,function(e){i()})})},0)},skippedFilesDialog:function(r,l,s,d){var c=this;setTimeout(function(){c.cg.openDialog("SkippedFiles",function(e){e.show(),e.setTitle(r||c.lang.common.messageTitle),s?(e.getContentElement("tab1","msg").getElement().show(),e.getContentElement("tab1","msg").getElement().setHtml(s)):e.getContentElement("tab1","msg").getElement().hide();var t="",n="cke_files_list",i="",o=l.length;3<o&&(n+=" cke_files_list_many",i=' style="height: '+Math.min(o+.1,20)+'em"');for(var a=0;a<o;a++)t+="<li>"+G.escapeHtml("string"==typeof l[a]?l[a]:l[a].getAttribute("name"))+"</li>";e.getContentElement("tab1","skippedList").getElement().setHtml('<ul class="'+n+'"'+i+">"+t+"</ul>"),d&&$(e,function(){d()})})},0)}}),j.add("dialog",{bM:["dialogui"],onLoad:function(){V.dialog.add("Confirm",function(e){return{title:e.lang.common.confirmationTitle,minWidth:270,minHeight:60,contents:[{id:"tab1",elements:[{type:"html",html:"",id:"msg"}]}],buttons:[CKFinder.dialog.okButton,CKFinder.dialog.cancelButton]}}),V.dialog.add("Msg",function(e){return{title:e.lang.common.messageTitle,minWidth:270,minHeight:60,contents:[{id:"tab1",elements:[{type:"html",html:"",id:"msg"}]}],buttons:[CKFinder.dialog.okButton]}}),V.dialog.add("Input",function(e){return{title:e.lang.common.inputTitle,minWidth:270,minHeight:60,contents:[{id:"tab1",elements:[{type:"html",html:"",id:"msg"},{type:"text",id:"input"}]}],buttons:[CKFinder.dialog.okButton,CKFinder.dialog.cancelButton]}}),V.dialog.add("SkippedFiles",function(e){return{title:e.lang.common.messageTitle,minWidth:400,minHeight:100,contents:[{id:"tab1",style:W.ie7Compat?"height: auto":"",expand:!0,padding:0,elements:[{type:"vbox",expand:!0,children:[{type:"html",className:"cke_dialog_msg",html:"",id:"msg"},{type:"html",id:"skippedDescription",className:"cke_dialog_msg",html:e.lang.SkippedFiles},{type:"html",id:"skippedList",className:"cke_dialog_msg",html:""}]}]}],buttons:[CKFinder.dialog.okButton]}})}})}(),j.add("dialogui"),we={dQ:function(e,t,n){return new je.dialog.ju(e,t,n)}},_e={dQ:function(e,t,n){return new je.dialog[t.type](e,t,n)}},Fe={isChanged:function(){return this.getValue()!=this.lu()},reset:function(){this.setValue(this.lu())},jW:function(){this._.hq=this.getValue()},ki:function(){this._.hq=this._.default},lu:function(){return this._.hq}},ke=G.extend({},je.dialog.bf.prototype.dm,{onChange:function(e,t){this._.pL||(e.on("load",function(){this.getInputElement().on("change",function(){this.oW("change",{value:this.getValue()})},this)},this),this._.pL=!0),this.on("change",t)}},!0),Ce=/^on([A-Z]\w+)/,G.extend(je.dialog,{dD:function(n,i,e,o){if(!(arguments.length<4)){var a=Ct.call(this,i);a.hz=G.getNextNumber()+"_label";this._.children=[];je.dialog.bf.call(this,n,i,e,"div",null,null,function(){var e=[];if("horizontal"!=i.uC)e.push('<div class="cke_dialog_ui_labeled_label" id="',a.hz,'" >',i.label,"</div>",'<div class="cke_dialog_ui_labeled_content">',o(n,i),"</div>");else{var t={type:"hbox",widths:i.widths,padding:0,children:[{type:"html",html:'<span class="cke_dialog_ui_labeled_label" id="'+a.hz+'">'+G.htmlEncode(i.label)+"</span>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content">'+o(n,i)+"</span>"}]};V.dialog._.gv.hbox.dQ(n,t,e)}return e.join("")})}},ju:function(t,n,e){if(!(arguments.length<3)){Ct.call(this,n);var i=this._.le=G.getNextNumber()+"_textInput",o={class:"cke_dialog_ui_input_"+n.type,id:i,type:"text"};n.validate&&(this.validate=n.validate),n.maxLength&&(o.uy=n.maxLength),n.size&&(o.size=n.size);var a=this,r=!1;t.on("load",function(){a.getInputElement().on("keydown",function(e){13==e.data.db()&&(r=!0)}),a.getInputElement().on("keyup",function(e){13==e.data.db()&&r&&(t.getButton("ok")&&setTimeout(function(){t.getButton("ok").click()},0),r=!1)},null,null,1e3)});je.dialog.dD.call(this,t,n,e,function(){var e=['<div class="cke_dialog_ui_input_',n.type,'"'];for(var t in n.width&&e.push('style="width:'+n.width+'" '),e.push("><input "),o)e.push(t+'="'+o[t]+'" ');return e.push(" /></div>"),e.join("")})}},textarea:function(e,t,n){if(!(arguments.length<3)){Ct.call(this,t);var i=this,o=this._.le=G.getNextNumber()+"_textarea",a={};t.validate&&(this.validate=t.validate),a.rows=t.rows||5,a.cols=t.cols||20;je.dialog.dD.call(this,e,t,n,function(){var e=['<div class="cke_dialog_ui_input_textarea"><textarea class="cke_dialog_ui_input_textarea" id="',o,'" '];for(var t in a)e.push(t+'="'+G.htmlEncode(a[t])+'" ');return e.push(">",G.htmlEncode(i._.default),"</textarea></div>"),e.join("")})}},checkbox:function(i,o,e){if(!(arguments.length<3)){var a=Ct.call(this,o,{default:!!o.default});o.validate&&(this.validate=o.validate);je.dialog.bf.call(this,i,o,e,"span",null,null,function(){var e=G.extend({},o,{id:o.id?o.id+"_checkbox":G.getNextNumber()+"_checkbox"},!0),t=[],n={class:"cke_dialog_ui_checkbox_input",type:"checkbox"};return xt(e),o.default&&(n.checked="checked"),a.checkbox=new je.dialog.bf(i,e,t,"input",null,n),t.push(' <label for="',n.id,'">',G.htmlEncode(o.label),"</label>"),t.join("")})}},radio:function(u,f,e){if(!(arguments.length<3)){Ct.call(this,f),this._.default||(this._.default=this._.hq=f.items[0][1]),f.validate&&(this.validate=f.sh);var p=[],h=this;je.dialog.dD.call(this,u,f,e,function(){for(var e=[],t=[],n=f.id?f.id+"_radio":G.getNextNumber()+"_radio",i=0;i<f.items.length;i++){var o=f.items[i],a=void 0!==o[2]?o[2]:o[0],r=void 0!==o[1]?o[1]:o[0],l=G.extend({},f,{id:G.getNextNumber()+"_radio_input",title:null,type:null},!0),s=G.extend({},l,{id:null,title:a},!0),d={type:"radio",class:"cke_dialog_ui_radio_input",name:n,value:r},c=[];h._.default==r&&(d.checked="checked"),xt(l),xt(s),p.push(new je.dialog.bf(u,l,c,"input",null,d)),c.push(" "),new je.dialog.bf(u,s,c,"label",null,{for:d.id},o[0]),e.push(c.join(""))}return new je.dialog.hbox(u,[],e,t),t.join("")}),this._.children=p}},button:function(e,t,n){if(arguments.length){"function"==typeof t&&(t=t(e.eY())),Ct.call(this,t,{disabled:t.disabled||!1}),V.event.du(this);var i=this;e.on("load",function(e){var t=this.getElement();t.on("click",function(e){i.oW("click",{dialog:i.getDialog()}),e.data.preventDefault()}),t.unselectable()},this);var o=G.extend({},t);delete o.style,je.dialog.bf.call(this,e,o,n,"a",null,{style:t.style,href:"javascript:void(0)",title:t.label,hp:"true",class:t.class},'<span class="cke_dialog_ui_button">'+G.htmlEncode(t.label)+"</span>")}},select:function(r,l,e){if(!(arguments.length<3)){var s=Ct.call(this,l);l.validate&&(this.validate=l.validate);je.dialog.dD.call(this,r,l,e,function(){var e=G.extend({},l,{id:l.id?l.id+"_select":G.getNextNumber()+"_select"},!0),t=[],n=[],i={class:"cke_dialog_ui_input_select"};null!=l.size&&(i.size=l.size),null!=l.multiple&&(i.multiple=l.multiple),xt(e);for(var o,a=0;a<l.items.length&&(o=l.items[a]);a++)n.push('<option value="',G.htmlEncode(void 0!==o[1]?o[1]:o[0]),'" /> ',G.htmlEncode(o[0]));return s.select=new je.dialog.bf(r,e,t,"select",null,i,n.join("")),t.join("")})}},file:function(e,n,t){if(!(arguments.length<3)){void 0===n.default&&(n.default="");var i=G.extend(Ct.call(this,n),{dg:n,buttons:[]});n.validate&&(this.validate=n.validate);e.on("load",function(){V.document.getById(i.gL).getParent().addClass("cke_dialog_ui_input_file")}),je.dialog.dD.call(this,e,n,t,function(){i.gL=G.getNextNumber()+"_fileInput";var e=W.isCustomDomain(),t=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" id="',i.gL,'" title="',n.label,'" src="javascript:void('];return t.push(e?"(function(){document.open();document.domain='"+document.domain+"';document.close();})()":"0"),t.push(')"></iframe>'),t.join("")})}},fileButton:function(n,i,e){if(!(arguments.length<3)){Ct.call(this,i);var t=this;i.validate&&(this.validate=i.validate);var o=G.extend({},i),a=o.onClick;o.className=(o.className?o.className+" ":"")+"cke_dialog_ui_button",o.onClick=function(e){var t=i.for;a&&!1===a.call(this,e)||(n.getContentElement(t[0],t[1]).submit(),this.disable())},n.on("load",function(){n.getContentElement(i.for[0],i.for[1])._.buttons.push(t)}),je.dialog.button.call(this,n,o,e)}},html:(ve=/^\s*<[\w:]+\s+([^>]*)?>/,be=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,ye=/\/$/,function(e,t,n){if(!(arguments.length<3)){var i,o,a=[],r=t.html;if("<"!=r.charAt(0)&&(r="<span>"+r+"</span>"),t.focus){var l=this.focus;if(this.focus=function(){l.call(this),t.focus.call(this),this.oW("focus")},t.fM){var s=this.fM;this.fM=s}this.eA=!0}je.dialog.bf.call(this,e,t,a,"span",null,null,""),i=a.join("").match(ve),o=r.match(be)||["","",""],ye.test(o[1])&&(o[1]=o[1].slice(0,-1),o[2]="/"+o[2]),n.push([o[1]," ",i[1]||"",o[2]].join(""))}})},!0),je.dialog.html.prototype=new je.dialog.bf,je.dialog.dD.prototype=G.extend(new je.dialog.bf,{rW:function(e){var t=V.document.getById(this._.hz);return t.iu()<1?new w.text(e,V.document).appendTo(t):t.getChild(0).$.nodeValue=e,this},vt:function(){var e=V.document.getById(this._.hz);return!e||e.iu()<1?"":e.getChild(0).getText()},dm:ke},!0),je.dialog.button.prototype=G.extend(new je.dialog.bf,{click:function(){return this._.disabled?(this.getElement().$.blur(),!1):this.oW("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var e=this.getElement();e&&e.removeClass("disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},dm:G.extend({},je.dialog.bf.prototype.dm,{onClick:function(e,t){this.on("click",t)}},!0),eZ:function(){this.click()},iU:function(){this.focus()},eA:!0},!0),je.dialog.ju.prototype=G.extend(new je.dialog.dD,{getInputElement:function(){return V.document.getById(this._.le)},focus:function(){var t=this.selectParentTab();setTimeout(function(){var e=t.getInputElement();e&&e.$.focus()},0)},select:function(){var t=this.selectParentTab();setTimeout(function(){var e=t.getInputElement();e&&(e.$.focus(),e.$.select())},0)},eZ:function(){this.select()},setValue:function(e){return e=null!==e?e:"",je.dialog.bf.prototype.setValue.call(this,e)},eA:!0},Fe,!0),je.dialog.textarea.prototype=new je.dialog.ju,je.dialog.select.prototype=G.extend(new je.dialog.dD,{getInputElement:function(){return this._.select.getElement()},add:function(e,t,n){var i=new Y("option",this.getDialog().eY().document),o=this.getInputElement().$;return i.$.text=e,i.$.value=null==t?e:t,null==n?L?o.add(i.$):o.add(i.$,null):o.add(i.$,n),this},remove:function(e){return this.getInputElement().$.remove(e),this},clear:function(){for(var e=this.getInputElement().$;0<e.length;)e.remove(0);return this},eA:!0},Fe,!0),je.dialog.checkbox.prototype=G.extend(new je.dialog.bf,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(e){this.getInputElement().$.checked=e,this.oW("change",{value:e})},getValue:function(){return this.getInputElement().$.checked},eZ:function(){this.setValue(!this.getValue())},dm:{onChange:function(e,t){return L?(e.on("load",function(){var t=this._.checkbox.getElement();t.on("propertychange",function(e){"checked"==(e=e.data.$).propertyName&&this.oW("change",{value:t.$.checked})},this)},this),this.on("change",t),null):ke.onChange.apply(this,arguments)}},eA:!0},Fe,!0),je.dialog.radio.prototype=G.extend(new je.dialog.bf,{setValue:function(e){for(var t,n=this._.children,i=0;i<n.length&&(t=n[i]);i++)t.getElement().$.checked=t.getValue()==e;this.oW("change",{value:e})},getValue:function(){for(var e=this._.children,t=0;t<e.length;t++)if(e[t].getElement().$.checked)return e[t].getValue();return null},eZ:function(){var e,t=this._.children;for(e=0;e<t.length;e++)if(t[e].getElement().$.checked)return void t[e].getElement().focus();t[0].getElement().focus()},dm:{onChange:function(e,t){return L?(e.on("load",function(){for(var e=this._.children,t=this,n=0;n<e.length;n++){e[n].getElement().on("propertychange",function(e){"checked"==(e=e.data.$).propertyName&&this.$.checked&&t.oW("change",{value:this.getAttribute("value")})})}},this),this.on("change",t),null):ke.onChange.apply(this,arguments)}},eA:!0},Fe,!0),je.dialog.file.prototype=G.extend(new je.dialog.dD,Fe,{getInputElement:function(){var e=V.document.getById(this._.gL).getFrameDocument();return 0<e.$.forms.length?new Y(e.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},vy:function(e){return this.getInputElement().getParent().$.action},reset:function(){var n=V.document.getById(this._.gL).getFrameDocument(),i=this._.dg,o=this._.buttons;function e(){n.$.open(),W.isCustomDomain()&&(n.$.domain=document.domain);var e="";i.size&&(e=i.size-(L?7:0)),n.$.write(['<html><head><title></title></head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" action="',G.htmlEncode(i.action),'">','<input type="file" name="',G.htmlEncode(i.id||"cke_upload"),'" size="',G.htmlEncode(0<e?e:""),'" />',"</form>","</body></html>"].join("")),n.$.close();for(var t=0;t<o.length;t++)o[t].enable()}W.gecko?setTimeout(e,500):e()},getValue:function(){return""},dm:ke,eA:!0},!0),je.dialog.fileButton.prototype=new je.dialog.button,V.dialog.addUIElement("text",we),V.dialog.addUIElement("password",we),V.dialog.addUIElement("textarea",_e),V.dialog.addUIElement("checkbox",_e),V.dialog.addUIElement("radio",_e),V.dialog.addUIElement("button",_e),V.dialog.addUIElement("select",_e),V.dialog.addUIElement("file",_e),V.dialog.addUIElement("fileButton",_e),V.dialog.addUIElement("html",_e),G.extend(CKFinder.dialog,V.dialog),j.add("help",{bM:["toolbar","button"],bz:function(e){e.config.disableHelpButton||(e.bD("help",{exec:function(e){e.ld["filesview.filesview"].bn().focus(),window.open(V.basePath+"help/"+(e.lang.HelpLang||"en")+"/index.html")}}),e.bY.add("Help",V.UI_BUTTON,{label:e.lang.Help,command:"help"}))}}),De=Ne=0,Te=[],CKFinder.addPlugin("gallery",{bM:["filesview"],appReady:function(){De=Ne=0,Te=[],Ee=xe=null},galleryCallback:function(e,t,n){De||Wt(null,e);var i=St(e),o=i.getWindow().$,a=function(e){return e.isImage()};if(!Ne&&e.config.gallery_autoLoad){if(!a(t))return!1;var r,l=i.getHead(),s=CKFinder.getPluginPath("gallery")+"colorbox/",d=arguments,c=void 0===o.jQuery;if(!c){var u=o.jQuery.fn.jquery.split("."),f=parseInt(u[0],10),p=parseInt(u[1],10),h=parseInt(u[2]||0,10);(f<1||1==f&&p<4||1==f&&4==p&&h<3)&&(c=!0)}return c?(o.jQuery&&(Te=[o.jQuery,o.$]),(r=new Y("script",i)).setAttribute("type","text/javascript"),r.setAttribute("src",s+"jquery.min.js"),$t(r,d,o),r.appendTo(l),!0):(i.appendStyleSheet(s+"colorbox.css"),(r=new Y("script",i)).setAttribute("type","text/javascript"),r.setAttribute("src",s+"jquery.colorbox-min.js"),$t(r,d,o),r.appendTo(l),!0)}if(Te.length&&(xe=o.jQuery.noConflict(!0),o.jQuery=Te[0],o.$=Te[1],Te=[]),xe=xe||o.jQuery,Ne){var m,g=G.getRandomString(20),v="ckf_gallery_"+g;switch(Ne){case 1:if(!a(t))return!1;m=Et(n,t,v,a,i),xe("#"+Se+" a").colorbox(G.extend({minWidth:"300",minHeight:"200",maxWidth:"95%",maxHeight:"95%",scalePhotos:!0,current:e.lang.Gallery.current},e.config.gallery_config,{rel:v,group:v,onClosed:Tt(t),onOpen:Nt(i)},!0)).eq(m).click();break;case 2:if(!(a=function(e){return e.isImage()||"swf"==e.ext})(t))return!1;m=Et(n,t,v,a,i),o.jQuery("#"+Se+" a").fancybox(G.extend({},e.config.gallery_config,{onClosed:Dt,onComplete:Nt(i),afterClose:Tt(t),afterShow:Nt(i)},!0)).eq(m).click();break;case 3:if(!(a=function(e){return e.isImage()||"swf"==e.ext||"mov"==e.ext})(t))return!1;m=Et(n,t,"prettyPhoto[ckf_gallery_"+g+"]",a,i),o.jQuery("#"+Se+" a").prettyPhoto(G.extend({},e.config.gallery_config,{callback:Tt(t),changepicturecallback:Nt(i)},!0)).eq(m).click();break;case 4:if(!(a=function(e){return e.isImage()||"swf"==e.ext||"mov"==e.ext})(t))return!1;m=Et(n,t,v,a,i),o.Shadowbox.qi("#"+Se+" a",G.extend({},e.config.gallery_config,{gallery:v,onClose:Tt(t),onFinish:Nt(i)},!0)),Rt(Ee.eG("a").getItem(m).$);break;case 5:if(!a(t))return!1;m=Et(n,t,"lightbox[ckf_gallery_"+g+"]",a,i),Rt(Ee.eG("a").getItem(m).$);break;default:return!1}return!0}return!1},bz:Wt}),U.gallery_autoLoad=!0,Re="ckCsrfToken","function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){for(var e=this.replace(/^\s+/,""),t=e.length-1;0<=t;t--)if(/\S/.test(e.charAt(t))){e=e.substring(0,t+1);break}return e}),V.getCsrfToken=function(){var e,t,n,i=function(e){e=e.toLowerCase();for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var i=t[n].split("="),o=decodeURIComponent(i[0].trim().toLowerCase()),a=1<i.length?i[1]:"";if(o===e)return decodeURIComponent(a)}return""}(Re);return 40!=i.length&&(n=40,i=G.getRandomString(n),e=Re,t=i,document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/"),i},j.add("csrftokenmanager"),We=$e=null,j.add("maximize",{bz:function(b){var y,w,_,F=b.lang.Maximize,k=V.oC.getWindow(),C=[0,0,0,0],x={};y=V.document.getWindow().$;try{y=y.frameElement}catch(e){y=null}function E(e){var t=k.eR();if(!e&&y&&(e=[y]),e){for(var n=0,i=e.length;n<i;n++)e[n].setStyles({width:t.width+"px",height:t.height+"px"});b.oW("resize")}else b.resize(t.width,t.height)}(y=y&&new Y(y))&&!y.getFrameDocument().bH().hasClass("CKFinderFrameWindow")&&(y=null),b.bD("maximize",{oD:!1,exec:function(){var e,t,n,i,o=b.document.getWindow().$;if(b.cg.inPopup&&(!L&&!W.opera||o.top.location.href.match(/ckfinder.html/)||"CKFinderpopup"==o.top.name)){o=b.document.getWindow().$.parent;this.bu==V.aS?(C[2]=o.screenLeft||o.screenX,C[3]=o.screenTop||o.screenY,o.moveTo(0,0),We=We||[o.screenLeft||o.screenX,o.screenTop||o.screenY],C[2]-=We[0],C[3]-=We[1],o.outerHeight?(C[0]=o.outerWidth,C[1]=o.outerHeight):(C[0]=o.document.body.scrollWidth,C[1]=o.document.body.scrollHeight,$e||(o.resizeTo(o.screen.availWidth,o.screen.availHeight),$e=[o.screen.availWidth-o.document.body.scrollWidth,o.screen.availHeight-o.document.body.scrollHeight]),C[0]+=$e[0],C[1]+=$e[1]),o.resizeTo?o.resizeTo(o.screen.availWidth,o.screen.availHeight):(o.outerHeight=o.screen.availHeight,o.outerWidth=o.screen.availWidth)):(o.resizeTo?o.resizeTo(C[0],C[1]):(o.outerWidth=C[0],o.outerHeight=C[1]),o.moveTo(C[2],C[3]))}else{var a=y||b.container;if(this.bu==V.aS){w=k.hV();for(var r,l=a;l=l.getParent();)r=G.getNextNumber(),x[r]=Ot(l),l.$.og=r,l.is("html","body")&&l.setStyle("overflow","hidden"),l.setStyle("z-index",b.config.baseFloatZIndex-1);r=G.getNextNumber(),x[r]=Ot(a,!0),a.$.og=r;var s=[a];for(o=a.getDocument().getWindow().$;o.frameElement;)s.push(Y.eB(o.frameElement)),o=o.parent;_=function(){E(s)},k.on("resize",_);var d,c=new I(o.document),u={overflow:W.webkit?"":"hidden",width:0,height:0};c.gT().setStyles(u),W.gecko||c.gT().setStyle("position","fixed"),c.bH().setStyles(u),L?setTimeout(function(){k.$.scrollTo(0,0)},0):k.$.scrollTo(0,0);for(var f=0,p=s.length;f<p;f++)(d=s[f]).setStyle("position","absolute"),d.$.offsetLeft,d.setStyles({"z-index":b.config.baseFloatZIndex-1,left:"0px",top:"0px"});s[0].addClass("cke_maximized"),E(s);var h=s[0].ir();s[0].setStyles({left:-1*h.x+"px",top:-1*h.y+"px"})}else{k.removeListener("resize",_);for(l=a;l;)t=x[(e=l).$.og],i=void 0,n=Lt(e),i=e.$,"class"in t&&(i.className=t.class),"inline"in t&&(i.style.cssText=t.inline),It(n),l.$.og=null,l=l.getParent();x={},L?setTimeout(function(){k.$.scrollTo(w.x,w.y)},0):k.$.scrollTo(w.x,w.y),a.removeClass("cke_maximized"),W.webkit&&(a.setStyle("display","inline"),setTimeout(function(){a.setStyle("display","block")},0)),b.oW("resize")}}this.rJ();var m=this.pW[0];if(m){var g=this.bu==V.aS?F.maximize:F.minimize,v=b.document.getById(m._.id);v.getChild(1).setHtml(g),v.setAttribute("title",g),v.setAttribute("href",'javascript:void("'+g+'");')}}}),b.bY.qW("Maximize",{label:F.maximize,command:"maximize"})}}),Le={},CKFinder.addPlugin("zip",{uiReady:function(u){var f=u.lang.Zip;CKFinder.dialog.add("compressToFileName",function(e){var t=e.getSelectedFolder();return{title:e.lang.DestinationFile,minWidth:270,minHeight:60,contents:[{id:"tab1",label:"",title:"",expand:!0,style:CKFinder.env.ie7Compat?"height:auto":"",padding:0,elements:[{id:"msg",className:"cke_dialog_error_msg",type:"html",html:e.lang.FileRename},{type:"hbox",widths:["90%","10%"],padding:0,children:[{type:"text",label:"",id:"fileName",default:t.name,validate:function(){if(!this.getValue())return e.openMsgDialog("",e.lang.ErrorMsg.FileEmpty),!1}},{type:"html",html:".zip",id:"fileNameExt",onLoad:function(){this.getElement().getParent().setStyles({"vertical-align":"bottom","padding-bottom":"2px"})}}]}]}],buttons:[CKFinder.dialog.okButton,CKFinder.dialog.cancelButton]}}),CKFinder.dialog.add("unzipDirExists",function(t){var e=t.getSelectedFolder(),n=[[t.lang.ManuallyRename,"manuallyrename"]];return e.acl.fileDelete&&e.acl.fileRename&&e.acl.folderRename&&e.acl.folderDelete&&n.push([f.removeAndExtract,"overwrite"],[f.extractAndOverwrite,"merge"]),{title:t.lang.ErrorMsg.FolderNameExists,minWidth:270,minHeight:60,contents:[{id:"tab1",label:"",title:"",expand:!0,style:CKFinder.env.ie7Compat?"height:auto":"",padding:0,elements:[{id:"msg",className:"cke_dialog_error_msg",type:"html",html:""},{type:"hbox",className:"cke_dialog_file_exist_options",children:[{label:t.lang.common.makeDecision,type:"radio",id:"option",default:"manuallyrename",items:n}]}]}],onOk:function(){var e=this.getValueOf("tab1","option");return"manuallyrename"==e&&(e=null),Le.extractTo(t.getSelectedFile(),e),!0},onCancel:function(){return Le.ma(e),!0},buttons:[CKFinder.dialog.okButton,CKFinder.dialog.cancelButton]}}),CKFinder.dialog.add("unzipFileExists",function(e){var t=e.getSelectedFolder();return{title:e.lang.FileExistsDlgTitle,minWidth:350,minHeight:120,contents:[{id:"tab1",label:"",title:"",style:CKFinder.env.ie7Compat?"height:auto":"",expand:!0,padding:0,elements:[{id:"msg",className:"cke_dialog_error_msg",type:"html",widths:["70%","30%"],html:""},{type:"hbox",className:"cke_dialog_file_exist_options",children:[{type:"radio",id:"option",label:e.lang.common.makeDecision,default:"autorename",items:[[e.lang.FileAutorename,"autorename"],[e.lang.FileOverwrite,"overwrite"],[e.lang.common.skip,"skip"]]}]},{type:"hbox",className:"cke_dialog_remember_decision",children:[{type:"checkbox",id:"remember",label:e.lang.common.rememberDecision}]}]}],onCancel:function(){return Le.ma(t),!0},buttons:[CKFinder.dialog.okButton,CKFinder.dialog.cancelButton]}}),CKFinder.dialog.add("compressFileExists",function(t){var e=t.getSelectedFolder(),n=[[t.lang.ManuallyRename,"manuallyrename"]];return e.acl.fileDelete&&e.acl.fileRename&&n.push([t.lang.FileAutorename,"autorename"],[t.lang.FileOverwrite,"overwrite"]),{title:t.lang.FileExistsDlgTitle,minWidth:270,minHeight:60,contents:[{id:"tab1",label:"",title:"",expand:!0,style:CKFinder.env.ie7Compat?"height:auto":"",padding:0,elements:[{id:"msg",className:"cke_dialog_error_msg",type:"html",html:""},{type:"hbox",className:"cke_dialog_file_exist_options",children:[{label:t.lang.common.makeDecision,type:"radio",id:"option",default:"manuallyrename",items:n}]}]}],onOk:function(){var e=this.getValueOf("tab1","option");return"manuallyrename"==e&&(e=null),Le.nX(t.getSelectedFolder(),Le.pp.download,e),!0},onCancel:function(){return Le.ma(e),!0},buttons:[CKFinder.dialog.okButton,CKFinder.dialog.cancelButton]}}),u.connector.app.dZ("zip",112),Le={rQ:{iz:/[\\\/:\*\?"<>\|]/},iG:{extractHere:{label:f.extractHereLabel,command:"ExtractHere",group:"zip",icon:CKFinder.getPluginPath("zip")+"images/zip.gif"},extractTo:{label:f.extractToLabel,command:"ExtractTo",group:"zip",icon:CKFinder.getPluginPath("zip")+"images/zip.gif"},downloadZip:{label:f.downloadZipLabel,command:"DownloadZip",group:"zip",icon:CKFinder.getPluginPath("zip")+"images/zip.gif"},compressZip:{label:f.compressZipLabel,command:"CompressZip",group:"zip",icon:CKFinder.getPluginPath("zip")+"images/zip.gif"}},ma:function(t){t.getChildren(function(e){t.close(),t.showFiles(),t.open()},!0)},oc:function(e){return e&&e.length?!!Le.rQ.iz.test(e)&&u.lang.ErrorMsg.FolderInvChar:u.lang.ErrorMsg.FolderEmpty},nI:function(a){if(Le.filesList[Le.currentItem]){if(Le.filesList[Le.currentItem].options&&Ut(Le.filesList[Le.currentItem].options,[{name:"skip"},{name:"ok"}]))return Le.currentItem++,void u.openDialog("unzipFileExists",Le.nI);a.show();var e=u.lang.ErrorMsg["Folder"==Le.filesList[Le.currentItem].type?"FolderExists":"FileExists"];e="<strong>"+e.replace("%s",Le.filesList[Le.currentItem].name)+"</strong>",a.getContentElement("tab1","msg").getElement().setHtml(e),a.on("ok",function(e){e.removeListener();var t=a.getValueOf("tab1","remember"),n=a.getValueOf("tab1","option");if(!t){for(Le.filesList[Le.currentItem].options=n,Le.currentItem++;Le.currentItem<Le.filesList.length&&Le.filesList[Le.currentItem].options&&(!Le.filesList[Le.currentItem].options||"skip"==Le.filesList[Le.currentItem].options);)Le.currentItem++;return Le.currentItem<Le.filesList.length?void setTimeout(function(){u.openDialog("unzipFileExists",Le.nI)},0):void Le.extractHere(u.getSelectedFile(),!0)}for(var i=0,o=Le.filesList.length;i<o;i++)Le.filesList[i].options||(Le.filesList[i].options=n);Le.extractHere(u.getSelectedFile(),!0)})}else Le.extractHere(u.getSelectedFile(),!0)},extract:function(e){var t={},n=e.file;e.extra&&(t=e.extra),t.fileName=e.file.name,u.connector.sendCommandPost(e.action,null,t,function(e){if(Le.filesList=[],303==e.getErrorNumber()){Le.currentItem=0;for(var t,n=e.selectNodes("Connector/Errors/Error"),i=e.selectNodes("Connector/UnzippedFiles/File"),o=0,a=0,r=n.length;a<r;a++)t="skip",115==n[a].getAttribute("code")&&(o=1,t=null),Le.filesList[a]={name:n[a].getAttribute("name"),options:t,type:n[a].getAttribute("type"),code:n[a].getAttribute("code")};var l=0;for(r=i.length;l<r;l++,a++)Le.filesList[a]={name:i[l].getAttribute("name"),options:i[l].getAttribute("action"),type:"File",code:0};if(o)return void u.openDialog("unzipFileExists",Le.nI)}else if(e.checkError())return;var s=e.selectNodes("Connector/FolderExists/Folder");if(!s||!s.length){if((i=e.selectNodes("Connector/UnzippedFiles/File"))&&i.length){for(var d=[],c=(a=0,i.length);a<c;a++)"skip"==i[a].getAttribute("action")&&d.push(i[a].getAttribute("name"));if(Le.filesList)for(a=0,c=Le.filesList.length;a<c;a++)d.push(Le.filesList[a].name);if(d.length)return u.openSkippedFilesDialog(null,d,f.extractSuccess),Le.ma(u.getSelectedFolder()),!0}return u.openMsgDialog("OK",f.extractSuccess),Le.ma(u.getSelectedFolder()),!0}u.openDialog("unzipDirExists",function(e){e.show();var t=u.lang.FolderNameExists;t="<strong>"+t.replace("%s",s[0].getAttribute("name"))+"</strong>",e.getContentElement("tab1","msg").getElement().setHtml(t)})},n.folder.type,n.folder)},extractHere:function(e,t){if(t){for(var n=!1,i=0,o=Le.filesList.length;i<o;i++)if(115==Le.filesList[i].code&&"skip"!=Le.filesList[i].options){n=!0,t={};for(i=0,o=Le.filesList.length;i<o;i++)t["files["+i+"][name]"]=Le.filesList[i].name,t["files["+i+"][options]"]=Le.filesList[i].options;break}if(!n){var a=[];for(i=0,o=Le.filesList.length;i<o;i++)a.push(Le.filesList[i].name);return void u.openSkippedFilesDialog(null,a,f.extractSuccess,function(){return Le.ma(u.getSelectedFolder()),!0})}}t=t||{},Le.extract({action:"ExtractHere",file:e,extra:t})},extractTo:function(i,o){o?Le.extract({action:"ExtractTo",file:i,extra:{extractDir:Le.extractDir||"/",force:o}}):u.openInputDialog(u.lang.DestinationFolder,u.lang.FolderRename,"",function(n){var e=u.getSelectedFolder(),t=(n=CKFinder.tools.trim(n),Le.oc(n));if(t)return u.openConfirmDialog("",t,function(e){Le.extractTo(i,o)}),!1;Le.extractDir=n,e.hasChildren?e.getChildren(function(e){Ut(n,e)?u.openDialog("unzipDirExists",function(e){e.show();var t=u.lang.ErrorMsg.FolderExists;t="<strong>"+t.replace("%s",n)+"</strong>",e.getContentElement("tab1","msg").getElement().setHtml(t)}):Le.extract({action:"ExtractTo",file:i,extra:{extractDir:n}})},!0):(e.createNewFolder(n),Le.extract({action:"ExtractTo",file:i,extra:{extractDir:n}}))})},downloadZip:function(e,t,n){var i=u.connector.composeUrl("DownloadZip",{FileName:e,ZipName:t},n.type,n);u.connector.app.ld["filesview.filesview"].tools.downloadFile(new CKFinder.dom.document(u.document),i)},oH:function(n,i){u.connector.sendCommandPost("CreateZip",null,i,function(e){if(!e.checkError()){if(i.download)if(t=e.selectSingleNode("Connector/ZipFile")){var t=t.getAttribute("name");return Le.downloadZip(t,i.zipName,n)}Le.ma(n)}},n.type,n)},nX:function(o,a,e,t){var r={zipName:o.name+".zip",download:a};if(t)for(var n=0,i=t.length;n<i;n++)r["files["+n+"][name]"]=t[n].name,r["files["+n+"][type]"]=t[n].folder.type,r["files["+n+"][folder]"]=t[n].folder.getPath();if(e)return(r=Le.pp).fileExistsAction=e,Le.oH(o,r);if(o.isBasket||a){if(o.isBasket&&void 0===t){r.zipName="basket.zip";for(n=0,i=u.basketFiles.length;n<i;n++)r["files["+n+"][name]"]=u.basketFiles[n].name,r["files["+n+"][type]"]=u.basketFiles[n].folder.type,r["files["+n+"][folder]"]=u.basketFiles[n].folder.getPath()}return o.isBasket&&(o=u.folders[1],r.basket=!0),Le.oH(o,r)}u.openDialog("compressToFileName",function(i){i.show(),i.getContentElement("tab1","fileName").getElement().setValue(o.name),i.on("ok",function(e){e.removeListener();var n=i.getValueOf("tab1","fileName");n=CKFinder.tools.trim(n)+".zip";var t=Le.oc(n);if(t)return u.openConfirmDialog("",t,function(e){Le.nX(o,a)}),!1;r.zipName=n,o.getFiles(function(e){if(Ut(n,e))return Le.pp=r,u.openDialog("compressFileExists",function(e){e.show();var t=u.lang.ErrorMsg.FileExists;t="<strong>"+t.replace("%s",n)+"</strong>",e.getContentElement("tab1","msg").getElement().setHtml(t)}),!1;Le.oH(o,r)},!0)})})}},u.addFileContextMenuOption(Le.iG.extractHere,function(e,t){Le.extractHere(t)},function(e){if(u.getSelectedFolder().isBasket)return!1;var t=u.getSelectedFiles();return!("zip"!==e.ext.toLowerCase()||u.config.selectMultiple&&1<t.length)&&(!(!e.folder.acl.fileUpload||!e.folder.acl.folderCreate)||-1)}),u.addFileContextMenuOption(Le.iG.extractTo,function(e,t){Le.extractTo(t)},function(e){if(u.getSelectedFolder().isBasket)return!1;var t=u.getSelectedFiles();return!("zip"!==e.ext.toLowerCase()||u.config.selectMultiple&&1<t.length)&&(!(!e.folder.acl.fileUpload||!e.folder.acl.folderCreate)||-1)}),u.addFileContextMenuOption(Le.iG.compressZip,function(e,t){var n=e.getSelectedFiles(),i=e.getSelectedFolder();Le.nX(i,!1,!1,n)},function(e){var t=u.getSelectedFolder();if(t.isBasket)return!1;var n=u.getSelectedFiles();return!(!u.config.selectMultiple||n.length<2)&&(!!(e.folder.acl.fileUpload&&e.folder.acl.folderCreate&&t.getResourceType().isExtensionAllowed("zip"))||-1)}),u.addFileContextMenuOption(Le.iG.downloadZip,function(e,t){var n=e.getSelectedFiles(),i=e.getSelectedFolder();Le.nX(i,!0,!1,n)},function(e){var t=u.getSelectedFiles();return!(!u.config.selectMultiple||t.length<2)&&(!!e.folder.acl.fileUpload||-1)}),u.addFolderContextMenuOption(Le.iG.compressZip,function(e,t){Le.nX(t,!1)},function(e){return!e.isBasket&&(!(!e.acl.fileUpload||!e.getResourceType().isExtensionAllowed("zip")||!u.files.length&&!e.hasChildren)||-1)}),u.addFolderContextMenuOption(Le.iG.downloadZip,function(e,t){Le.nX(t,!0)},function(e){return e.isBasket?!!e.app.basketFiles.length||-1:!(!e.acl.fileUpload||!u.files.length&&!e.hasChildren)||-1}),u.connector.app.ld["filesview.filesview"].on("beforeContextMenu",function(e){1<u.getSelectedFiles().length&&delete e.data.bj.downloadFile})},basketToolbar:[["DownloadZip",{label:"downloadZipLabel",icon:CKFinder.getPluginPath("zip")+"images/zip.gif",onClick:function(e){var t=e.getSelectedFolder();t.app.basketFiles.length&&Le.nX(t,!0)},disableEmpty:!0}]]}),V.skins.add("kama",(Ie=["images/loaders/16x16.gif","images/loaders/32x32.gif","images/ckffolder.gif","images/ckffolderopened.gif"],L&&W.version<7&&Ie.push("images/sprites_ie6.png"),{ls:Ie,application:{css:["app.css"]},host:{qx:1,css:["host.css"]},mA:7,kN:7,ps:1,bz:function(s){s.config.width&&!isNaN(s.config.width)&&(s.config.width-=12);var d=[],c="/* UI Color Support */.cke_skin_kama .cke_menuitem .cke_icon_wrapper{\tbackground-color: $color !important;\tborder-color: $color !important;}.cke_skin_kama .cke_menuitem a:hover .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a:focus .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a:active .cke_icon_wrapper{\tbackground-color: $color !important;\tborder-color: $color !important;}.cke_skin_kama .cke_menuitem a:hover .cke_label,.cke_skin_kama .cke_menuitem a:focus .cke_label,.cke_skin_kama .cke_menuitem a:active .cke_label{\tbackground-color: $color !important;}.cke_skin_kama .cke_menuitem a.cke_disabled:hover .cke_label,.cke_skin_kama .cke_menuitem a.cke_disabled:focus .cke_label,.cke_skin_kama .cke_menuitem a.cke_disabled:active .cke_label{\tbackground-color: transparent !important;}.cke_skin_kama .cke_menuitem a.cke_disabled:hover .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a.cke_disabled:focus .cke_icon_wrapper,.cke_skin_kama .cke_menuitem a.cke_disabled:active .cke_icon_wrapper{\tbackground-color: $color !important;\tborder-color: $color !important;}.cke_skin_kama .cke_menuitem a.cke_disabled .cke_icon_wrapper{\tbackground-color: $color !important;\tborder-color: $color !important;}.cke_skin_kama .cke_menuseparator{\tbackground-color: $color !important;}.cke_skin_kama .cke_menuitem a:hover,.cke_skin_kama .cke_menuitem a:focus,.cke_skin_kama .cke_menuitem a:active{\tbackground-color: $color !important;}";if(W.webkit){c=c.split("}").slice(0,-1);for(var e=0;e<c.length;e++)c[e]=c[e].split("{")}function u(e){var t=e.getHead().append("style");return t.setAttribute("id","cke_ui_color"),t.setAttribute("type","text/css"),t}function f(e,t,n){for(var i,o,a,r=0;r<e.length;r++)if(W.webkit){for(o=0;o<e[r].$.sheet.rules.length;o++)e[r].$.sheet.removeRule(o);for(o=0;o<t.length;o++){for(a=t[o][1],i=0;i<n.length;i++)a=a.replace(n[i][0],n[i][1]);e[r].$.sheet.addRule(t[o][0],a)}}else{for(a=t,i=0;i<n.length;i++)a=a.replace(n[i][0],n[i][1]);L?e[r].$.styleSheet.cssText=a:e[r].setHtml(a)}}var p=/\$color/g;G.extend(s,{uiColor:null,rk:function(){return this.uiColor},setUiColor:function(e){var n,i,o=u(V.oC),a=u(this.document),t=".cke_"+s.name.replace(".","\\."),r=[t+" .cke_wrapper",t+"_dialog .cke_dialog_contents",t+"_dialog a.cke_dialog_tab",t+"_dialog .cke_dialog_footer"].join(","),l="background-color: $color !important;";return i=W.webkit?(n=[[r,l]],[["body,"+r,l]]):(n=r+"{"+l+"}","body,"+r+"{"+l+"}"),(this.setUiColor=function(e){var t=[[p,e]];s.uiColor=e,f([o],n,t),f([a],i,t),f(d,c,t)})(e)}}),s.on("menuShow",function(e){var t=e.data[0].element.eG("iframe").getItem(0).getFrameDocument();if(!t.getById("cke_ui_color")){var n=u(t);d.push(n);var i=s.rk();i&&f([n],c,[[p,i]])}}),s.config.uiColor&&s.on("uiReady",function(){s.setUiColor(s.config.uiColor)})}})),V.dialog?At():V.on("dialogPluginReady",At),V.skins.add("v1",(Oe=["images/loaders/16x16.gif","images/loaders/32x32.gif","images/ckffolder.gif","images/ckffolderopened.gif"],L&&W.version<7&&Oe.push("images/sprites_ie6.png"),{ls:Oe,application:{css:["app.css"]},ps:1,rv:-8,kN:0,host:{qx:1,css:["host.css"]}})),V.dialog?Pt():V.on("dialogPluginReady",Pt),V.skins.add("bootstrap",{application:{css:["app.css"]},host:{qx:1,css:["host.css"]},heightAdjust:50,bz:function(i){i.config.jh="png",i.on("appReady",function(){var e=i.document.$,t="rtl"===e.dir;t||e.querySelector("#toolbar_view .cke_toolbar").classList.add("col-md-10"),e.querySelector(".cke_search_box").classList.add("col-md-2",t?"pull-left":"pull-right");var n=e.querySelector(".cke_search_box input");n.classList.add("form-control"),n.setAttribute("placeholder",i.lang.Search.searchPlaceholder+"...")})}}),V.dialog?Mt():V.on("dialogPluginReady",Mt),V.gc.add("default",{dQ:function(o){o.name;var e=o.element,t=o.ff;if(e&&t!=V.kZ){o.layout=new V.application.layout(o);var n=o.oW("themeSpace",{space:"head",html:""}),i=o.oW("themeSpace",{space:"sidebar",html:""}),a=o.oW("themeSpace",{space:"mainTop",html:""}),r=o.oW("themeSpace",{space:"mainMiddle",html:""}),l=o.oW("themeSpace",{space:"mainBottom",html:""}),s=o.config.skin.indexOf(","),d=(-1==s?o.config.skin:o.config.skin.substr(0,s))||"kama",c='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html lang="'+o.lang.LangCode+'" dir="'+o.lang.dir+'"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />'+n.html+"</head><body>"+(W.ie6Compat?'<div id="ckfinder" role="application">':'<div id="ckfinder" role="application" style="visibility: hidden">')+'\x3c!-- 1. CKE Skin class. --\x3e<div class="fake_wrapper cke_skin_'+d+'">\x3c!-- 2. High contrast class. --\x3e<div class="fake_wrapper">\x3c!-- Applicable: hc cke_hc --\x3e\x3c!-- 3. Browser class. --\x3e<div class="fake_wrapper '+W.cssClass+'">\x3c!-- 4. RTL class. --\x3e<div class="fake_wrapper cke_'+("ltr"==o.lang.dir||L&&W.version<8?"ltr":"rtl")+'">\x3c!-- Applicable: rtl cke_rtl --\x3e\x3c!-- 5. Layout class. --\x3e<div class="fake_wrapper"><div id="ckfinder_view" class="columns_2">\x3c!-- Applicable: columns_1 columns_2 --\x3e<div id="sidebar_container" class="container" role="region"'+(o.config.sidebarWidth?' style="width: '+G.cssLength(o.config.sidebarWidth)+'"':"")+'><div id="sidebar_wrapper" class="wrapper">'+i.html+'</div></div><div id="main_container" class="container" role="region">'+a.html+r.html+l.html+"</div></div></div></div></div></div></div></div></body></html>";V.log("[THEME] DOM flush using document.write"),o.document.$.write(c),o.cr("themeLoaded"),o.cr("uiReady",function(){u(),o.cr("appReady",function(){if(u(),W.ie8){var e,t=o.document.$;if(t.documentMode?e=t.documentMode:(e=5,t.compatMode&&"CSS1Compat"==t.compatMode&&(e=7)),e<8){var n=o.plugins.tools;n.showTool(n.addTool('<strong style="color: red;">Forced IE compatibility mode! CKFinder may not look as intended.</strong>'))}}var i;W.ie6Compat&&o.document.getWindow().on("resize",u),o.document.getWindow().on("resize",function(){o.layout.ea.call(o.layout)}),function e(){var t=0;if(i=i||o.document.getHead().eG("link").getItem(0))try{i.$.sheet&&0<i.$.sheet.cssRules.length||i.$.styleSheet&&0<i.$.styleSheet.cssText.length?t=1:i.$.innerHTML&&0<i.$.innerHTML.length&&(t=1)}catch(e){}t?W.ie6Compat?(u(),o.layout.ea(),setTimeout(function(){o.layout.ea()},500)):(o.layout.ea(!0),setTimeout(function(){o.document.getById("ckfinder").removeStyle("visibility")})):window.setTimeout(e,250)}()})})}function u(){W.ie6Compat&&(o.layout.oG=o.document.getWindow().eR())}},pu:function(e){var t=G.getNextNumber(),n=Y.kE(['<div class="cke_compatibility cke_'+e.name.replace(".","\\.")+"_dialog cke_skin_",e.gd,'" dir="',e.lang.dir,'" lang="',e.langCode,'"><table class="cke_dialog'," "+W.cssClass.replace(/browser/g,"cke_browser")," cke_",e.lang.dir,'" style="position:absolute"><tr><td><div class="%body"><div id="%title#" class="%title"></div><div id="%close_button#" class="%close_button"><span>X</span></div><div id="%tabs#" class="%tabs"></div><table class="%contents"><tr><td id="%contents#" class="%contents"></td></tr></table><div id="%footer#" class="%footer"></div></div><div id="%tl#" class="%tl"></div><div id="%tc#" class="%tc"></div><div id="%tr#" class="%tr"></div><div id="%ml#" class="%ml"></div><div id="%mr#" class="%mr"></div><div id="%bl#" class="%bl"></div><div id="%bc#" class="%bc"></div><div id="%br#" class="%br"></div></td></tr></table>',L?"":"<style>.cke_dialog{visibility:hidden;}</style>","</div>"].join("").replace(/#/g,"_"+t).replace(/%/g,"cke_dialog_"),V.document),i=n.getChild([0,0,0,0,0]),o=i.getChild(0),a=i.getChild(1);return o.unselectable(),a.unselectable(),{element:n,bO:{dialog:n.getChild(0),title:o,close:a,tabs:i.getChild(2),contents:i.getChild([3,0,0,0]),footer:i.getChild(4)}}},destroy:function(e){var t=e.container,n=e.ia;t&&t.remove();for(var i=0;n&&i<n.length;i++)n[i].remove();e.element&&(e.ff==V.fc&&e.element.remove(),delete e.element)}}),V.application.prototype.vU=function(e){var t=""+e;return this._[t]||(this._[t]=V.document.getById(t+"_"+this.name))},V.application.prototype.nJ=function(e){/^\d+$/.test(e)&&(e+="px"),this.layout.dV().setStyle("width",e),this.oW("resize"),this.layout.ea()},V.application.prototype.resize=function(e,t){this.element.getChild(0).setStyle("height",t+"px"),this.element.getChild(0).setStyle("width",e+"px")},Me=(Ue="<div class='view tool_panel' style='padding:2px;display:block !important;position:static !important;color:black !important;background-color:white !important;'>")+(Pe="This is the DEMO version of CKFinder. Please visit the <a href='http://cksource.com/ckfinder' target='_blank'>CKFinder web site</a> to obtain a valid license.")+(Ae="</div>"),qe=Ue+(Be="CKFinder Developer License<br/>Licensed to: ")+Ae,V.application.layout=function(e){this.app=Me.length?e:null,this.jB=null},V.application.layout.prototype={ea:function(v){this.jB||(this.jB=G.setTimeout(function(){V.log("[THEME] Repainting layout");var e,t=V.bs.indexOf(V.bF.substr(1,1))%5,n=[V.bF.substr(8,1),V.bF.substr(6,1)],i=V.bF&&V.bF.substr(3,1)!=V.bs.substr(9*(V.bs.indexOf(V.bF.substr(0,1))+V.bs.indexOf(V.bF.substr(2,1)))%(V.bs.length-1),1),o=!!V.ed&&n[1]!=(e=V.ed.length+V.bs.indexOf(n[0]),V.bs.substr(9*e%32,1));if(V.bF&&1==t&&V.lS(window.top[V.nd+"cation"][V.jG+"st"])!=V.lS(V.ed)||4==t||i){for(var a=this.dV().getChild(0).getChildren(),r=0,l=0;l<a.count();l++)"static"==a.getItem(l).rd("position")&&(r=1);if(!r){if("bootstrap"==this.app.gd){var s="<div class='view tool_panel' style='display:block !important;position:static !important;color:#31708f !important;background-color:#d9edf7 !important;font-size: 13px; padding: 5px; margin:5px;border-radius:4px;'>";Me=s+Pe+Ae,qe=s+Be+Ae}this.dV().getChild(0).appendHtml(i||o||4!=t?Me:qe+"<b>"+G.htmlEncode(V.ed)+"</b></div>")}}var d=this.pn(),c=this.pS(),u=V.skins.loaded[this.app.gd];if(u.ps&&L&&W.ie6Compat&&!W.ie8){var f=this.mB(),p=this.dV(),h=3*u.kN,m=u.rv?u.rv:0,g=this.oG.width-p.$.offsetWidth-h+m;f.setStyle("width",g+"px")}d&&qt(d,u.mA,u.heightAdjust),c&&qt(c,u.kN),this.jB=null,v=!1,this.app.oW("afterRepaintLayout"),W.ie6Compat&&G.setTimeout(function(){this.app.element.$.style.cssText+=""},0,this)},!0===v?0:500,this))},dV:function(){return this.kS||(this.kS=this.app.document.getById("sidebar_container")),this.kS},mB:function(){return this.lb||(this.lb=this.app.document.getById("main_container")),this.lb},pS:function(){return void 0===this.kK&&(this.kK=this.app.document.getById("folders_view")),this.kK},pn:function(){return void 0===this.kD&&(this.kD=this.app.document.getById("files_view")),this.kD}}}();